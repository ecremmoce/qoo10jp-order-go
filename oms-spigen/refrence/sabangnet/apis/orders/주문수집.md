# 주문수집
**분류**: orders

## 개요

- 사방넷에 이미 수집되 있는 주문 데이터를 가져가기 위해 사용합니다.

- 주문관리 > 주문서수집(자동) 메뉴를 통하여 주문을 수집 후 주문관리 > 주문서확정관리 메뉴에서 확정처리 한 데이터에 한하여 데이터를 받아갈 수 있습니다.

- API 요청 시 조건에 해당하는 신규주문 을 주문확인 상태로 변경됩니다.

- 요청할 때마다 조건에 해당하는 모든 데이터를 보내주기에 중복 체크 작업이 필요합니다.

- 사방넷 API에서 유일하게 UTF-8 과 EUC-KR 두가지를 지원 합니다. (UTF-8 사용 시 별도 항목 추가)

- 정렬 조건은 수취인명, 우편번호, 주소, 사방넷 주문번호로 오름차순으로 정렬됩니다.

- 웹에서 접근 가능한 URL 또는 IP 주소가 존재 해야 합니다.

## 사방넷 원본 엔드포인트

```
* 등록접근주소 : https://sbadminXX.sabangnet.co.kr/RTL_API/xml_order_info.html?xml_url=xml주소
```

## RESTful API 변환

**Method**: `POST`

**Path**: `/api/v1/orders/collect`

**Summary**: 주문 정보 수집

## 인증 (Authentication)

### 사방넷 XML 헤더

| 필드명 | 설명 | 필수 |
|--------|------|------|
| SEND_COMPAYNY_ID | 사방넷 로그인아이디 | Y |
| SEND_AUTH_KEY | 사방넷에서 발급한 인증키 | Y |

### RESTful HTTP 헤더

```http
Authorization: Bearer {API_KEY}
X-Company-ID: {COMPANY_ID}
Content-Type: application/json
```

## 헤더 필드 (Header Fields)

| 필드명 | 설명 | 필수 | 비고 |
|--------|------|------|------|
| SEND_COMPAYNY_ID | 사방넷 로그인아이디 | Y | 사방넷 어드민 로그인 아이디입력 |
| SEND_AUTH_KEY | 사방넷에서 발급한 인증키 | Y | 사방넷에서 발급 받은 인증키(만약 받지 않았다면 사방넷에서 인증키 발급 요청) |
| SEND_DATE | 전송일자 | Y | YYYYMMDD |

## 데이터 필드 (Data Fields)

| XML 필드명 | JSON 필드명 | 설명 | 필수 | 비고 |
|-----------|-------------|------|------|------|
| ORD_ST_DATE | ordStDate | 검색 시작일자 | Y | 사방넷에 수집된 주문의 수집일자 기준의 검색조건 |
| ORD_ED_DATE | ordEdDate | 검색 마지막일자 | Y | 사방넷에 수집된 주문의 수집일자 기준의 검색조건 |
| ORD_FIELD | ordField | 출력필드 리스트 | Y | 출력할 필드를 |의 구분자로 입력합니다.필드리스트는 아래 Field List 표를 참고하여 작성합니다. |
| JUNG_CHK_YN2 | jungChkYn2 | 정산대조확인여부 | N | Y:확인완료, N:미확인, NULL:전체 |
| ORDER_ID | orderId | 주문번호(쇼핑몰) | N | 쇼핑몰 주문번호를 입력합니다. |
| MALL_ID | mallId | 쇼핑몰CODE | N | 쇼핑몰코드를 입력합니다. shop 또는 chop 로 시작하는 코드를 입력합니다.
기본정보 >쇼핑몰관리(지원) 또는 기본정보 >쇼핑몰관리(일반) 메뉴에서 코드 확인 가능합니다. |
| ORDER_STATUS | orderStatus | 주문상태 | N | 숫자로 입력합니다. 첫글자는 반드시 '(ENTER좌측Key)로 시작해야합니다. |
| LANG | lang | encoding타입 선택 | N | UTF-8 타입으로 출력 원할 경우 입력합니다. UTF-8 외에 값이 들어오면 기본값 euc-kr로 출력됩니다. |
| PARTNER_ID | partnerId | 매입처ID | N | 매입처 아이디명을 입력합니다. |
| MALL_USER_ID | mallUserId | 쇼핑몰ID | N | 해당 몰에 해당하는 쇼핑몰 아이디를 입력합니다. MALL_ID 입력시 사용가능합니다. |
| DPARTNER_ID | dpartnerId | 물류처ID | N | 물류처 아이디명을 입력합니다. |
| ACNT_REGS_SRNO | acntRegsSrno | 계정등록순번 | N | 쇼핑몰로그인ID를 구분하는 고유 번호를 입력합니다. |

## XML 구조 예제

```xml
<SABANG_ORDER_LIST>
  <HEADER>
    <SEND_COMPAYNY_ID>사방넷 로그인아이디</SEND_COMPAYNY_ID>
    <SEND_AUTH_KEY>사방넷에서 발급한 인증키</SEND_AUTH_KEY>
    <SEND_DATE>전송일자</SEND_DATE>
  </HEADER>
  <DATA>
    <ITEM>
      <ORD_ST_DATE>값</ORD_ST_DATE>
      <ORD_ED_DATE>값</ORD_ED_DATE>
      <ORD_FIELD>값</ORD_FIELD>
      <JUNG_CHK_YN2>값</JUNG_CHK_YN2>
      <ORDER_ID>값</ORDER_ID>
    </ITEM>
  </DATA>
</SABANG_ORDER_LIST>
```

## JSON 구조 예제

```json
{
  "ordStDate": "값",
  "ordEdDate": "값",
  "ordField": "값",
  "jungChkYn2": "값",
  "orderId": "값"
}
```
