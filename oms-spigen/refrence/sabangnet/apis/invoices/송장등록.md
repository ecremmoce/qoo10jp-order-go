# 송장등록
**분류**: invoices

## 개요

- 사방넷 주문 중 주문확인, 출고대기, 교환발송준비 상태의 주문에 운송장번호와 택배사 코드를 입력합니다.

- 주문확인 상태의 주문에 운송장을 입력할 경우 출고대기로 상태가 변경됩니다.

- 출고대기 상태이나 쇼핑몰에 이미 송장이 전송 완료된 경우와 강제완료 상태는 송장정보 수정이 불가능합니다.

- 웹에서 접근 가능한 URL 또는 IP 주소가 존재 해야 합니다.

- 사방넷 주문번호 기준으로 반영됩니다.

## 사방넷 원본 엔드포인트

```
* 등록접근주소 : https://sbadminXX.sabangnet.co.kr/RTL_API/xml_order_invoice.html?xml_url=xml주소
```

## RESTful API 변환

**Method**: `POST`

**Path**: `/api/v1/invoices`

**Summary**: 송장 정보 등록

## 인증 (Authentication)

### 사방넷 XML 헤더

| 필드명 | 설명 | 필수 |
|--------|------|------|
| SEND_COMPAYNY_ID | 사방넷 로그인아이디 | Y |
| SEND_AUTH_KEY | 사방넷에서 발급한 인증키 | Y |

### RESTful HTTP 헤더

```http
Authorization: Bearer {API_KEY}
X-Company-ID: {COMPANY_ID}
Content-Type: application/json
```

## 헤더 필드 (Header Fields)

| 필드명 | 설명 | 필수 | 비고 |
|--------|------|------|------|
| SEND_COMPAYNY_ID | 사방넷 로그인아이디 | Y | 사방넷 어드민 로그인 아이디입력 |
| SEND_AUTH_KEY | 사방넷에서 발급한 인증키 | Y | 사방넷에서 발급 받은 인증키(만약 받지 않았다면 사방넷에서 인증키 발급 요청) |
| SEND_DATE | 전송일자 | Y | YYYYMMDD |
| SEND_INV_EDIT_YN | 송장정보 수정여부 | N | 주문확인 or 교환발송준비 주문인 경우에만, 송장등록 처리가 가능합니다.
출고대기 주문의 송장정보(택배사코드/운송장번호)를 강제 수정하고 싶은 경우에, Y를 입력합니다. (Y:수정함, N/NULL:수정안함)
(단, 출고대기 주문상태이고, 쇼핑몰 송장전송여부가 전송대기 or 전송실패 주문인 경우에만, 송장정보 수정이 가능합니다.) |
| RESULT_TYPE | 결과 메시지 타입 | N | 미 입력시 기존 HTML형식의 결과값 형태, XML 입력시 XML 형태로 결과값을 출력합니다. |

## 데이터 필드 (Data Fields)

| XML 필드명 | JSON 필드명 | 설명 | 필수 | 비고 |
|-----------|-------------|------|------|------|
| SABANGNET_IDX | sabangnetIdx | 주문번호(사방넷) | Y | - |
| TAK_CODE | takCode | 택배사코드 | Y | 택배사 코드를 조회 하여 입력합니다. |
| TAK_INVOICE | takInvoice | 송장번호 | Y | - |
| DELV_HOPE_DATE | delvHopeDate | 배송희망일자 | N | 배송예정일을 입력합니다.(공백허용) |

## XML 구조 예제

```xml
<SABANG_INV_REGI>
  <HEADER>
    <SEND_COMPAYNY_ID>사방넷 로그인아이디</SEND_COMPAYNY_ID>
    <SEND_AUTH_KEY>사방넷에서 발급한 인증키</SEND_AUTH_KEY>
    <SEND_DATE>전송일자</SEND_DATE>
  </HEADER>
  <DATA>
    <ITEM>
      <SABANGNET_IDX>값</SABANGNET_IDX>
      <TAK_CODE>값</TAK_CODE>
      <TAK_INVOICE>값</TAK_INVOICE>
      <DELV_HOPE_DATE>값</DELV_HOPE_DATE>
    </ITEM>
  </DATA>
</SABANG_INV_REGI>
```

## JSON 구조 예제

```json
{
  "sabangnetIdx": "값",
  "takCode": "값",
  "takInvoice": "값",
  "delvHopeDate": "값"
}
```
