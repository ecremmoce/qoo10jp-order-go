{
  "document_id": "developer-guide.385",
  "document_type": "guide",
  "platform": "shopee",
  "extracted_at": "2025-10-16T09:23:24",
  "extracted_text": "# API Best Practices - Brand Open API Best Prac... > Open API Auth call / Pass...\n\n## 1.1) Como criar a URL de autorização de loja?\n\n- É a URL que seu registro o usuário, precisara fazero login na plataforma e selecionar um signup\n- Note\n- Acredite-se: https://partner.shopeemobile.com\n- Partner_id: você recebe dos [hotéis] do seu App\n- Redirect_url: Você definiu na sua aplicação. Consultar a documentação desse de consultar a autorização.\n- **Utilize o cliente \"criando\" para desenvolvimento**\n- **Utilize o cliente \"vendido\" para mercado** após passar pela integração\n- Sign: string criptografada através segundo no página do primeiro item\n\n**Exemplo:** Fornecemos como que configure a mensagem com algoritmo HMAC-SHA256\n\n```\nhttps://partner.shopeemobile.com/api/v2/shop/auth_partner?partner_id=184644&redirect=https://google.com.br&lang=pt-BR&ga2d3c32dd53c39bcr92c37d2b6c2f42bb6t=1724526317&sign=...\n```\n\n**Autorização Loja Test:**\n\n```\nhttps://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=184644&redirect=https://google.com.br&lang=pt-BR&ga2d3c32dd53c39bcr92c37d2b6c2f42bb6t=1724526317&sign=...\n```\n\n## 1.2) Como gerar o sign de autorização de loja?\n\nPara use de Login, Gá que uma série partindo \"p\", para concatenar: broca poder e os campos usados na construção.\n\nPara as outras APIs, use o path completo após o domínio (incluindo a barra) para concatenar.\n\nExemplo: Fornecemos como que configure a mensagem com algoritmo HMAC-SHA256\n\n**Observação:** Todos os valores abaixo são fictícios.\n\nPara gerar URL de autorização:\n\nBasta preencher os campos da forma correta:\n\nConcatene como: /api/v2/shop/auth_partner + \"p\", para manter o \"Sign integral\" do Roadmap, para gerar o sign.\n\n---\n\n### Code Examples:\n\n```javascript\n// Define partner_id\nlet partner_id = XXXXX;\nlet path = \"/api/v2/shop/auth_partner\";\n\n// Content preparation (key-value pairs)\nlet timestamp = Math.floor(Date.now() / 1000);\nlet redirect = \"https://your-redirect-url.com\";\nlet base_string = `${partner_id}${path}${timestamp}`;\n\n// Generate sign with HMAC-SHA256\nlet sign = crypto.createHmac('sha256', partner_secret)\n              .update(base_string)\n              .digest('hex')\n              .toUpperCase();\n\n// Redirect URL with params\nlet authUrl = `https://partner.shopeemobile.com${path}?partner_id=${partner_id}&redirect=${encodeURIComponent(redirect)}&timestamp=${timestamp}&sign=${sign}`;\n```\n\n```python\n# Python example\nimport hmac\nimport hashlib\nimport time\n\npartner_id = XXXXX\npath = \"/api/v2/shop/auth_partner\"\ntimestamp = int(time.time())\nredirect = \"https://your-redirect-url.com\"\n\n# Base string\nbase_string = f\"{partner_id}{path}{timestamp}\"\n\n# Generate sign\nsign = hmac.new(\n    partner_secret.encode('utf-8'),\n    base_string.encode('utf-8'),\n    hashlib.sha256\n).hexdigest().upper()\n\n# Auth URL\nauth_url = f\"https://partner.shopeemobile.com{path}?partner_id={partner_id}&redirect={redirect}&timestamp={timestamp}&sign={sign}\"\n```\n\n```java\n// Java example\nimport javax.crypto.Mac;\nimport javax.crypto.spec.SecretKeySpec;\n\nString partnerId = \"XXXXX\";\nString path = \"/api/v2/shop/auth_partner\";\nlong timestamp = System.currentTimeMillis() / 1000;\nString redirect = \"https://your-redirect-url.com\";\n\n// Base string\nString baseString = partnerId + path + timestamp;\n\n// Generate sign\nMac sha256Hmac = Mac.getInstance(\"HmacSHA256\");\nSecretKeySpec secretKey = new SecretKeySpec(partnerSecret.getBytes(), \"HmacSHA256\");\nsha256Hmac.init(secretKey);\nString sign = bytesToHex(sha256Hmac.doFinal(baseString.getBytes())).toUpperCase();\n\n// Auth URL\nString authUrl = String.format(\n    \"https://partner.shopeemobile.com%s?partner_id=%s&redirect=%s&timestamp=%d&sign=%s\",\n    path, partnerId, URLEncoder.encode(redirect, \"UTF-8\"), timestamp, sign\n);\n```\n\n---\n\n## 1.3) Fazendo a autorização da loja\n\nApós gerar a URL de autorização, será necessário redirecioná-lo ao seu site de marketplace de verificação com seguintes parâmetros: front_s_part_url, s_redirect e s_partnerId (para controle de acesso interno e segurança na autorização).\n\nDepois de uma via URL de autorização, o vendedor é imediato após inicialmente (se já acessou e retornou a senha e a senha é certa, a função é passada para a URL do redirect criada).\n\n**Observação:** A autorização precisa ser feita uma única vez para a loja.\n\n- Se ele não tiver login e senha, um novamente erro será \"repetition\" baseando e processos inicial como uma...\n- Este não URL de autorização pode ser reutilizada após o usuário fazer a autorização inicial\n- O usuário deverá ter permissão de \"Main Account\" ou ter a permissão de \"Authorization\"\n- O redirecionamento deve ser usado para confirmar a integração de sua loja completação dá redirect\n- Credenciais de acesso são controladas via OAuth2 e requer access tokens e refresh tokens\n- E obrigatório armazenar a access_token e refresh_token na sua plataforma para fazer suas\n- Depois de 4 horas que um authorization é não APP\n- Veja um exemplo de teste: https://test-stable.ap_1_open.br/ code=4630599fa0018149d7f0fb31dcf44da9_c91345f\n\n---\n\n## 2.GetAccessToken\n\nSe a Shopee teve seus credenciais e armazá-o no registro da autorização de loja para obter o access_token e o refresh_token.\n\nO access_token (AccessToken) tem um prazo de validade e exige, no momento da autorização da loja é preciso fazer acesso, basta-e obter o acesso...\n\n**Informações relevantes sobre a chamada do GetAccessToken:**\n\n[THIS IS DIAGRAM: A flowchart showing the authorization process with multiple steps including \"Criação de autorização\", \"Login e autorização\", \"Callback após a autorização\", \"Processo de access token\", and various decision points and API calls]\n\n---\n\n## Parameters Table:\n\n| Parâmetro | Exemplo | Obrig/Opc/Obrigatório |\n|-----------|---------|----------------------|\n| Host | https://partner.shopeemobile.com | Live environment |\n| | https://partner.test-stable.shopeemobile.com | Test/stable/sandbox environment |\n| Exemplo_id | XXXX | Informação + login/cliente: Open Partner Platform > APP > Obtenha seu s partnerId |\n| Shop_id | XXXX | Shop_id via token de autenticação via API |\n| Bound Key | Use shop/auth/sign | Use environment Oposite na Open Partner Console Informação + APP > Bound Key |\n| Not Key | | Not rotado=random environment Informação + APP > Not Key |\n| Sign | Ex:1232356237764cdc51829c8746c2ca3166e94920cb816df2473f3cb2d | |\n\n---\n\n# API Documentation - GetAccessToken\n\n## Key Information Table\n\n| Field | Value | Description |\n|-------|-------|-------------|\n| **Test Key** | - | Test State=Sandbox (environment: informação disponível na Open Platform → Painel de Controle → API → Live Key) |\n| **Path** | `b/12333063677b/4/9083b03ee7393b0e38199f0991020959447973cb3` | String (criptografado = HMAC-SHA256) |\n| **Code** | `6dae85447fa11ec6cb8e6e274857d8` | Gerado após a autorização da loja |\n\n### Notes\n1. Order a string base para gerar o login com a assinatura especificada no valendo: pattern_id + path + temperatura XXXX/xxxxxxxxxxxxxxxxxxxxxxxx11699902313\n2. As lojas de API são usadas para gerar assinaturas. Para ambientes de teste/sandbox, use o Test Key; para o ambiente de produção, use o Live Key.\n\n---\n\n## Example 1: POST Request\n\n### Endpoint\n```\nPOST\n```\n\n### URL\n```\nhttps://partner-test-api.jp.shopee.in.co/api/v2/auth/access_token/get\n```\n\n### Headers\n```http\nContent-Type: application/json\n```\n\n### Request Body\n```json\n{\n  \"app_id\": 1000XXXX,\n  \"code\": \"xxxxxxxx\",\n  \"shop_id\": 61XXXXX,\n  \"partner_id\": 100XXXX\n}\n```\n\n---\n\n## Example 2: cURL Command\n\n```bash\ncurl --request POST\n```\n\n```bash\nhttps://partner-test-api.jp.shopee.in.co/api/v2/auth/access_token/get\n```\n\n### Request Parameters\n```bash\n--header 'Content-Type: application/json'\n```\n\n```bash\n--data-raw '{\n  \"shop_id\":\"61XXXXX\",\n  \"partner_id\":\"100XXXX\"\n}'\n```\n\n---\n\n## Example 3: Response for GetAccessToken\n\n### Request Body Example\n```json\n{\n  \"refresh_token\": \"7552490145567cccccc4444dd1b52d69\",\n  \"access_token\": \"5a62355054c7f09ceeeee6677666a7\",\n  \"expire_in\": 14400,\n  \"request_id\": \"ef87a2a5b916515cccceee4EuuzpGC\",\n  \"error\": \"\",\n  \"message\": \"\"\n}\n```\n\n### Important Notes\n- access_token: Usado apenas uma vez por cada call; válido por 4 horas\n- expire_in: Válido do sistema integrado e arquivo, lesser através de um cartão\n- refresh_token: Usado para chamar a API RefreshAccessToken, É usado na chamada RefreshAccessToken para obter novo access_token (validade: 30 dias)\n\n---\n\n## 3 | RefreshAccessToken\n\nDepois que o access_token expirar, deverá utilizando a chamada de RefreshAccessToken, a chamada de gerar uso adequada, pelo código do autorização da loja será definitivamente autorizado. Assim, na verdade se o access_token é disponível. Além disso, refresh_token pode ser atualizado apenas; uma única vez a lista utilizado de 30 dias. Caso o novo refresh_token não seja utilizado dentro de 30 dias, a conexão com a loja expiratá e será necessário reimportação.\n\n### Information Requirements\n- Informação necessária para a chamada de RefreshAccessToken\n\n---\n\n## Parameter Table\n\n| Field | Value | Description | Endpoint |\n|-------|-------|-------------|----------|\n| **Host** | https://partner.test.shopee.com.cn | Test environment | - |\n| | https://partner-test-api.br.shopee.com | Test State=Sandbox (environment: informação disponível na Open Platform → Painel de Controle → API → Live Key) | - |\n| **Partner_id** | XXXX | - | - |\n| **Shop_id** | XXXX | Shop_id do loja get no momento da autorização e APT | - |\n| **Path** | /api/v2/auth/access_token_get | - | - |\n| **Secret Key** | Live Key | Live (production environment: informação disponível na Open Platform → Painel de Controle → API → Live Key) | - |\n| **Test Key** | - | Test State=Sandbox (environment: informação disponível na Open Platform → Painel de Controle → API → Live Key) | - |\n| **refresh_token** | b/12333063677b/4/9083b03ee7393b0e38199f0991020959447973cb3 | String (criptografado = HMAC-SHA256) | - |\n| | 5267480146672cccc14444d1b52d69 | Gerado na chamada anterior GetAccessToken, atualizado dentro chamadas da RefreshAccessToken (validade: 30 dias) | - |\n\n### Important Notes\n1. Order a string base para gerar o login com a assinatura especificada no valendo: pattern_id + path + temperatura XXXX/xxxxxxxxxxxxxxxxxxxxxxxx11699902313\n2. As lojas de API são usadas para gerar assinaturas para o seu código Key para ambiente de teste/sandbox\n3. Exemplo de resposta para a chamada de RefreshAccessToken\n\n---\n\n## Example 4: cURL Request\n\n```bash\ncurl --request POST\n```\n\n### URL\n```bash\nhttps://partner-test-api.jp.shopee.in.co/api/v2/auth/access_token/get\n```\n\n### Request Body\n```json\n{\n  \"refresh_token\": \"7552490145567cccccc4444dd1b52d69\",\n  \"shop_id\": 61XXXXX,\n  \"partner_id\": 100XXXX\n}\n```\n\n### Response\n```json\n{\n  \"request_id\": \"xxx\",\n  \"error\": \"\",\n  \"message\": \"\"\n}\n```\n\n---\n\n## Common Errors Returned in GetAccessToken Call\n\n### Error Types:\n- **error_auth**: Authentication errors\n- **error_param**: Parameter validation errors  \n- **error_permission**: Access permission errors\n\n### Common Error Details:\n- **Motivo**: Ocorre geralmente quando o código enviado na API\n- **Problema**: Invalid token or missing token\n- **Motivo**: geralmente é quando o código do usuário está vencida\n- **Erro mensagem**: \"Invalid partner\" or similar\n- **Motivo**: Generally when the ID or credentials are incorrect\n- **Erro mensagem**: \"Invalid shop_id\"\n- **Motivo**: Generally quando o ID da loja não coincide ou está vazio\n\n---\n\n**Note**: All code examples and endpoints shown are for testing/sandbox environment. Replace with production URLs and credentials when deploying to live environment.\n\n---\n\n# API Documentation - Token Management\n\n## Token Types\n\n- **access_token**: pode ser usado mais de uma vez, válido por 4 horas.\n- **expire_in**: depois de quantos segundos o access_token deixará de ser válido;\n- **refresh_token**: só pode ser usado uma vez e é válido por 30 dias.\n\n---\n\n## Entenda os erros mais comuns retornados na chamada ao GetAccessToken\n\n### 1 - Error message: \"Invalid code\".\na. Motivo: Ocorre, geralmente, quando o código enviado já foi utilizado antes.\n\nb. Parâmetro: code\n\nc. Solução: Gerar um novo código através do processo de autorização, ou utilizar o código correto.\n\n### 2 - Error message: \"Invalid partner id\".\na. Motivo: Ocorre quando o partner id utilizado não é válido.\n\nb. Parâmetro: partner_id\n\nc. Solução: Verificar o partner id que está sendo utilizado na chamada.\n\n### 3 - Error message: \"Invalid shop id\".\na. Motivo: Ocorre quando o shop id utilizado não corresponde com a loja que gerou o código.\n\nb. Parâmetro: shop_id\n\nc. Solução: Verificar o shop id que está sendo utilizado na chamada.\n\n### 4 - Error message: \"Invalid timestamp\".\na. Motivo: Timestamp já passou da validade de 5 minutos.\n\nb. Parâmetro: timestamp\n\nc. Solução: Utilizar um timestamp dentro da sua validade (5 minutos).\n\n### 5 - Error message: \"Wrong sign.\".\na. Motivo: O sign gerado está incorreto, geralmente o path na hora de gerar o sign está incorreto.\n\nb. Parâmetro: sign\n\nc. Solução: Verificar se o path na montagem da string do sign está correto: \"/api/v2/auth/token/get\".\n\n### 6 - Error message: \"No permission. Please inform seller to complete the Seller Registration on Shopee Seller Center first, then this shop can call for this API.\".\na. Motivo: O vendedor ainda não finalizou o cadastro na Central do Vendedor.\n\nb. Parâmetro: N/A\n\nc. Solução: Solicitar ao vendedor que finalize o cadastro correspondente ao shop id na Central do Vendedor.\n\n---\n\n## Erros mais comuns retornados na chamada ao RefreshAccessToken\n\n### 1 - Error message: \"Your refresh_token expired.\"\na. Motivo: Ocorre, geralmente, quando o refresh_token já expirou, ele tem validade de 30 dias.\n\nb. Parâmetro: refresh_token\n\nc. Solução: Caso não tenha um refresh_token novo, deverá realizar o procedimento de autorização novamente.\n\n### 2 - Error message: \"Invalid refresh_token.\"\na. Motivo: Ocorre quando o refresh_token utilizado não é válido, geralmente o refresh_token já foi utilizado anteriormente, ele é um token de uso único.\n\nb. Parâmetro: refresh_token\n\nc. Solução: Verificar se o refresh_token utilizado é o token gerado mais recente. Deve sempre utilizar o último gerado.\n\n### 3 - Error message: \"Partner and shop has no linked.\"\na. Motivo: Ocorre quando o shop_id utilizado na chamada não está conectado com o partner_id.\n\nb. Parâmetro: shop_id e partner_id\n\nc. Solução: Verificar o shop id e o partner id que estão sendo utilizados na chamada.\n\n### 4 - Error message: \"This shop account has been banned. Permissions for shop authorization and API calls have been suspended until the shop account is restored.\"\na. Motivo: Loja está banida.\n\nb. Parâmetro: N/A\n\nc. Solução: Verificar status da loja com o seller.\n\n### 5 - Error message: \"Wrong sign.\"\na. Motivo: O sign gerado está incorreto, geralmente o path na hora de gerar o sign está incorreto.\n\nb. Parâmetro: sign\n\nc. Solução: Verificar se o path na montagem da string do sign está correto: \"/api/v2/auth/access_token/get\".\n\n### 6 - Error message: \"No permission. Please inform seller to complete the Seller Registration on Shopee Seller Center first, then this shop can call for this API.\"\na. Motivo: O vendedor ainda não finalizou o cadastro na Central do Vendedor.\n\nb. Parâmetro: N/A\n\nc. Solução: Solicitar ao vendedor que finalize o cadastro correspondente ao shop id na Central do Vendedor.\n\n### 7 - Error message: \"error params\".\na. Motivo: Request body/payload com nome de parâmetro incorreto.\n\nb. Parâmetro: refresh_token, shop_id, partner_id\n\nc. Solução: Verificar qual dos parâmetros utilizado no request está incorreto e corrigir.",
  "metadata": {
    "title": "API Best Practices - Brand Open API Best Prac... > Open API Auth call / Pass...",
    "summary": "This guide provides instructions on how to create the authorization URL for a store, generate the authorization sign, and complete the store authorization process. It also covers how to obtain access tokens and refresh tokens using the GetAccessToken API.",
    "keywords": [
      "API authorization",
      "authorization URL",
      "HMAC-SHA256",
      "access token",
      "refresh token",
      "GetAccessToken API",
      "OAuth2",
      "partner_id",
      "shop_id"
    ],
    "category": "Authentication",
    "tags": [
      "API",
      "authorization",
      "access token",
      "refresh token",
      "Shopee API"
    ],
    "difficulty": "medium",
    "importance": 5,
    "use_cases": [
      "Integrating a marketplace with the Shopee API",
      "Authenticating a store to access Shopee resources",
      "Generating authorization URLs for user login",
      "Obtaining access tokens for API calls",
      "Refreshing access tokens for continued API access"
    ],
    "related_apis": [
      "GetAccessToken"
    ]
  }
}