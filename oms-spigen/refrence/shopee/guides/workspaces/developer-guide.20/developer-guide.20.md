# ì¸ì¦ í”„ë¡œì„¸ìŠ¤

**ì¹´í…Œê³ ë¦¬**: ì¸ì¦
**ë‚œì´ë„**: ì¤‘ê°„
**ì¤‘ìš”ë„**: 4/5
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-16T08:14:33

## ê°œìš”

ë³¸ ê°€ì´ë“œëŠ” ì¸ì¦ ë§í¬ ìƒì„±, Klaytnìœ¼ë¡œë¶€í„°ì˜ ì¸ì¦ í™œì„±í™”, ì¸ì¦ ë§í¬ ì‚¬ìš©ì„ í¬í•¨í•œ ì¸ì¦ í”„ë¡œì„¸ìŠ¤ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤. ì¸ì¦ ì¤€ë¹„ ë‹¨ê³„, ì¸ì¦ í”„ë¡œì„¸ìŠ¤ ìì²´, ê·¸ë¦¬ê³  ê²€ìƒ‰ëœ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒíŠ¸ë„ˆ ì„œë¹„ìŠ¤ì— ì¸ì¦ì„ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì„ ìì„¸íˆ ì„¤ëª…í•©ë‹ˆë‹¤. ë˜í•œ PHP, Python, Java ë° Node.jsë¡œ ì‘ì„±ëœ ì½”ë“œ ì˜ˆì œë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## ì£¼ìš” í‚¤ì›Œë“œ

- authorization
- authorization link
- Klaytn
- Open Platform
- HMAC-SHA256
- API
- app parameter
- signature
- partner_ci
- timestamp

## ë³¸ë¬¸

# ì¸ì¦ í”„ë¡œì„¸ìŠ¤

ì¸ì¦ì„ ìƒì„±í•˜ëŠ” ë°ëŠ” ì„¸ ë‹¨ê³„ê°€ ìˆìŠµë‹ˆë‹¤. ì¸ì¦ ë§í¬ ìƒì„±, (Klaytnì—ì„œ ì¸ì¦ í™œì„±í™”), ì¸ì¦ ë§í¬ ì‚¬ìš©, ë§ˆì§€ë§‰ìœ¼ë¡œ e-card, klaenì„ í†µí•´ ìµœì¢… ì‚¬ìš©ìê°€ ì¸ì¦í•˜ë„ë¡ ë§í¬ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ì•„ë˜ì—ì„œ ìì„¸íˆ ì„¤ëª…í•˜ë©°, ì¸ì¦ ì „ì— ì¤€ë¹„í•´ì•¼ í•  ì‚¬í•­, ì¸ì¦ í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´, ì¸ì¦ í›„ ê²€ìƒ‰ëœ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒíŠ¸ë„ˆ ì„œë¹„ìŠ¤ì˜ ì¸ì¦ì„ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ì •ë³´ë„ í•¨ê»˜ ì œê³µí•©ë‹ˆë‹¤.

## ì¸ì¦ ë§í¬ ìƒì„±

klaen ì¸ì¦ì„ ì§„í–‰í•˜ê¸° ì „ì— Open Platform App-tier-link Authorizerì— ìš”ì²­ì„ ë³´ë‚´ì•¼ í•©ë‹ˆë‹¤. ì¸ì¦ ë§í¬ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ URLì„ ë¸”ë™ë¦¬ìŠ¤íŠ¸*ì— ë“±ë¡í•©ë‹ˆë‹¤.

### ì¸ì¦ ìš”ì²­ ì½˜ì†”

| í•„ë“œ | ì„¤ëª… |
|-------|-------------|
| App List | ì•± ëª©ë¡ |
| Provider | ì œê³µì |
| API Not Set | API ì„¤ì • ì•ˆ ë¨ |
| API Not Set | API ì„¤ì • ì•ˆ ë¨ |
| API Not Set | API ì„¤ì • ì•ˆ ë¨ |
| Trade List | ê±°ë˜ ëª©ë¡ |

**ì°¸ê³ :**
- App List: 0
- í†µí•©í•  ì•± 4ê°œ ëª©ë¡
- API Not Set (3) - ë‚˜ì—´í•  í•„ìš” ì—†ìŒ / ê³µë°±
- Trade List - í—ˆìš© / ê±°ë¶€ í•„ìš”

ëª¨ë“  ìœ í˜•ì˜ ì•±ì— ëŒ€í•´ ë‹¤ìŒ ì‚¬ì–‘ìœ¼ë¡œ ì¸ì¦ ë§í¬ë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤. ì¸ì¦ ë§í¬ëŠ” app_key ë° ê¸°íƒ€ í•„ìˆ˜ ë§¤ê°œë³€ìˆ˜ì˜ ì„¸ ê°€ì§€ ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

#### ì¸ì¦ ë§í¬ ìƒì„± https://approvalappname.clouckorea/ch/klayappli_partner

**í•„ìˆ˜ ê¸°ë³¸ ë§¤ê°œë³€ìˆ˜:**

- app_key: string (ì„¤ëª…: ì•± í‚¤; ì—†ëŠ” ê²½ìš° ì•„ë˜ ë§¤ê°œë³€ìˆ˜ì— ì•± í‚¤ê°€ ìˆìŠµë‹ˆë‹¤.)

**Baselink https (ë§¤ê°œë³€ìˆ˜):**

- partner_ci: string (ì„¤ëª…: App-table master according2/Klayappli_partner)
- partner_info: string (ì„¤ëª…: íŒŒíŠ¸ë„ˆ ì •ë³´ëŠ” 20ìì´ë©° app_identifier_keyë¥¼ ìƒì„±í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.)

#### ê¸°íƒ€ í•„ìˆ˜ ë§¤ê°œë³€ìˆ˜:

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | ì„¤ëª… |
|----------------|------|-------------|
| login | string | sign base string (signin_partner_id, api path, timestamp)ìœ¼ë¡œ ì–»ì€ ì„œëª…ì…ë‹ˆë‹¤. API í‚¤ë¡œ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤. |
| partner_ci | int | ì•±ì—ì„œ ì–»ì€ partner_ciì…ë‹ˆë‹¤. |
| timestamp | int | sign base stringì— ì‚¬ìš©ëœ íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì…ë ¥í•  ë•Œì˜ ì‹œê°„ ê°’ì…ë‹ˆë‹¤. íƒ€ì„ìŠ¤íƒ¬í”„ ê°’ì€ 3ë¶„ ë™ì•ˆë§Œ ìœ íš¨í•©ë‹ˆë‹¤. |
| redirect | string | ì¸ì¦ì´ ì™„ë£Œëœ í›„ ë©”ì‹œì§€ê°€ ë¦¬ë””ë ‰ì…˜ë˜ëŠ” URLì…ë‹ˆë‹¤. ì´ëŠ” ì‹œìŠ¤í…œì˜ ì—”ë“œí¬ì¸íŠ¸ ë˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ëŠ” Open Platformì˜ ì—”ë“œí¬ì¸íŠ¸ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. |

#### ì•± ë§¤ê°œë³€ìˆ˜ ê³„ì‚°

ì•± ë§¤ê°œë³€ìˆ˜ëŠ” ì¸ì¦ ë§í¬ì˜ ì¼ë¶€ê°€ ì•„ë‹ˆê±°ë‚˜ í•´ë‹¹í•˜ì§€ ì•Šì§€ë§Œ ì•±ì´ Open Platform APIë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ì¸ì¦ì— ì‚¬ìš©ë˜ëŠ” ë§¤ê°œë³€ìˆ˜ì´ê¸°ë„ í•©ë‹ˆë‹¤. ì•± ë§¤ê°œë³€ìˆ˜ë¥¼ ê³„ì‚°í•˜ë ¤ë©´ ì¸ì¦ ì„œëª…ì„ í™œì„±í™”í•˜ëŠ” í•´ì‹œ ê°’(HMAC-SHA256)ì´ í•„ìš”í•©ë‹ˆë‹¤.

ì•± ë§¤ê°œë³€ìˆ˜ base stringì˜ ê²½ìš°:
sign base stringì„ í™œì„±í™”í•˜ê¸° ìœ„í•´ ë‹¤ë¥¸ ë§¤ê°œë³€ìˆ˜ ë°©ì‹ìœ¼ë¡œ base stringì„ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤(ì¼ë°˜ ë§¤ê°œë³€ìˆ˜ì™€ í˜¸í™˜ ê°€ëŠ¥).

- Shop APIì˜ ê²½ìš° partner_ci, api path, timestamp, access_token, shop_id.
- Partner APIì˜ ê²½ìš° partner_ci, api path, timestamp, access_token, token_type_shop&shop_ci.
- Public APIì˜ ê²½ìš° partner_ci, api path, timestamp.

HMAC-SHA256ì„ ì‚¬ìš©í•˜ì—¬ sign base stringì„ í•´ì‹±í•˜ê³  íŒŒíŠ¸ë„ˆ í‚¤ë¥¼ ì•”í˜¸í™” í‚¤ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. í•´ì‹œëœ ê°’(App ê°’)ì€ ì¸ì¦ ì„œëª…ì…ë‹ˆë‹¤.

### PHP ì½”ë“œ ë°ëª¨:

```php
<?php
// Input 1 Text:
$input1 = input1
$input2 = input2
$signPlainText = "";

if ($_SERVER["REQUEST_METHOD"] === "POST") {
    $input1 = isset($_POST['input1']) !== "";
    $text = "https://approvalappname.klayout.com/s/ch";
    $signinKey = $POST;
    $signPlainText = "";
    
    // Calculate SignBase:
    foreach($input_text = "header" . $var[len, id, path, $time] 
          $signPlainText = $prefix.join("&".$var.kind));
    
    $signedText = hash_hmac('SHA256', $headerText);
    $signedText = $signPlainText("text:". $signedText. "&cipher=text:". $partner, $POST);
    
    $finalText = $_GET['?'] ?? "auth/" . $signedText;
    echo "<ul>";
    foreach ($text as $item) {
        echo "<li>$item</li>";
    }
    echo "</ul>";
}
?>
```

### Python ì½”ë“œ ë°ëª¨:

```python
import hashlib
import hmac

# Function to calculate signature
$api_path = 0

def calculate_signature(partner_id, api_path, timestamp):
    """Calculate HMAC signature"""
    sign_base = f"{partner_id}&{api_path}&{timestamp}"
    
    # Using HMAC-SHA256
    signature = hmac.new(
        bytes(api_key, 'utf-8'),
        bytes(sign_base, 'utf-8'),
        hashlib.sha256
    ).hexdigest()
    
    return signature

# Example usage
partner_id = "your_partner_id"
api_path = "/api/v1/resource"
timestamp = int(time.time())

signature = calculate_signature(partner_id, api_path, timestamp)
print(f"Signature: {signature}")
```

### Java ì½”ë“œ ë°ëª¨:

```java
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;

public class AuthorizationExample {
    
    public static String calculateSignature(String partnerId, String apiPath, long timestamp, String apiKey) 
            throws NoSuchAlgorithmException, InvalidKeyException {
        
        // Create sign base string
        String signBase = partnerId + "&" + apiPath + "&" + timestamp;
        
        // Use HMAC-SHA256
        Mac sha256Hmac = Mac.getInstance("HmacSHA256");
        SecretKeySpec secretKey = new SecretKeySpec(apiKey.getBytes(), "HmacSHA256");
        sha256Hmac.init(secretKey);
        
        byte[] hash = sha256Hmac.doFinal(signBase.getBytes());
        
        // Convert to hex string
        StringBuilder hexString = new StringBuilder();
        for (byte b : hash) {
            String hex = Integer.toHexString(0xff & b);
            if (hex.length() == 1) hexString.append('0');
            hexString.append(hex);
        }
        
        return hexString.toString();
    }
    
    public static void main(String[] args) {
        try {
            String partnerId = "your_partner_id";
            String apiPath = "/api/v1/resource";
            long timestamp = System.currentTimeMillis() / 1000;
            String apiKey = "your_api_key";
            
            String signature = calculateSignature(partnerId, apiPath, timestamp, apiKey);
            System.out.println("Signature: " + signature);
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

### Node.js ì½”ë“œ ë°ëª¨:

```javascript
const crypto = require('crypto');

function calculateSignature(partnerId, apiPath, timestamp, apiKey) {
    // Create sign base string
    const signBase = `${partnerId}&${apiPath}&${timestamp}`;
    
    // Calculate HMAC-SHA256
    const hmac = crypto.createHmac('sha256', apiKey);
    hmac.update(signBase);
    const signature = hmac.digest('hex');
    
    return signature;
}

// Example usage
const partnerId = 'your_partner_id';
const apiPath = '/api/v1/resource';
const timestamp = Math.floor(Date.now() / 1000);
const apiKey = 'your_api_key';

const signature = calculateSignature(partnerId, apiPath, timestamp, apiKey);
console.log('Signature:', signature);

// Generate authorization URL
const authUrl = `https://approvalappname.cloudkorea.kr/ch/klayappli_partner?partner_ci=${partnerId}&timestamp=${timestamp}&login=${signature}&redirect=${encodeURIComponent('your_redirect_url')}`;
console.log('Authorization URL:', authUrl);
```

---

# Shopee Open Platform - ì¸ì¦ ê°€ì´ë“œ

## API ì—”ë“œí¬ì¸íŠ¸ ì •ë³´

```
Server: partner-test.shopeemobile.com (ìƒŒë“œë°•ìŠ¤ í™˜ê²½ìš©)
```

### ì¸ì¦ ë§í¬ ì˜ˆì‹œ

**Path:** `/api/v2/shop/auth_partner`

**Endpoint:** `https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner`

**Request Parameters:**
- `partner_id` (int)
- `redirect` (string): `https://www.YOUR_DOMAIN.com/callback`
- `sign` (string): `partner_key`ì™€ `partner_id`, `path`, `timestamp`ë¡œ êµ¬ì„±ëœ base stringì„ ì‚¬ìš©í•˜ì—¬ HMAC-SHA256ìœ¼ë¡œ ê³„ì‚°ë©ë‹ˆë‹¤.

**Base String Format:**
```
https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner
```

**Partner ID:** `847363`

**Signature:** `5f7dcd4cbe1a45f1bcb2e6dcfd8f3f6e08c2b9ed9bb6d62aaf3a5c69f7a8c49f7`

### ì¸ì¦ ë§í¬ ì˜ˆì‹œ

**í”„ë¡œë•ì…˜ ë° ìƒŒë“œë°•ìŠ¤ í…ŒìŠ¤íŠ¸ í™˜ê²½ìš© ë§í¬:**

#### í”„ë¡œë•ì…˜ í™˜ê²½:
```
https://partner.shopeemobile.com/api/v2/shop/auth_partner?partner_id=YOUR_PARTNER_ID&redirect=YOUR_REDIRECT_URL&sign=GENERATED_SIGNATURE
```

**ì˜ˆì‹œ:**
```
https://partner.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4
```

#### ìƒŒë“œë°•ìŠ¤ í™˜ê²½:
```
https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=YOUR_PARTNER_ID&redirect=YOUR_REDIRECT_URL&sign=GENERATED_SIGNATURE
```

**ì˜ˆì‹œ:**
```
https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4
```

### ìƒŒë“œë°•ìŠ¤ í…ŒìŠ¤íŠ¸ í™˜ê²½:
```
https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4
```

---

## ì¸ì¦ í”„ë¡œì„¸ìŠ¤

### ğŸ“Œ ì°¸ê³ 
íŒë§¤ìê°€ 5ë¶„ ë™ì•ˆ ë¡œê·¸ì¸ ë° ì¸ì¦ ìœ íš¨ì„±ì„ ìœ ì§€í•˜ëŠ”ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤. íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ì‚¬ì¸ì´ ë§Œë£Œë˜ë©´ íŒë§¤ìëŠ” ì¸ì¦ì„ ê³„ì†í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì¸ì¦ ë§í¬ëŠ” ë” ì´ìƒ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©° íŒë§¤ìë¥¼ ìƒˆ ë§í¬ë¡œ ë¦¬ë””ë ‰ì…˜í•´ì•¼ í•©ë‹ˆë‹¤.

---

## Shop(s)ì—ì„œ ì¸ì¦ íšë“

íŒë§¤ìì™€ í•¨ê»˜ ì¸ì¦ ë§í¬ë¥¼ ìƒì„±í•œ í›„ íŒë§¤ìëŠ” ê³„ì •ì— ë¡œê·¸ì¸í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì¸ì¦ ì½”ë“œ ì‚¬ìš©ì˜ ê²½ìš° íŒë§¤ìëŠ” ì´ë©”ì¼ì„ í™•ì¸í•˜ê³  ì¸ì¦ ì½”ë“œë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.

íŒë§¤ìëŠ” ê¸°ë³¸ ê³„ì •ì„ ì‚¬ìš©í•˜ì—¬ ë‹¨ì¼ ìƒì ì„ ì¸ì¦í•˜ê±°ë‚˜ ê¸°ë³¸ ê³„ì •ì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì†Œë§¤ì—…ì²´/ìƒì ì„ ì¸ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê³„ì •ì€ Shopee Seller Center ë˜ëŠ” ì¸ì¦ í˜ì´ì§€ì— ë¡œê·¸ì¸í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

### ğŸ“Œ ì°¸ê³ 
ì°¸ê³ : ì‚¬ë‚´ ì‹œìŠ¤í…œ ì•± ì‚¬ìš©ìëŠ” ê¸°ë³¸ ìƒì ì˜ ë°ì´í„°ì—ë§Œ ì•¡ì„¸ìŠ¤í•˜ë„ë¡ ì¸ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°œë°œì ê³„ì • íƒ­ì—ë„ ë¡œê·¸ì¸í•´ì•¼ í•©ë‹ˆë‹¤.

---

## ê¸°ë³¸ ê³„ì •ì—ì„œ ì¸ì¦

**1ë‹¨ê³„:** íŒë§¤ìëŠ” ë¡œê·¸ì¸ ì„¸ë¶€ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ë¡œê·¸ì¸ì„ ì„ íƒí•©ë‹ˆë‹¤.

---

## Shopee Open Platform APP ì¸ì¦ì„ ìœ„í•œ ë¡œê·¸ì¸

**í‘œì‹œë˜ëŠ” ì¸í„°í˜ì´ìŠ¤:**
- ì´ë©”ì¼/ì „í™” ì…ë ¥ í•„ë“œ
- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ
- "ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ìŠµë‹ˆê¹Œ?" ë§í¬
- "ë¡œê·¸ì¸" ë²„íŠ¼ (ì£¼í™©ìƒ‰)
- "ê¸°ë³¸ ê³„ì •ìœ¼ë¡œ ëŒì•„ê°€ê¸°" ì˜µì…˜
- ì–¸ì–´ ì„ íƒê¸°: ì˜ì–´

---

**2ë‹¨ê³„:** íŒë§¤ìëŠ” íœ´ëŒ€í°ìœ¼ë¡œ ì „ì†¡ëœ ì¸ì¦ ì½”ë“œë¥¼ ì…ë ¥í•˜ê³  í™•ì¸ì„ ì„ íƒí•©ë‹ˆë‹¤.

---

## í™•ì¸

**í‘œì‹œë˜ëŠ” ì¸í„°í˜ì´ìŠ¤:**
- ì¸ì¦ ì½”ë“œ ì…ë ¥ í•„ë“œ
- "í™•ì¸" ë²„íŠ¼ (ì£¼í™©ìƒ‰)
- "ì˜ì–´" ì–¸ì–´ ì„ íƒê¸°

---

**3ë‹¨ê³„:** ë¡œê·¸ì¸í•˜ë©´ íŒë§¤ìëŠ” ì¸ì¦ í™•ì¸ì„ ì„ íƒí•©ë‹ˆë‹¤.

---

## ì¸ì¦ í™”ë©´

**Shopee Open Platform**

### ì¸ì¦
[ìƒì  ì´ë¦„ ë° ì„¸ë¶€ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤]

**ì¸í„°í˜ì´ìŠ¤ ìš”ì†Œ:**
- ì¸ì¦ í™•ì¸ ë²„íŠ¼
- ë¶€ì—¬ëœ ê¶Œí•œì— ëŒ€í•œ ì •ë³´
- ë°ì´í„° ì•¡ì„¸ìŠ¤ì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´

**ë‚˜ì—´ëœ ê¶Œí•œ:**
- ì£¼ë¬¸ ì •ë³´: ì£¼ë¬¸ì— ëŒ€í•œ ëª¨ë“  ê¸°ë¡ê³¼ ê´€ë ¨ëœ ì •ë³´
- ì œí’ˆ ì •ë³´: ì œí’ˆ ë° í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì— ëŒ€í•œ ëª¨ë“  ê¸°ë¡ê³¼ ê´€ë ¨ëœ ì •ë³´
- ìƒì  ì •ë³´: ìƒì  ì„¤ì • ë° ì„¸ë¶€ ì •ë³´ì™€ ê´€ë ¨ëœ ì •ë³´
- ê¸°íƒ€ ì •ë³´: í• ì¸ ë° ê¸°íƒ€ ì„¸ë¶€ ì •ë³´ì™€ ê´€ë ¨ëœ ì •ë³´
- ë¬¼ë¥˜: ë¬¼ë¥˜ ë° ë°°ì†¡ì— ëŒ€í•œ ëª¨ë“  ê¸°ë¡ê³¼ ê´€ë ¨ëœ ì •ë³´
- ê¸ˆìœµ: ê²°ì œ ë° ê³„ì • ì”ì•¡ê³¼ ê´€ë ¨ëœ ì •ë³´
- ë°˜í’ˆ: ëª¨ë“  ê¸°ë¡ì— ëŒ€í•œ ë°˜í’ˆ ë° ë¶„ìŸê³¼ ê´€ë ¨ëœ ì •ë³´
- ë¯¸ë””ì–´ ê³µê°„: ì´ë¯¸ì§€ ë° ë¹„ë””ì˜¤ ì—…ë¡œë“œì™€ ê´€ë ¨ëœ ì •ë³´

**ì „ì²´ ì¸ì¦ì„ ë³´ë ¤ë©´ ë‹¤ìŒ ë§í¬ë¥¼ í´ë¦­í•˜ì‹­ì‹œì˜¤:**
```
ì¸ì¦ì„ í™•ì¸í•˜ë ¤ë©´ í´ë¦­í•˜ì‹­ì‹œì˜¤
```

---

**4ë‹¨ê³„:** ì¸ì¦ í›„ í”„ëŸ°íŠ¸ ì—”ë“œ í˜ì´ì§€ëŠ” ì¸ì¦ ë§í¬ì˜ ë¦¬ë””ë ‰ì…˜ URLë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤.

```
https://www.YOUR_DOMAIN.com/callback?code=xxxxxxxx&shop_id=xxxxxx
```

---

## ê¸°ë³¸ ê³„ì •ì—ì„œ ì¸ì¦

**1ë‹¨ê³„:** ê¸°ë³¸ ê³„ì •ì— ë¡œê·¸ì¸í•˜ë ¤ë©´ íŒë§¤ìëŠ” ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ê¸°ë³¸ ê³„ì •ìœ¼ë¡œ ì „í™˜ ë§í¬ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

---

## Shopee Open Platform APP ì¸ì¦ì„ ìœ„í•œ ë¡œê·¸ì¸

**í‘œì‹œë˜ëŠ” ì¸í„°í˜ì´ìŠ¤:**
- SH â†’ ID ë“œë¡­ë‹¤ìš´ (ë§ˆì¼“/ì§€ì—­ ì„ íƒê¸°)
- ì´ë©”ì¼/ID/USERNAME/Mobile/[?]2017 ì…ë ¥ í•„ë“œ
- ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í•„ë“œ
- "ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ìŠµë‹ˆê¹Œ?" ë§í¬
- "ë¡œê·¸ì¸" ë²„íŠ¼ (ì£¼í™©ìƒ‰)
- "OR" êµ¬ë¶„ì„ 
- "í•˜ìœ„ ê³„ì •ìœ¼ë¡œ ì „í™˜" ì˜µì…˜
- ì–¸ì–´ ì„ íƒê¸°: ì˜ì–´

---

**2ë‹¨ê³„:** ê·¸ëŸ° ë‹¤ìŒ íŒë§¤ìëŠ” ë¡œê·¸ì¸ ì„¸ë¶€ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ë¡œê·¸ì¸ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## Shopee Open Platform APP ì¸ì¦ì„ ìœ„í•œ ë¡œê·¸ì¸

**í‘œì‹œë˜ëŠ” í‘œì¤€ ë¡œê·¸ì¸ ì–‘ì‹**
- ì´ë©”ì¼/ì‚¬ìš©ì ì´ë¦„/íœ´ëŒ€í° ì…ë ¥
- ë¹„ë°€ë²ˆí˜¸ í•„ë“œ
- ë¡œê·¸ì¸ ë²„íŠ¼
- ê³„ì • ì „í™˜ ì˜µì…˜

---

**ì¶”ê°€ ì°¸ê³  ì‚¬í•­ ë° ë¬¸ì„œ ë§í¬:**

ì „ì²´ ì¸ì¦ íë¦„ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë¶€ì—¬ëœ ê¶Œí•œì— ëŒ€í•œ íŒë§¤ì ì œì–´ë¥¼ ìœ ì§€í•˜ë©´ì„œ ìƒì  ë°ì´í„°ì— ëŒ€í•œ ì•ˆì „í•œ ì•¡ì„¸ìŠ¤ë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.

---

# Shope Xpaygateway API ì¸ì¦ì„ ìœ„í•œ ë¡œê·¸ì¸

## ë‹¨ê³„

### 1. ì´ íŒë§¤ìëŠ” ì¸ì¦í•´ì•¼ í•˜ëŠ” ìƒì ì„ ì„ íƒí•©ë‹ˆë‹¤.
**ì°¸ê³ :** ì—¬ëŸ¬ ì œíœ´ íŒë§¤ìê°€ ìˆëŠ” ê²½ìš° íŒë§¤ìì˜ APIë¥¼ í˜¸ì¶œí•´ì•¼ í•˜ëŠ” ê²½ìš° íŒë§¤ìë¥¼ ë‹¤ì‹œ ì„ íƒí•˜ì—¬ Auth Merchant í™•ì¸ë€ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤.

---

### 2. [276] OperationEvent API ê·¸ë£¹

**Endpoint:**
- `GET /api/v1/orders/89879900046` - ì¸ì¦ë¨
  - View Stages: Order List
  - Based of 2019

**Auth Merchant** ë²„íŠ¼ ì‚¬ìš© ê°€ëŠ¥

---

### 3. [276] OperationEvent API (1234512345)

**ì‚¬ìš© ê°€ëŠ¥í•œ API ì‘ì—…:**
- `GET /api/v1/orders/89879900046` - ì¸ì¦ë¨
- `GET /api/v1/orders/564001872` - ì¸ì¦ë¨
- `GET /api/v1/orders/ORDER-12` - ì¸ì¦ë¨
- `GET /api/v1/orders/564001872/cancel` - ì¸ì¦ë¨

**Auth Merchant** ë²„íŠ¼ ì‚¬ìš© ê°€ëŠ¥

---

### 4. [276] OperationEvent API (1234512345) - #session - #common

**ì‚¬ìš© ê°€ëŠ¥í•œ ì‘ì—…:**
- `GET /tokens/v1/10004343266` - ì¸ì¦ë¨
- `PUT /api/v1/17700000000321` - ì¸ì¦ë¨

**Auth Merchant** ë²„íŠ¼ ì‚¬ìš© ê°€ëŠ¥

---

### 5. [276] OperationEvent API (1234512345) - #session - #common

**View Stages:** Order List
**Based of 2019**

**Auth Merchant** ë²„íŠ¼ ì‚¬ìš© ê°€ëŠ¥

---

## LOCAL (ì‹¤ì œ) ê³„ì • ì¸ì¦

### ì¸ì¦
ì‚¬ìš© ê°€ëŠ¥í•œ API: E-Shope API: Same - Online - Portlet (ì˜µì…˜)

**SN2**
**ê´€ë¦¬ì ì„¸ë¶€ ì •ë³´**

**ì •ë³´ ìƒì:**
ì´ ì¸ì¦ ì½”ë“œëŠ” í…ŒìŠ¤íŠ¸ ë¬¸ì„œì— ëŒ€í•œ ìµœì´ˆ ì¸ì¦ì—ë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤. ë¡œê·¸ì•„ì›ƒí•˜ë„ë¡ ì¸ì¦ëœ í˜ì´ì§€ë¥¼ ì„ íƒí•˜ì‹­ì‹œì˜¤. ì‹¤ì œ í˜ì´ì§€ì— ëŒ€í•œ í•´ë‹¹ ì½”ë“œëŠ” ìµœì´ˆ ì¸ì¦ì— ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ì¸ì¦ ì½”ë“œê°€ ê´€ë ¨ ì—†ëŠ” í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œë§Œ ì‚¬ìš©ëœ ê²½ìš°.

**[?] Ask: LOCAL (ì‹¤ì œ)**

---

## MTR ë²”ìœ„ (ì¸ì¦ì„ ì™„ë£Œí•˜ë ¤ë©´ ìƒì ì„ ì„ íƒí•˜ì‹­ì‹œì˜¤)

**Based all:**

- **1_a:** sell_[?] location
- **2_a:** show_[?] location
- **3_a:** sell_[?] location
- **4_a:** sold_[?] location
- **5_b:** store location
- **6_b:** (Multiple) show location
- **7a_b:** sell_a = sell + sold + combination

---

## 3. ì´ íŒë§¤ìëŠ” ì¸ì¦ í™•ì¸ì„ ì„ íƒí•˜ì—¬ ì„ íƒì„ í™•ì¸í•©ë‹ˆë‹¤.

---

### [276] OperationEvent API (1234512345) - #session - #common

**Auth Merchant** ë²„íŠ¼

**View Stages:** Order List
**Based of 2019**

---

### API ì‘ì—… ëª©ë¡:
- `GET /tokens/v1/10004343266` - ì¸ì¦ë¨
- `PUT /api/v1/orders/89879900046` - ì¸ì¦ë¨
- `GET /api/v1/orders/564001872` - ì¸ì¦ë¨

**ì¸ì¦ í™•ì¸** ë²„íŠ¼ (ë¹¨ê°„ìƒ‰/ì£¼í™©ìƒ‰)

---

## 4. ì¸ì¦ í›„ í”„ëŸ°íŠ¸ ì—”ë“œ í˜ì´ì§€ëŠ” ì¸ì¦ ì‘ì—…ì˜ ë¦¬ë””ë ‰ì…˜ URLë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤.

### ë¦¬ë””ë ‰ì…˜ URL
ë§¤ê°œë³€ìˆ˜ code, shop_id ë° state ë“±ì„ í¬í•¨í•©ë‹ˆë‹¤.

---

## ì¸ì¦ ì½”ë“œ ì‚¬ìš©

ì¸ì¦ ì½”ë“œë¥¼ ì–»ì€ í›„ APIë¥¼ í˜¸ì¶œí•˜ì—¬ ì¸ì¦ ì½”ë“œë¥¼ ì½œë°± ì£¼ì†Œ ë¦¬ë””ë ‰ì…˜ URLë¡œ êµí™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ìŒìœ¼ë¡œ access_tokenì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê¸°ë³¸ ê³„ì •ì—ì„œ ì¸ì¦ì´ ì™„ë£Œëœ ê²½ìš° codeì™€ main_account_idê°€ ë¦¬ë””ë ‰ì…˜ URLë¡œ ë°˜í™˜ë©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì½”ë“œëŠ” shop_id í˜•ì‹ì…ë‹ˆë‹¤.

### ë§¤ê°œë³€ìˆ˜ í…Œì´ë¸”:

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | ì„¤ëª… |
|----------------|------|-------------|
| code | string | ì´ëŠ” ì¸ì¦ ì½œë°±ì˜ ì¸ì¦ ì½”ë“œì…ë‹ˆë‹¤. ì´ ê°’ì€ access_token ë° refresh_tokenì„ ê²€ìƒ‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. í•œ ë²ˆë§Œ ìœ íš¨í•˜ë©° 10ë¶„ í›„ì— ë§Œë£Œë©ë‹ˆë‹¤. |
| shop_id | int | ì•±ì— ë°©ê¸ˆ ì¸ì¦ì„ ë¶€ì—¬í•œ ìƒì ì˜ IDì…ë‹ˆë‹¤. ìƒì ì—ì„œ ë‹¤ë¥¸ ì¸ì¦ì´ ì™„ë£Œëœ í›„ ë°˜í™˜ë©ë‹ˆë‹¤. |
| main_account_id | int
- **1_a:** sell_[?] location
- **2_a:** show_[?] location
- **3_a:** sell_[?] location
- **4_a:** sold_[?] location
- **5_b:** store location
- **6_b:** (Multiple) show location
- **7a_b:** sell_a = sell + sold + combination

---

## 3. íŒë§¤ìëŠ” ì„ íƒ ì‚¬í•­ì„ í™•ì¸í•˜ê¸° ìœ„í•´ ì¸ì¦ í™•ì¸ì„ ì„ íƒí•©ë‹ˆë‹¤.

---

### [276] OperationEvent API (1234512345) - #session - #common

**Auth Merchant** ë²„íŠ¼

**ë³´ê¸° ë‹¨ê³„:** ì£¼ë¬¸ ëª©ë¡
**2019ë…„ ê¸°ì¤€**

---

### API ì‘ì—… ëª©ë¡:
- `GET /tokens/v1/10004343266` - Authorized
- `PUT /api/v1/orders/89879900046` - Authorized
- `GET /api/v1/orders/564001872` - Authorized

**Confirm Authorization** ë²„íŠ¼ (ë¹¨ê°„ìƒ‰/ì£¼í™©ìƒ‰)

---

## 4. ì¸ì¦ í›„ í”„ëŸ°íŠ¸ ì—”ë“œ í˜ì´ì§€ëŠ” ì¸ì¦ ì‘ì—…ì˜ ë¦¬ë””ë ‰ì…˜ URLë¡œ ë¦¬ë””ë ‰ì…˜ë©ë‹ˆë‹¤.

### ë¦¬ë””ë ‰ì…˜ URL
ë§¤ê°œë³€ìˆ˜ code, shop_id ë° state ë“±ì„ í¬í•¨í•©ë‹ˆë‹¤.

---

## ì¸ì¦ ì½”ë“œ ì‚¬ìš©

ì¸ì¦ ì½”ë“œë¥¼ ì–»ì€ í›„ APIë¥¼ í˜¸ì¶œí•˜ì—¬ ì¸ì¦ ì½”ë“œë¥¼ ì½œë°± ì£¼ì†Œ ë¦¬ë””ë ‰ì…˜ URLë¡œ êµí™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ìŒìœ¼ë¡œ access_tokenì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¸ì¦ì´ ê¸°ë³¸ ê³„ì •ì—ì„œ ìˆ˜í–‰ëœ ê²½ìš° code ë° main_account_idê°€ ë¦¬ë””ë ‰ì…˜ URLë¡œ ë°˜í™˜ë©ë‹ˆë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì½”ë“œëŠ” shop_id í˜•ì‹ìœ¼ë¡œ ì œê³µë©ë‹ˆë‹¤.

### ë§¤ê°œë³€ìˆ˜ í…Œì´ë¸”:

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | ì„¤ëª… |
|----------------|------|-------------|
| code | string | ì´ëŠ” ì¸ì¦ ì½œë°±ì˜ ì¸ì¦ ì½”ë“œì…ë‹ˆë‹¤. ì´ ê°’ì€ access_token ë° refresh_tokenì„ ê²€ìƒ‰í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. í•œ ë²ˆë§Œ ìœ íš¨í•˜ë©° 10ë¶„ í›„ì— ë§Œë£Œë©ë‹ˆë‹¤. |
| shop_id | int | ì•±ì— ë°©ê¸ˆ ì¸ì¦ì„ ë¶€ì—¬í•œ ìƒì ì˜ IDì…ë‹ˆë‹¤. ìƒì ì—ì„œ ë‹¤ë¥¸ ì¸ì¦ì´ ì™„ë£Œëœ í›„ ë°˜í™˜ë©ë‹ˆë‹¤. |
| main_account_id | int | ìƒì ì— ë°©ê¸ˆ ì¸ì¦ì„ ë¶€ì—¬í•œ ê¸°ë³¸ ê³„ì •ì˜ IDì…ë‹ˆë‹¤. ê¸°ë³¸ ê³„ì •ì—ì„œ ì¸ì¦ì´ ì™„ë£Œëœ í›„ ë°˜í™˜ë©ë‹ˆë‹¤. |

---

## access_token ê°€ì ¸ì˜¤ê¸° ë° ê°±ì‹ 

Access_tokenì€ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ìê²© ì¦ëª…ì…ë‹ˆë‹¤. ê° ì‚¬ìš©ìëŠ” ìì²´ access_tokenì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. ë™ì¼í•œ APIì˜ ê²½ìš° ê° access_tokenì€ 4ì‹œê°„ ë™ì•ˆ ìœ íš¨í•˜ë©° 4ì‹œê°„ ì´ë‚´ì— ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë§Œë£Œëœ ê²½ìš° refresh_tokenì„ ì‚¬ìš©í•˜ì—¬ access_tokenì„ ê°±ì‹ í•˜ê±°ë‚˜ ìƒˆ ì¸ì¦ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒˆ access_tokenì„ ê²€ìƒ‰í•´ì•¼ í•©ë‹ˆë‹¤.

Refresh_tokenì€ access_tokenì„ ê°±ì‹ í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ë§¤ê°œë³€ìˆ˜ì…ë‹ˆë‹¤. ê° refresh_tokenì€ 30ì¼ ë™ì•ˆ ìœ íš¨í•©ë‹ˆë‹¤.

ê° shop_id ë° merchant_idì˜ access_token ë° refresh_tokenì€ ë³„ë„ë¡œ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.

### Call/AccessToken

ì¸ì¦ì— ì„±ê³µí•˜ë©´ code ë° shop_id ë˜ëŠ” main_account_idë¥¼ ë¦¬ë””ë ‰ì…˜ URLë¡œ ì‚¬ìš©í•˜ì—¬ APIë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ access_token, refresh_token, merchant_id, access_token, tokenì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ê²½ë¡œ:
- **í”„ë¡œë•ì…˜ í™˜ê²½:** https://partner.shopeemobile.com/api/v2/auth/token/get
- **í…ŒìŠ¤íŠ¸ í™˜ê²½:** https://partner.test-stable.shopeemobile.com/api/v2/auth/token/get
- **ìƒŒë“œë°•ìŠ¤ í™˜ê²½:** https://openplatform.sandbox.test-stable.shopeemobile.com/api/v2/auth/token/get

**ìš”ì²­ ë°©ë²•:** POST

---

### ìš”ì²­ ë§¤ê°œë³€ìˆ˜:

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | í•„ìˆ˜ | ì„¤ëª… |
|----------------|------|----------|-------------|
| sign | string | True | partner_key ë° timestampë¥¼ ìˆœì„œëŒ€ë¡œ ê°–ëŠ” sign ê¸°ë°˜ ë¬¸ìì—´(partner_id, api, path, timestamp, access_token ë˜ëŠ” refresh_token)ë¡œ ê³„ì‚°ëœ ì„œëª… |
| partner_id | int | True | ì•±ì—ì„œ ì–»ì€ partner_idì…ë‹ˆë‹¤. ì´ partner_idëŠ” ì²« ë²ˆì§¸ ì¿¼ë¦¬ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤. |
| timestamp | int | True | íƒ€ì„ìŠ¤íƒ¬í”„, 5ë¶„ ë™ì•ˆ ìœ íš¨ |

---

### ì‘ë‹µ ë§¤ê°œë³€ìˆ˜:

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | í•„ìˆ˜ | ì„¤ëª… |
|----------------|------|----------|-------------|
| code | string | True | ì¸ì¦ í›„ ë¦¬ë””ë ‰ì…˜ URLì˜ ì½”ë“œì…ë‹ˆë‹¤. í•œ ë²ˆë§Œ ìœ íš¨í•©ë‹ˆë‹¤. |
| partner_id | int | True | ì•±ì—ì„œ ì–»ì€ partner_idì…ë‹ˆë‹¤. ì´ partner_idëŠ” ê¸°ë³¸ ì¿¼ë¦¬ë¥¼ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤. |
| shop_id | int | True if [?] | ê·€í•˜ì—ê²Œ ì¸ì¦ëœ shop_idì˜ ê²½ìš° ì‘ë‹µì˜ shop_id ë˜ëŠ” merchant_idê°€ shop_id ë˜ëŠ” main_account_idì¸ ê²½ìš° |
| main_account_id | int | True if [?] | ê·€í•˜ì—ê²Œ ì¸ì¦ëœ main_account_idì˜ ê²½ìš° shop_id ë˜ëŠ” main_account_idë¥¼ ì…ë ¥ ë§¤ê°œë³€ìˆ˜ë¡œ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” ê²½ìš° |

---

### ì‘ë‹µ ë§¤ê°œë³€ìˆ˜:

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | ì„¤ëª… |
|----------------|------|-------------|
| request_id | string | ë˜ëŠ” AUTH ìš”ì²­; í•­ìƒ ë°˜í™˜ë©ë‹ˆë‹¤. ë¬¸ì œë¥¼ ì§„ë‹¨í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. |

---

# API ë¬¸ì„œ

## ì…ë ¥ ë§¤ê°œë³€ìˆ˜

**ì°¸ê³ :** `main_account_id`ëŠ” ì…ë ¥ ë§¤ê°œë³€ìˆ˜ë¡œ ìƒëµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì°¸ê³ :** `main_account_id` ì…ë ¥ì˜ ê²½ìš° `main_account_id` ë²”ìœ„ ë‚´ì—ì„œ ì…ë ¥ ë§¤ê°œë³€ìˆ˜ë¡œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ìš”ì²­ ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | ì„¤ëª… |
|----------------|------|-------------|
| request_id | string | API ìš”ì²­ ID, í•­ìƒ ë°˜í™˜ë©ë‹ˆë‹¤. ë¬¸ì œë¥¼ ì§„ë‹¨í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. |
| error | string | API ìš”ì²­ì— ëŒ€í•œ ì˜¤ë¥˜ ì½”ë“œ, í•­ìƒ ë°˜í™˜ë©ë‹ˆë‹¤. ë¹„ì–´ ìˆì§€ ì•Šì€ ë¬¸ìì—´ì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŒì„ ë‚˜íƒ€ë‚´ê³  ë¹ˆ ë¬¸ìì—´ì€ ì„±ê³µì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. |
| refunds_failed | string | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. ê° shop_id ë˜ëŠ” ê° merchant_idì— ëŒ€í•´ 30ì¼ ë™ì•ˆ ì‹¤íŒ¨í•œ ì´ í™˜ë¶ˆì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. |
| access_token | string | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•  ìˆ˜ ìˆê³  4ì‹œê°„ í›„ì— ë§Œë£Œë˜ëŠ” ë™ì  í† í°ì…ë‹ˆë‹¤. |
| expire_in | int | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. í† í°ì´ ë§Œë£Œë  ë•Œê¹Œì§€ì˜ ì‹œê°„ì„ ì´ˆ ë‹¨ìœ„ë¡œ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. |
| message | string | í•­ìƒ ë°˜í™˜ë©ë‹ˆë‹¤. ìì„¸í•œ ì˜¤ë¥˜ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. |
| new_user_time_to_list | INT | ì…ë ¥ ë§¤ê°œë³€ìˆ˜ì— `main_account`ê°€ ìˆëŠ” ê²½ìš° ë°˜í™˜ë˜ë©°, ì´ë²ˆì— ê¸°ë³¸ ê³„ì •ì—ì„œ ì¸ì¦ëœ ëª¨ë“  merchant_idë¥¼ í¬í•¨í•©ë‹ˆë‹¤. |
| shop_id_list | INT | ì…ë ¥ ë§¤ê°œë³€ìˆ˜ì— `main_account`ê°€ ìˆëŠ” ê²½ìš° ë°˜í™˜ë˜ë©°, ì´ë²ˆì— ê¸°ë³¸ ê³„ì •ì—ì„œ ì¸ì¦ëœ ëª¨ë“  shop_idë¥¼ í¬í•¨í•©ë‹ˆë‹¤. |

## Python ì½”ë“œ ë°ëª¨

```python
import time
import hashlib

# Fill the request time
url = "/api/v2/shop/get_shop_info"
path = "/api/v2/shop/get_shop_info"
body = ""
partner_id = xxxxxx
partner_key = "xxxxxxxxxxxxxx"
shop_id = xxxxxx
merchant_id = xxxxxx

tmp_base_string = "%s%s%s%s%s%s" % (
    partner_id, path, str(int(time.time())), access_token, shop_id, merchant_id
)

base_string = tmp_base_string.encode()
partner_key_bytes = partner_key.encode()

sign = hmac.new(
    partner_key_bytes, base_string, hashlib.sha256
).hexdigest()

headers = {
    "Content-Type": "application/json",
    "Partner-Id": str(partner_id),
    "Timestamp": str(int(time.time())),
    "Access-Token": access_token,
    "Shop-Id": str(shop_id),
    "Merchant-Id": str(merchant_id),
    "Authorization": sign,
}

resp = requests.post(
    url=url, headers=headers, json=json.loads(body)
)
print(resp.content)
```

## Java ì½”ë“œ ë°ëª¨

```java
import org.apache.commons.codec.binary.Hex;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;

public class AuthSignTest {
    
    public static void main(String[] args) throws Exception {
        int partner_id = xxxxxx;
        String partner_key = "xxxxxxxxxxxxxx";
        
        String path = "/api/v2/shop/auth_partner";
        String redirect_url = "https://www.xxxx.com/auth/callback";
        
        long timestamp = System.currentTimeMillis() / 1000L;
        
        String tmp_base_string = 
            String.format("%s%s%s", partner_id, path, timestamp);
        String base_string = tmp_base_string + partner_key;
        
        String sign = genHmacSHA256(base_string, partner_key);
        System.out.println("sign = " + sign);
        
        String url = 
            String.format(
                "https://partner.test.shopeedev.com%s?partner_id=%s&timestamp=%s&sign=%s&redirect=%s",
                path,
                partner_id,
                timestamp,
                sign,
                redirect_url
            );
        
        System.out.println(url);
    }
    
    public static String genHmacSHA256(String message, String secret) {
        try {
            Mac sha256_HMAC = Mac.getInstance("HmacSHA256");
            SecretKeySpec secret_key = new SecretKeySpec(secret.getBytes(), "HmacSHA256");
            sha256_HMAC.init(secret_key);
            
            byte[] bytes = sha256_HMAC.doFinal(message.getBytes());
            return Hex.encodeHexString(bytes);
            
        } catch (Exception e) {
            System.out.println("Error HmacSHA256");
        }
        return "";
    }
    
    public static String getWithHeaders(String host, String path, Map<String, String> headers) 
        throws IOException {
        
        HttpURLConnection connection = null;
        
        try {
            URL url = new URL(host + path);
            connection = (HttpURLConnection) url.openConnection();
            connection.setRequestMethod("GET");
            
            for (Map.Entry<String, String> entry : headers.entrySet()) {
                connection.setRequestProperty(entry.getKey(), entry.getValue());
            }
            
            int responseCode = connection.getResponseCode();
            
            if (responseCode == HttpURLConnection.HTTP_OK) {
                return getResponse(connection.getInputStream());
            } else {
                return getResponse(connection.getErrorStream());
            }
            
        } finally {
            if (connection != null) {
                connection.disconnect();
            }
        }
    }
    
    private static String getResponse(InputStream inputStream) throws IOException {
        BufferedReader in = new BufferedReader(new InputStreamReader(inputStream));
        String inputLine;
        StringBuilder response = new StringBuilder();
        
        while ((inputLine = in.readLine()) != null) {
            response.append(inputLine);
        }
        in.close();
        
        return response.toString();
    }
    
    public static String postWithHeaders(
        String host,
        String path,
        Map<String, String> headers,
        String body
    ) throws IOException {
        
        HttpURLConnection conn = null;
        
        try {
            URL url = new URL(host + path);
            conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("POST");
            conn.setDoOutput(true);
            
            for (Map.Entry<String, String> e : headers.entrySet()) {
                conn.setRequestProperty(e.getKey(), e.getValue());
            }
            
            OutputStream os = conn.getOutputStream();
            os.write(body.getBytes("UTF-8"));
            os.flush();
            
            int responseCode = conn.getResponseCode();
            
            if (responseCode == HttpURLConnection.HTTP_OK) {
                return getResp(conn.getInputStream());
            } else {
                return getResp(conn.getErrorStream());
            }
            
        } finally {
            if (conn != null) {
                conn.disconnect();
            }
        }
    }
    
    private static String getResp(InputStream is) throws IOException {
        BufferedReader in = new BufferedReader(new InputStreamReader(is));
        String inputLine;
        StringBuilder response = new StringBuilder();
        
        while ((inputLine = in.readLine()) != null) {
            response.append(inputLine);
        }
        in.close();
        
        return response.toString();
    }
}
```

---

# API í†µí•© ê°€ì´ë“œ

## ì¸ì¦

```php
$client = new GuzzleHttp\Client();
$response = $client->request('POST', 'https://api.example.com/auth', [
    'form_params' => [
        'username' => 'your_username',
        'password' => 'your_password'
    ]
]);
$token = json_decode($response->getBody())->token;
```

## API í˜¸ì¶œí•˜ê¸°

### GET ìš”ì²­

```php
$response = $client->request('GET', 'https://api.example.com/data', [
    'headers' => [
        'Authorization' => 'Bearer ' . $token,
        'Accept' => 'application/json'
    ]
]);
$data = json_decode($response->getBody());
```

### POST ìš”ì²­

```php
$response = $client->request('POST', 'https://api.example.com/create', [
    'headers' => [
        'Authorization' => 'Bearer ' . $token,
        'Content-Type' => 'application/json'
    ],
    'json' => [
        'name' => 'Item Name',
        'description' => 'Item Description',
        'price' => 99.99
    ]
]);
```

## ì˜¤ë¥˜ ì²˜ë¦¬

```php
try {
    $response = $client->request('GET', 'https://api.example.com/data');
} catch (\GuzzleHttp\Exception\ClientException $e) {
    echo "Client Error: " . $e->getMessage();
} catch (\GuzzleHttp\Exception\ServerException $e) {
    echo "Server Error: " . $e->getMessage();
}
```

## ì‘ë‹µ íŒŒì‹±

```php
$body = $response->getBody();
$data = json_decode($body, true);

foreach ($data['items'] as $item) {
    echo $item['name'] . "\n";
    echo $item['description'] . "\n";
}
```

## PHP ì½”ë“œ ë°ëª¨

### ê¸°ë³¸ GET ìš”ì²­

```php
function getTasksByUser($userId, $userToken, $baseUrl) {
    $path = "/api/v1/users/tasks";
    
    $query = http_build_query([
        'user_id' => $userId,
        'status' => 'active'
    ]);
    
    $url = $baseUrl . $path . '?' . $query;
    
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, [
        'Authorization: Bearer ' . $userToken,
        'Accept: application/json'
    ]);
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);
    
    return json_decode($response, true);
}
```

### ê³ ê¸‰ POST ìš”ì²­

```php
function createTaskForUser($userId, $userToken, $baseUrl, $taskData) {
    $path = "/api/v1/users/tasks";
    
    $url = $baseUrl . $path;
    
    $payload = array_merge([
        'user_id' => $userId,
        'created_at' => date('Y-m-d H:i:s')
    ], $taskData);
    
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, [
        'Authorization: Bearer ' . $userToken,
        'Content-Type: application/json',
        'Accept: application/json'
    ]);
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);
    
    return [
        'status' => $httpCode,
        'data' => json_decode($response, true)
    ];
}
```

## ì†ë„ ì œí•œ

**ì¤‘ìš”:** APIëŠ” í† í°ë‹¹ ë¶„ë‹¹ 100ê°œì˜ ìš”ì²­ìœ¼ë¡œ ì†ë„ ì œí•œì´ ìˆìŠµë‹ˆë‹¤.

### ì†ë„ ì œí•œ í—¤ë” ì˜ˆì‹œ

```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1609459200
```

## ì›¹í›…

ì›¹í›…ì„ êµ¬ì„±í•˜ì—¬ ì‹¤ì‹œê°„ ì•Œë¦¼ì„ ë°›ìŠµë‹ˆë‹¤.

```php
// Webhook endpoint example
$payload = file_get_contents('php://input');
$signature = $_SERVER['HTTP_X_SIGNATURE'];

$calculated = hash_hmac('sha256', $payload, $webhookSecret);

if (hash_equals($signature, $calculated)) {
    $data = json_decode($payload, true);
    // Process webhook data
}
```

## ëª¨ë²” ì‚¬ë¡€

1. ì²˜ë¦¬í•˜ê¸° ì „ì— **í•­ìƒ ì‘ë‹µì„ ê²€ì¦**í•˜ì‹­ì‹œì˜¤.
2. API í˜¸ì¶œì„ ì¤„ì´ê¸° ìœ„í•´ **ì¸ì¦ í† í°ì„ ìºì‹œ**í•˜ì‹­ì‹œì˜¤.
3. ì¬ì‹œë„ë¥¼ ìœ„í•´ **ì§€ìˆ˜ ë°±ì˜¤í”„ë¥¼ êµ¬í˜„**í•˜ì‹­ì‹œì˜¤.
4. ë””ë²„ê¹…ì„ ìœ„í•´ **ëª¨ë“  API ìƒí˜¸ ì‘ìš©ì„ ê¸°ë¡**í•˜ì‹­ì‹œì˜¤.
5. ì¤‘ìš”í•œ ë°ì´í„°ì— ëŒ€í•´ **í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©**í•˜ì‹­ì‹œì˜¤.

## ì¶”ê°€ ìë£Œ

- API ë¬¸ì„œ: https://documentation.example.com/api/v1/reference
- SDK ì €ì¥ì†Œ: https://github.com/example/php-sdk
- ì§€ì› í¬ëŸ¼: https://community.example.com/developers

## í•„ìˆ˜ í—¤ë”

- `Authorization: Bearer {token}`
- `Content-Type: application/json`
- `Accept: application/json`
- `User-Agent: YourApp/1.0`

---

*ìµœì¢… ì—…ë°ì´íŠ¸: 2024-01-15*

---

# API ë¬¸ì„œ

## ì•¡ì„¸ìŠ¤ í† í° ê´€ë¦¬

**ì¶•ì†Œ (ì„ íƒë¨)**
- https://docs.example.com/api/access-token-management
- https://example.com/api/endpoint

**ìƒŒë“œë°•ìŠ¤ í™˜ê²½**
- https://sandbox.example.com/api/access-token-management/get-partner-access-token-api
- https://sandbox.example.com/api/access-token-management/refresh-partner-access-token-api

**í•„ìˆ˜ ë°©ë²•:** POST

---

## ì°¸ê³ 

- GetAccessToken APIë¥¼ ì²˜ìŒ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ access_token_idëŠ” ë™ì¼í•œ ì´ˆê¸° access_token ë° refresh_tokenì„ ì–»ìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë‚˜ RefreshAccessToken APIë¥¼ ì²˜ìŒ í˜¸ì¶œí•œ í›„ì—ëŠ” ë§¤ë²ˆ, id ë° merchant_idì— ëŒ€í•´ ìƒˆë¡œìš´ ë…ë¦½ì ì¸ access_token ë° refresh_token ì„¸íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤.

ë‹¤ìŒì€ ì˜ˆì‹œì…ë‹ˆë‹¤.
1. ë¨¼ì € GetAccessToken APIë¥¼ ì²˜ìŒ í˜¸ì¶œí•˜ì—¬ ì–»ì€ access_token ë° refresh_tokenì˜ ì´ë¦„ì„ access_token_0, refresh_token_0ì´ë¼ê³  í•©ë‹ˆë‹¤.
2. ì²« ë²ˆì§¸ access_tokenì´ ë§Œë£Œëœ í›„ ì²« ë²ˆì§¸ refresh_tokenì„ ì‚¬ìš©í•˜ì—¬ RefreshAccessTokenì„ í˜¸ì¶œí•©ë‹ˆë‹¤.
3. API_SetupPayment_id ë° access_token_1, refresh_token_1ì„ í˜¸ì¶œí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì²« ë²ˆì§¸ ë…ë¦½ì ì¸ access_token ë° merchant_id ì„¸íŠ¸ë¥¼ ì–»ìŠµë‹ˆë‹¤.
4. RefreshAccessTokenì„ ë‹¤ì‹œ í˜¸ì¶œí•˜ë©´ ë‘ ë²ˆì§¸ ë…ë¦½ì ì¸ access_token ë° refresh_token ì„¸íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤.

---

## ê³µìš© ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | í•„ìˆ˜ | ì„¤ëª… |
|---------------|------|----------|-------------|
| sign | string | True | partner_keyë¥¼ í†µí•´ sign ë¡œì§(ë¬¸ìì—´ format_id, ext-path, timestamp + HMAC-SHA256 í•´ì‹±)ìœ¼ë¡œ ì–»ì€ ì„œëª… |
| partner_id | int | True | APPì—ì„œ ì–»ì€ partner_idì…ë‹ˆë‹¤. ì´ partner_idëŠ” ext-into-the-corpì…ë‹ˆë‹¤. |
| timestamp | int | True | íƒ€ì„ìŠ¤íƒ¬í”„, 5ë¶„ ë™ì•ˆ ìœ íš¨ |

---

## ìš”ì²­ ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | í•„ìˆ˜ | ì„¤ëª… |
|---------------|------|----------|-------------|
| access_token | string | True | ìƒˆ ì•¡ì„¸ìŠ¤ë¥¼ ì–»ê¸° ìœ„í•´ lifetime_tokenì„ ì‚¬ìš©í•©ë‹ˆë‹¤. |
- `Accept: application/json`
- `User-Agent: YourApp/1.0`

---

*ìµœì¢… ì—…ë°ì´íŠ¸: 2024-01-15*

---

# API ë¬¸ì„œ

## ì•¡ì„¸ìŠ¤ í† í° ê´€ë¦¬

**Collapse (ì„ íƒë¨)**
- https://docs.example.com/api/access-token-management
- https://example.com/api/endpoint

**ìƒŒë“œë°•ìŠ¤ í™˜ê²½**
- https://sandbox.example.com/api/access-token-management/get-partner-access-token-api
- https://sandbox.example.com/api/access-token-management/refresh-partner-access-token-api

**í•„ìˆ˜ ë©”ì„œë“œ:** POST

---

## ì°¸ê³  ì‚¬í•­

- GetAccessToken APIë¥¼ ì²˜ìŒ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ access_token_idëŠ” ë™ì¼í•œ ì´ˆê¸° access_token ë° refresh_tokenì„ ì–»ìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë‚˜ RefreshAccessToken APIë¥¼ ì²˜ìŒ í˜¸ì¶œí•œ í›„ì—ëŠ” ë§¤ë²ˆ ë…ë¦½ì ì¸ access_token ë° refresh_token ì„¸íŠ¸ê°€ id ë° merchant_idì— ëŒ€í•´ ìƒì„±ë©ë‹ˆë‹¤.

ë‹¤ìŒì€ ì˜ˆì‹œì…ë‹ˆë‹¤.
1. ë¨¼ì € GetAccessToken APIë¥¼ ì²˜ìŒ í˜¸ì¶œí•˜ì—¬ ì–»ì€ access_token ë° refresh_tokenì„ access_token_0, refresh_token_0ì´ë¼ê³  í•©ë‹ˆë‹¤.
2. ì²« ë²ˆì§¸ access_tokenì´ ë§Œë£Œëœ í›„ ì²« ë²ˆì§¸ refresh_tokenì„ ì‚¬ìš©í•˜ì—¬ RefreshAccessTokenì„ í˜¸ì¶œí•©ë‹ˆë‹¤.
3. ë…ë¦½ì ì¸ access_tokenì˜ 1ë²ˆì§¸ ì„¸íŠ¸ë¥¼ ì–»ê³  merchant_idëŠ” API_SetupPayment_id ë° access_token_1, refresh_token_1ì„ í˜¸ì¶œí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
4. RefreshAccessTokenì„ ë‹¤ì‹œ í˜¸ì¶œí•˜ë©´ ë…ë¦½ì ì¸ access_token ë° refresh_tokenì˜ 2ë²ˆì§¸ ì„¸íŠ¸ê°€ ìƒì„±ë©ë‹ˆë‹¤.

---

## ê³µìš© ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | í•„ìˆ˜ | ì„¤ëª… |
|---------------|------|----------|-------------|
| sign | string | True | partner_keyë¥¼ í†µí•´ sign ë¡œì§(ë¬¸ìì—´ format_id, ext-path, timestamp + HMAC-SHA256 í•´ì‹±)ìœ¼ë¡œ ì–»ì€ ì„œëª… |
| partner_id | int | True | ì•±ì—ì„œ ì–»ì€ partner_idì…ë‹ˆë‹¤. ì´ partner_idëŠ” ext-into-the-corpì…ë‹ˆë‹¤. |
| timestamp | int | True | íƒ€ì„ìŠ¤íƒ¬í”„, 5ë¶„ ë™ì•ˆ ìœ íš¨í•©ë‹ˆë‹¤. |

---

## ìš”ì²­ ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | í•„ìˆ˜ | ì„¤ëª… |
|---------------|------|----------|-------------|
| access_token | string | True | ìƒˆ access_tokenì„ ì–»ê¸° ìœ„í•´ lifetime_tokenì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ê° refresh_tokenì€ 30ì¼ ë™ì•ˆ ìœ íš¨í•˜ë©° long_id ë˜ëŠ” merchant_id ì¤‘ í•˜ë‚˜ì—ì„œ í•œ ë²ˆë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. |
| partner_id | int | True | ì•±ì—ì„œ ì–»ì€ partner_idì…ë‹ˆë‹¤. partner_idëŠ” ê°€ë§¹ì  ê³„ì •ìœ¼ë¡œ ë°˜ì „ë©ë‹ˆë‹¤. |
| shop_id | int | False | ì•±ì— ê¶Œí•œì„ ë¶€ì—¬í•œ ê¸°ë³¸ ê³„ì •ì˜ shop_idì…ë‹ˆë‹¤. merchant_idì˜ shop_idë§Œì´ ì´ APIë¡œ ìš”ì²­ë  shop access_tokenì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. |
| merchant_id | int | - | ì•±ì— ê¶Œí•œì„ ë¶€ì—¬í•œ ê¸°ë³¸ ê³„ì •ì„ ì‹ë³„í•˜ê¸° ìœ„í•œ merchant_idì…ë‹ˆë‹¤. shop_id ë˜ëŠ” merchant_idë§Œ ì…ë ¥ ë§¤ê°œë³€ìˆ˜ì— ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©° ì´ˆê¸°í™”í•´ì•¼ í•©ë‹ˆë‹¤. |

---

## ì‘ë‹µ ë§¤ê°œë³€ìˆ˜

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ìœ í˜• | ì„¤ëª… |
|---------------|------|-------------|
| request_id | string | API ìš”ì²­ì˜ ID, í•­ìƒ ë°˜í™˜ë©ë‹ˆë‹¤(ë””ë²„ê¹… ëª©ì ). |
| error | string | ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ì˜¤ë¥˜ ì •ë³´ê°€ í•­ìƒ ë°˜í™˜ë©ë‹ˆë‹¤. API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë˜ëŠ” ì˜¤ë¥˜ ì½”ë“œëŠ” ë¹„ì–´ ìˆìŠµë‹ˆë‹¤. |
| refresh_token | string | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. RefreshAccessTokenì„ í˜¸ì¶œí•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. |
| access_token | string | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. ìƒˆ access_tokenì„ ì‚¬ìš©í•˜ì—¬ developer_token_idëŠ” long_id ë˜ëŠ” merchant_id ì¤‘ í•˜ë‚˜ì—ì„œ ë‘ ë²ˆ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. |
| access_token_expire_in | int | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. ê° ìƒˆ access_tokenì€ ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë™ì  í† í°ì´ë©° ì´ ì‹œê°„(ì´ˆ) í›„ì— ë§Œë£Œë©ë‹ˆë‹¤. |
| expire_in | int | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. ê³„ì • ì‹¤í–‰ì„ ìœ„í•œ refresh_token ìˆ˜ëª…(ì´ˆ)ì…ë‹ˆë‹¤. |
| message | string | í•­ìƒ ë°˜í™˜ë©ë‹ˆë‹¤. ìì„¸í•œ ì˜¤ë¥˜ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. |
| merchant_id | int | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. ì–´ë–¤ ê¸°ë³¸ ê°€ë§¹ì  ê³„ì •ì„ ì‹ë³„í•˜ê¸° ìœ„í•œ merchant_idì…ë‹ˆë‹¤. |
| shop_id | int | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. ì–´ë–¤ ìƒì ì„ ì‹ë³„í•˜ê¸° ìœ„í•œ shop_idì…ë‹ˆë‹¤. |
| partner_id | int | API í˜¸ì¶œì´ ì„±ê³µí•˜ë©´ ë°˜í™˜ë©ë‹ˆë‹¤. ì´ ìš”ì²­ì— ì‚¬ìš©í•œ partner_idì…ë‹ˆë‹¤. |

---

## ì°¸ê³  ì‚¬í•­

- ìƒˆ access_tokenì´ ìƒì„±ëœ í›„ì—ë„ ì´ì „ access_tokenì€ 5ë¶„ ë™ì•ˆ ìœ íš¨í•©ë‹ˆë‹¤.
- ì¸ì¦ í˜¸ì¶œ ì‹œ refresh_token ë° access_tokenì´ ë°˜í™˜ë©ë‹ˆë‹¤.
- ë§Œë£Œë˜ê¸° ì „ì— RefreshAccessToken APIë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒˆ access_token ì„¸íŠ¸ë¥¼ ê°€ì ¸ì™€ì•¼ í•©ë‹ˆë‹¤.
- **ì´ ìš”ì²­ì€ refresh_tokenì˜ ìˆ˜ëª…ì„ ì—°ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. refresh_tokenì´ ë§Œë£Œë˜ê¸° ì „ì— ë‹¤ì‹œ ì¸ì¦ì„ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤(ìƒˆ refresh_tokenì´ ë§Œë£Œë˜ë©´ ìƒì ì—ì„œ ì•±ì„ ë‹¤ì‹œ ì¸ì¦í•´ì•¼ í•¨).**

---

## Python ì½”ë“œ ë°ëª¨

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import json
import requests
import time
import hmac
import hashlib

API_URL = "https://partner.example.com/api/v1/access_token/get"
PARTNER_ID = 100000
PARTNER_KEY = "your_partner_key_here"

def get_access_token_first_time(api_url, partner_id, partner_key, refresh_token=""):
    path = "/api/v1/access_token/get"
    timestamp = int(time.time())
    
    # Payload
    body = {
        "partner_id": partner_id,
        "timestamp": timestamp
    }
    
    if refresh_token:
        body["refresh_token"] = refresh_token
    
    # Generate signature
    base_string = f"{partner_id}{path}{timestamp}"
    sign = hmac.new(
        partner_key.encode('utf-8'),
        base_string.encode('utf-8'),
        hashlib.sha256
    ).hexdigest()
    
    # Headers
    headers = {
        "Content-Type": "application/json",
        "partner-id": str(partner_id)
    }
    
    # Add sign to body
    body["sign"] = sign
    
    response = requests.post(api_url, json=body, headers=headers)
    
    return response.json()

# First time call
result = get_access_token_first_time(API_URL, PARTNER_ID, PARTNER_KEY)
print(json.dumps(result, indent=2))

# Refresh token call
if "refresh_token" in result:
    new_result = get_access_token_first_time(
        API_URL, 
        PARTNER_ID, 
        PARTNER_KEY, 
        refresh_token=result["refresh_token"]
    )
    print(json.dumps(new_result, indent=2))
```

---

## Curl ì½”ë“œ ë°ëª¨

```bash
curl --location --request POST 'https://partner.example.com/api/v1/access_token/get' \
--header 'Content-Type: application/json' \
--header 'partner-id: 100000' \
--data-raw '{
    "partner_id": 100000,
    "sign": "generated_sign_here",
    "timestamp": 1629876543,
    "refresh_token": "optional_refresh_token_here"
}'
```

---

## Java ì½”ë“œ ë°ëª¨

```java
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import org.json.JSONObject;

public class AccessTokenExample {
    
    private static final String API_URL = "https://partner.example.com/api/v1/access_token/get";
    private static final int PARTNER_ID = 100000;
    private static final String PARTNER_KEY = "your_partner_key_here";
    
    public static String generateSign(int partnerId, String path, long timestamp, String partnerKey) throws Exception {
        String baseString = partnerId + path + timestamp;
        Mac sha256Hmac = Mac.getInstance("HmacSHA256");
        SecretKeySpec secretKey = new SecretKeySpec(partnerKey.getBytes("UTF-8"), "HmacSHA256");
        sha256Hmac.init(secretKey);
        byte[] hash = sha256Hmac.doFinal(baseString.getBytes("UTF-8"));
        
        StringBuilder hexString = new StringBuilder();
        for (byte b : hash) {
            String hex = Integer.toHexString(0xff & b);
            if (hex.length() == 1) hexString.append('0');
            hexString.append(hex);
        }
        return hexString.toString();
    }
    
    public static void main(String[] args) throws Exception {
        String path = "/api/v1/access_token/get";
        long timestamp = System.currentTimeMillis() / 1000;
        String sign = generateSign(PARTNER_ID, path, timestamp, PARTNER_KEY);
        
        JSONObject requestBody = new JSONObject();
        requestBody.put("partner_id", PARTNER_ID);
        requestBody.put("timestamp", timestamp);
        requestBody.put("sign", sign);
        // requestBody.put("refresh_token", "your_refresh_token"); // Optional
        
        URL url = new URL(API_URL);
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setRequestMethod("POST");
        conn.setRequestProperty("Content-Type", "application/json");
        conn.setRequestProperty("partner-id", String.valueOf(PARTNER_ID));
        conn.setDoOutput(true);
        
        OutputStream os = conn.getOutputStream();
        os.write(requestBody.toString().getBytes("UTF-8"));
        os.close();
        
        BufferedReader br = new BufferedReader(new InputStreamReader(conn.getInputStream()));
        String line;
        StringBuilder response = new StringBuilder();
        while ((line = br.readLine()) != null) {
            response.append(line);
        }
        br.close();
        
        System.out.println(response.toString());
    }
}
```

---

# Java ì½”ë“œ ë°ëª¨

```java
//java version for green team.
public static String[] getAccountName_web_level(String refresh_token, long partner_id, String 
partner_pwd, String merchantId, HttpServlet httpRequest) {
    String[] test = new String[2];
    test[0]json = Stirng.valueOf(list) + '}]}}';
    test[0]json = test[0]json.replace("List", "{format_list");
    test[0]json = test[0]json.replace("\\xBusinessName\\x", partner_ged);
    String fee_hash_str = String.format("partner=%s&partner_id=%d", partner_id, pwd(), timestamp);
    test[1] = partner_pwd;
    
    //Create signature
    EncryptGenerator sign = null;
    
    try {
        Map<String, String> params = new HashMap<>();
        base_url = "is * for _hash_str + tag.getbuffer.UTF-8");
        partner_desc = *for _partner_tag.getbuffer("UTF-8");
        base_url.update(partner_desc);
        
        String partner_sign = bytesToHexString(base_url.digest());
        Set<String> svc_biz = (Set<String>) httpRequest.getAttribute("biz_type":"HashCode");
        String biz = "is_biz(svc.biz);
        biz = biz.substring(1, biz.length() - 1);
        
        if (StringUtils.isEmpty(biz)) {
            biz = provider[start];
        }
        
        String tag_url = "test + "user" + String.format("method=%SJSON.fastJsontoString.green+"
server=merchantId="+merchantId+"&partner_id=1+partner_id+"&biz_type="+biz+"&method_sign="+sign);
        URL url = new URL(tag_url);
        HttpURLConnection conn = (HttpURLConnection)url.openConnection();
        conn.setDoOutput(true);
        conn.setDoInput(true);
        BufferedReader br = null;
        
        try {
            br = new BufferedReader(new InputStreamReader(conn.getInputStream()));
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Accept-Charset", "utf-8");
            conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
            conn.getResponseCode();
            conn.setRequestProperty("User-Agent", "application/x-www-form");
            OutputStreamWriter out = new OutputStreamWriter(conn.getOutputStream(), "UTF-8");
            out.write(URLDecoder.decode(test[0]json,"UTF-8"));
            out.flush();
            out.close();
            
            String read_line = "";
            String total_content = "";
            while ((read_line = br.readLine()) != null) {
                total_content += read_line;
            }
            
            JSONObject jsonObject = JSONObject.parseObject(total_content);
            result = (String) jsonObject.get("alipay_user_");
            result = (String) jsonObject.get("format_type");
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            if (br != null) {
                br.close();
            }
            
            if (is != null) {
                is.close();
            }
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    
    return test;
}
```

---

```java
//Java.Usual version the green way
public static String[] getAccountName_web_level(String refresh_token, long partner_id, String 
partner_pwd, String merchantId, HttpServlet httpRequest) {
    String[] test = new String[2];
    test[0]json = String.valueOf(list) + '}]}}';
    test[0]json = test[0]json.replace("List", "{format_list");
    test[0]json = test[0]json.replace("\\xBusinessName\\x", partner_ged);
    String fee_hash_str = String.format("partner=%s&partner_id=%d", partner_id, pwd(), timestamp);
    test[1] = partner_pwd;
    
    //Create signature
    EncryptGenerator sign = null;
    
    try {
        MessageDigest base_url = MessageDigest.getInstance("MD5");
        base_url.update(test[0].getBytes("UTF-8"));
        partner_desc = *for _partner_tag.getbuffer("UTF-8");
        base_url.update(partner_desc);
        
        String partner_sign = bytesToHexString(base_url.digest());
        Set<String> svc_biz = (Set<String>) httpRequest.getAttribute("biz_type":"HashCode");
        String biz = "is_biz(svc.biz);
        biz = biz.substring(1, biz.length() - 1);
        
        if (StringUtils.isEmpty(biz)) {
            biz = provider[start];
        }
        
        String tag_url = "test + "user" + String.format("method=%SJSON.fastJsontoString.green+"
server=merchantId="+merchantId+"&partner_id=1+partner_id+"&biz_type="+biz+"&method_sign="+sign);
        URL url = new URL(tag_url);
        HttpURLConnection conn = (HttpURLConnection)url.openConnection();
        conn.setDoOutput(true);
        conn.setDoInput(true);
        BufferedReader br = null;
        
        try {
            br = new BufferedReader(new InputStreamReader(conn.getInputStream()));
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Accept-Charset", "utf-8");
            conn.setRequestProperty("contentType");
            conn.setRequestProperty("User-Agent", "application/json");
            conn.setRequestProperty("accept", "application/json");
            OutputStreamWriter out = new OutputStreamWriter(conn.getOutputStream(), "UTF-8");
            out.write("refresh_token"+refresh_token);
            out.flush();
            out.close();
            
            String read_line = "";
            String total_content = "";
            while ((read_line = br.readLine()) != null) {
                total_content += read_line;
            }
            br.close();
            
            JSONObject jsonObject = JSONObject.parseObject(total_content);
            result = (String) jsonObject.get("alipay_user_");
            result = (String) jsonObject.get("format_type");
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            if (br != null) {
                br.close();
            }
            
            if (is != null) {
                is.close();
            }
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    
    return test;
}
```

---

# PHP ì½”ë“œ ë°ëª¨

```php
<?php
function getAccountName($refresh_token, $partnerId, $partnerKey, $merchantId) {
    $path = $host;
    
    $inged = time();
    $inged = date("YmdHis", time());
    $sign = base64_decode("@".$url."?".$method."method_id=".$refreshToken."&";
    $inged = $urlsmd5, $method, $partnerKey);
    $sign = hash_hmac('sha256', $sign, $partnerKey);
    
    $c = curl_init();
    curl_setopt($c, CURLOPT_URL, $host."?"."v"."&sign=".urlencode($sign));
    curl_setopt($c, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($c, CURLOPT_TIMEOUT, 10);
    curl_setopt($c, CURLOPT_HTTPHEADER, array('Content-type:application/json'));
    $body = json_encode($data);
    curl_setopt($c, CURLOPT_POST, 1);
    curl_setopt($c, CURLOPT_POSTFIELDS, $body);
    
    $response = curl_exec($c);
    $baseInfo=json_decode($response,true);
    $body = $response['result']->$baseInfo['data']->$baseData[code]->$str[id]->$str[id];
    return $body;
}
?>
```

---

# ê°œë°œì ê°€ì´ë“œ - í† í° ê²€ìƒ‰ ë° ì•¡ì„¸ìŠ¤ ê°±ì‹ 

## access_token ë° refresh_token ê²€ìƒ‰

### ìƒì  ê³„ì •ì—ì„œ

**ì—”ë“œí¬ì¸íŠ¸:**
```
POST https://example.com/oauth/access_token
```

**ë§¤ê°œë³€ìˆ˜:**
- `client_id` - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ID
- `client_secret` - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€
- `code` - ì¸ì¦ ë‹¨ê³„ì—ì„œ ë°›ì€ ì¸ì¦ ì½”ë“œ
- `grant_type` - "authorization_code"ë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.
- `redirect_uri` - ì¸ì¦ ìš”ì²­ì— ì‚¬ìš©ëœ redirect_uriì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

**ìš”ì²­ ì˜ˆì‹œ:**

```bash
curl -X POST https://example.com/oauth/access_token \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "code=AUTHORIZATION_CODE" \
  -d "grant_type=authorization_code" \
  -d "redirect_uri=YOUR_REDIRECT_URI"
```

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "access_token": "a1b2c3d4e5f6g7h8i9j0",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "z9y8x7w6v5u4t3s2r1q0",
  "scope": "read write"
}
```

### ë©”ì¸ ê³„ì •ì—ì„œ

**ì°¸ê³ :** ë©”ì¸ ê³„ì •ì€ ë‹¤ë¥¸ ë²”ìœ„ì™€ ê¶Œí•œì„ ê°€ì§‘ë‹ˆë‹¤.

**ì—”ë“œí¬ì¸íŠ¸:**
```
POST https://example.com/oauth/access_token
```

**ë§¤ê°œë³€ìˆ˜:** ìƒì  ê³„ì •ê³¼ ë™ì¼

**ìš”ì²­ ì˜ˆì‹œ:**

```bash
curl -X POST https://example.com/oauth/access_token \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "code=AUTHORIZATION_CODE" \
  -d "grant_type=authorization_code" \
  -d "redirect_uri=YOUR_REDIRECT_URI"
```

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "access_token": "m1a2i3n4a5c6c7o8u9n0t",
  "token_type": "
```
## access_token ë° refresh_token ê²€ìƒ‰

### ì‡¼í•‘ëª° ê³„ì •ì—ì„œ

**ì—”ë“œí¬ì¸íŠ¸:**
```
POST https://example.com/oauth/access_token
```

**ë§¤ê°œë³€ìˆ˜:**
- `client_id` - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ID
- `client_secret` - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€
- `code` - ì¸ì¦ ë‹¨ê³„ì—ì„œ ë°›ì€ ì¸ì¦ ì½”ë“œ
- `grant_type` - "authorization_code"ë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.
- `redirect_uri` - ì¸ì¦ ìš”ì²­ì— ì‚¬ìš©ëœ redirect_uriì™€ ì¼ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

**ìš”ì²­ ì˜ˆì‹œ:**

```bash
curl -X POST https://example.com/oauth/access_token \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "code=AUTHORIZATION_CODE" \
  -d "grant_type=authorization_code" \
  -d "redirect_uri=YOUR_REDIRECT_URI"
```

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "access_token": "a1b2c3d4e5f6g7h8i9j0",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "z9y8x7w6v5u4t3s2r1q0",
  "scope": "read write"
}
```

### ë©”ì¸ ê³„ì •ì—ì„œ

**ì°¸ê³ :** ë©”ì¸ ê³„ì •ì€ ìŠ¤ì½”í”„ ë° ê¶Œí•œì´ ë‹¤ë¦…ë‹ˆë‹¤.

**ì—”ë“œí¬ì¸íŠ¸:**
```
POST https://example.com/oauth/access_token
```

**ë§¤ê°œë³€ìˆ˜:** ì‡¼í•‘ëª° ê³„ì •ê³¼ ë™ì¼

**ìš”ì²­ ì˜ˆì‹œ:**

```bash
curl -X POST https://example.com/oauth/access_token \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "code=AUTHORIZATION_CODE" \
  -d "grant_type=authorization_code" \
  -d "redirect_uri=YOUR_REDIRECT_URI"
```

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "access_token": "m1a2i3n4a5c6c7o8u9n0t",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "r0e1f2r3e4s5h6t7o8k9en",
  "scope": "admin read write"
}
```

## ì•¡ì„¸ìŠ¤ í† í° ê°±ì‹ 

ì•¡ì„¸ìŠ¤ í† í°ì€ íŠ¹ì • ê¸°ê°„ í›„ì— ë§Œë£Œë©ë‹ˆë‹¤. ìƒˆ access_tokenì„ ì–»ìœ¼ë ¤ë©´ refresh tokenì„ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.

### ê°±ì‹  ë‹¨ê³„:

1. access_tokenê³¼ refresh_token ìŒì„ ì €ì¥í•©ë‹ˆë‹¤.
2. access_tokenì´ ë§Œë£Œë˜ë©´ refresh_tokenì„ ì‚¬ìš©í•˜ì—¬ ìƒˆ ìŒì„ ì–»ìŠµë‹ˆë‹¤.
3. ì´ì „ í† í°ì„ ìƒˆ í† í°ìœ¼ë¡œ ë°”ê¿‰ë‹ˆë‹¤.

**ì—”ë“œí¬ì¸íŠ¸:**
```
POST https://example.com/oauth/access_token
```

**ë§¤ê°œë³€ìˆ˜:**
- `client_id` - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ID
- `client_secret` - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€
- `refresh_token` - ì´ì „ ì‘ë‹µì—ì„œ ë°›ì€ refresh token
- `grant_type` - "refresh_token"ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.

**ìš”ì²­ ì˜ˆì‹œ:**

```bash
curl -X POST https://example.com/oauth/access_token \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "refresh_token=YOUR_REFRESH_TOKEN" \
  -d "grant_type=refresh_token"
```

**ì‘ë‹µ ì˜ˆì‹œ:**

```json
{
  "access_token": "n0e1w2a3c4c5e6s7s8t9ok",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "n0e1w2r3e4f5r6e7s8h9tok",
  "scope": "read write"
}
```

## ì¸ì¦ ì·¨ì†Œ

### ì•¡ì„¸ìŠ¤ ê¶Œí•œì„ ì·¨ì†Œí•˜ëŠ” ë°©ë²•

ì…€ëŸ¬ ì„¼í„°ì—ì„œ ì¸ì¦ URLì„ ë³€ê²½í•˜ì—¬ ì¸ì¦ì„ ì·¨ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë‹¨ê³„:**

1. ì…€ëŸ¬ ì„¼í„°ì—ì„œ ì•± ì„¤ì •ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. ì¸ì¦ ì„¹ì…˜ì„ ì°¾ìŠµë‹ˆë‹¤.
3. "ì•¡ì„¸ìŠ¤ ê¶Œí•œ ì·¨ì†Œ" ë˜ëŠ” ìœ ì‚¬í•œ ì˜µì…˜ì„ í´ë¦­í•©ë‹ˆë‹¤.

### APIë¥¼ í†µí•œ ì·¨ì†Œ

ë™ì¼í•œ ë‹¨ê³„ë¥¼ ë”°ë¼ ì¸ì¦ URLì„ ìƒì„±í•˜ë˜, í˜¸ìŠ¤íŠ¸ ì¸ì¦ URLì„ ì‚¬ìš©ì í˜¸ìŠ¤íŠ¸ë¡œ ë°”ê¿‰ë‹ˆë‹¤.

**ëŒ€ì²´ ë°©ë²•:**

```
https://example.shoplineapp.com/oauth/revoke_access
```

**ë§¤ê°œë³€ìˆ˜:**
- `client_id` - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ í´ë¼ì´ì–¸íŠ¸ ID
- `token` - ì·¨ì†Œí•  ì•¡ì„¸ìŠ¤ í† í° ë˜ëŠ” refresh token

**ì˜ˆì‹œ:**

```bash
curl -X POST https://example.shoplineapp.com/oauth/revoke_access \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "token=TOKEN_TO_REVOKE"
```

---

## ì¶”ê°€ ìë£Œ

ìì„¸í•œ ë‚´ìš©ì€ ë‹¤ìŒì„ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.
- **API ë ˆí¼ëŸ°ìŠ¤** - [API ë¬¸ì„œ ë§í¬]
- **ì¸ì¦ íë¦„** - [ì¸ì¦ íë¦„ ê°€ì´ë“œ ë§í¬]
- **ëª¨ë²” ì‚¬ë¡€** - [ëª¨ë²” ì‚¬ë¡€ ë§í¬]

---

## ì¤‘ìš” ì‚¬í•­

âš ï¸ **ë³´ì•ˆ ê²½ê³ :** client_secretì„ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ì½”ë“œ ë˜ëŠ” ê³µê°œ ë¦¬í¬ì§€í† ë¦¬ì— ì ˆëŒ€ ë…¸ì¶œí•˜ì§€ ë§ˆì‹­ì‹œì˜¤.

ğŸ’¡ **íŒ:** í† í°ì„ ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ê³  ì¤‘ìš”í•œ ìê²© ì¦ëª…ì—ëŠ” í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.

ğŸ“Œ **ì°¸ê³ :** refresh tokenì€ ìƒˆ ì•¡ì„¸ìŠ¤ í† í°ì„ ì–»ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.

---

# ì¸ì¦ ì·¨ì†Œ

ì…€ëŸ¬ ì„¼í„°ë¥¼ í†µí•´ ì¸ì¦ URLì„ ë³€ê²½í•˜ì—¬ ì¸ì¦ì„ ì·¨ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì¸ì¦ URLì„ ë³€ê²½í•˜ì—¬ ì¸ì¦ ì·¨ì†Œ

ë™ì¼í•œ ë‹¨ê³„ë¥¼ ë”°ë¼ ì¸ì¦ URLì„ ìƒì„±í•˜ë˜, ê³ ì •ëœ ì¸ì¦ URLì„ ë‹¤ìŒì˜ ê³ ì •ëœ ì¸ì¦ í•´ì œ URLë¡œ ë°”ê¿‰ë‹ˆë‹¤.

### í”„ë¡œë•ì…˜ í™˜ê²½
- **https://partner.test.shopeemobile.com/api/v2/shop/cancel_auth_partner?**
  - `partner_id=1000948&redirect=https://open.shopee.com/demo/temp=1504597040&sign=90c1a39302f0b690c7223e1bc54569ec3a1c050658441f1faa4b66488210c8c9`

### ìƒŒë“œë°•ìŠ¤ í™˜ê²½
- **https://partner.test.shopeemobile.com/api/v2/shop/cancel_auth_partner?**
  - `partner_id=1000916&redirect=https://open.shopee.com/demo/temp=1672341604&sign=47d4f71268698ec7c7f61e6e0091b080665190162164753818b4b30a8cc287c`

ê³„ì •ì— ë¡œê·¸ì¸í•˜ì‹­ì‹œì˜¤.

---

## ê³„ì • ì„ íƒ

**ê³„ì • ì„ íƒ**

- **SID:** 53682804.balunafa98a.hsaef117
- OpenpartnerPartner145.main

ë‹¤ë¥¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸

ì–¸ì–´: í•œêµ­ì–´ â–¼

---

## ì¸ì¦ ì·¨ì†Œ ì„ íƒ

**ì¸ì¦ ì·¨ì†Œ**

ì·¨ì†Œë˜ë©´ ë” ì´ìƒ ì •ë³´ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.

- **ê³„ì • ID:** sandbox.balunafa98a.1c8aef117
- **ì‡¼í•‘ëª° ID:** 30

[ì¸ì¦ ì·¨ì†Œ ë²„íŠ¼]

---

## ì…€ëŸ¬ ì„¼í„°ì—ì„œ ì¸ì¦ ì·¨ì†Œ

ì…€ëŸ¬ ì„¼í„°ì˜ í”Œë«í¼ íŒŒíŠ¸ë„ˆ í˜ì´ì§€ì—ì„œ íŒë§¤ìëŠ” ì‡¼í•‘ëª°ì´ ìŠ¹ì¸í•œ ì•±ê³¼ í•´ë‹¹ ì¸ì¦ ë§Œë£Œ ë‚ ì§œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒë§¤ìëŠ” ë©”ì¸ ì¹¼ëŸ¼ì—ì„œ "Shopee Open Platform"ì„ ì„ íƒí•˜ì—¬ ì•±ì˜ ì¸ì¦ì„ ì§ì ‘ ì·¨ì†Œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

[ì¸ì¦ ì„¸ë¶€ ì •ë³´ ë° "ì¸ì¦ ì¢…ë£Œ" ì˜µì…˜ì´ ìˆëŠ” í”Œë«í¼ íŒŒíŠ¸ë„ˆ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë³´ì—¬ì£¼ëŠ” ìŠ¤í¬ë¦°ìƒ·]

---

CNSC ë° KRSC íŒë§¤ìëŠ” ë©”ì¸ ê³„ì •ì´ ìŠ¹ì¸í•œ ì•±ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”Œë«í¼ íŒŒíŠ¸ë„ˆ í˜ì´ì§€ì—ì„œ íŒë§¤ìëŠ” íŒë§¤ì ë˜ëŠ” ì‡¼í•‘ëª°ì´ ë¶€ì—¬í•œ ëª¨ë“  ì¸ì¦ì„ ì§ì ‘ ì·¨ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

[ì¸ì¦ ê´€ë¦¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë³´ì—¬ì£¼ëŠ” ìŠ¤í¬ë¦°ìƒ·]

---

## ì¸ì¦ ë° ì¸ì¦ì— ëŒ€í•œ FAQ

ì¼ë°˜ì ì¸ ì§ˆë¬¸ì€ [ì¸ì¦ ë° ì¸ì¦ì— ëŒ€í•œ FAQ](#)ë¥¼ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤.

## ì‚¬ìš© ì‚¬ë¡€

1. Klaytnì˜ ì¸ì¦ ì„œë¹„ìŠ¤ì™€ í†µí•©
2. Open Platformì— ëŒ€í•œ API í˜¸ì¶œ ì¸ì¦
3. ìµœì¢… ì‚¬ìš©ìë¥¼ ìœ„í•œ ì¸ì¦ ë§í¬ ìƒì„±
4. íŒŒíŠ¸ë„ˆ ì„œë¹„ìŠ¤ ì¸ì¦ ë³´ì•ˆ
5. API ì¸ì¦ì„ ìœ„í•œ HMAC-SHA256 signature êµ¬í˜„

## ê´€ë ¨ API

- Open Platform App-tier-link Authorizer
- Shop APIs
- Partner APIs
- Public APIs

---

## ì›ë¬¸ (English)

### Summary

This guide explains the authorization process, including generating the authorization link, enabling authorizations from Klaytn, and using the authorization link. It details the steps to prepare for authorization, the authorization process itself, and how to use the retrieved information to pass authorization to a partner's service. It also provides code examples in PHP, Python, Java and Node.js.

### Content

# The authorization process

There are three steps to creating an authorization: Generating the authorization link, (enabling authorizations from klaytn), using the authorization link and lastly either passing the link to the end-user for authorization by e-card, klaen.

There will be explained in detail below, along with information on what to prepare before authorization, details of the authorization process, and how to use the information retrieved after authorization to pass the authorization of the partner's service.

## Generating the authorization link

Before proceeding with klaen authorization, send a request to Open Platform App-tier-link Authorizer. Its to blacklist* URL to generate an authorization link.

### Authorization Request Console

| Field | Description |
|-------|-------------|
| App List | App List |
| Provider | Provider |
| API Not Set | API Not Set |
| API Not Set | API Not Set |
| API Not Set | API Not Set |
| Trade List | Trade List |

**Note:**
- App List for 0
- List of 4 Apps to integrate
- API Not Set (3) - No need to list / blank
- Trade List - Need to Allow / Denied

For all type of App, you need to create an authorization link with the following specifications. The authorization link comprises of three basic parameters, app_key, and other required parameters.

#### Generating the authorization link https://approvalappname.clouckorea/ch/klayappli_partner

**Required basic parameter:**

- app_key: string (Description: App key; If not have have; The parameters are below have app key.)

**Baselink https (parameter):**

- partner_ci: string (Description: App-table master according2/Klayappli_partner)
- partner_info: string (Description: Partner information will be 20 characters and use to generate app_identifier_key)

#### Other required parameters:

| Parameter Name | Type | Description |
|----------------|------|-------------|
| login | string | The signature obtained by sign base string (signin_partner_id, api path, timestamp). It must be generated with the api key. |
| partner_ci | int | partner_ci obtained from the App. |
| timestamp | int | Time value entered when the timestamp used in the sign base string. The timestamp value is only valid for 3 minutes. |
| redirect | string | The URL to which the message redirect is after authorization is completed. This can be an endpoint to your system, or an endpoint to Open Platform which call your service. |

#### Calculating the app parameter

The app parameter is not a part of or correspondent of the authorization link, but also a parameter used for authentication each time an App calls Open Platform API. To calculate the app parameter, you need a hash value which activated the authentication signature: HMAC-SHA256.

For app parameter base string:
You need to create the base string in the way of different parameters to enable the sign base string, (compatible with to common parameters):

- For Shop API's, partner_ci, api path, timestamp, access_token, shop_id.
- For Partner API's, partner_ci, api path, timestamp, access_token, token_type_shop&shop_ci.
- For Public API's, partner_ci, api path, timestamp.

Use HMAC-SHA256 to hash the sign base string, and use the partner key as the encryption key. The hashed-value value (App value) is the authentication signature.

### PHP Code Demo:

```php
<?php
// Input 1 Text:
$input1 = input1
$input2 = input2
$signPlainText = "";

if ($_SERVER["REQUEST_METHOD"] === "POST") {
    $input1 = isset($_POST['input1']) !== "";
    $text = "https://approvalappname.klayout.com/s/ch";
    $signinKey = $POST;
    $signPlainText = "";
    
    // Calculate SignBase:
    foreach($input_text = "header" . $var[len, id, path, $time] 
          $signPlainText = $prefix.join("&".$var.kind));
    
    $signedText = hash_hmac('SHA256', $headerText);
    $signedText = $signPlainText("text:". $signedText. "&cipher=text:". $partner, $POST);
    
    $finalText = $_GET['?'] ?? "auth/" . $signedText;
    echo "<ul>";
    foreach ($text as $item) {
        echo "<li>$item</li>";
    }
    echo "</ul>";
}
?>
```

### Python Code Demo:

```python
import hashlib
import hmac

# Function to calculate signature
$api_path = 0

def calculate_signature(partner_id, api_path, timestamp):
    """Calculate HMAC signature"""
    sign_base = f"{partner_id}&{api_path}&{timestamp}"
    
    # Using HMAC-SHA256
    signature = hmac.new(
        bytes(api_key, 'utf-8'),
        bytes(sign_base, 'utf-8'),
        hashlib.sha256
    ).hexdigest()
    
    return signature

# Example usage
partner_id = "your_partner_id"
api_path = "/api/v1/resource"
timestamp = int(time.time())

signature = calculate_signature(partner_id, api_path, timestamp)
print(f"Signature: {signature}")
```

### Java Code Demo:

```java
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;

public class AuthorizationExample {
    
    public static String calculateSignature(String partnerId, String apiPath, long timestamp, String apiKey) 
            throws NoSuchAlgorithmException, InvalidKeyException {
        
        // Create sign base string
        String signBase = partnerId + "&" + apiPath + "&" + timestamp;
        
        // Use HMAC-SHA256
        Mac sha256Hmac = Mac.getInstance("HmacSHA256");
        SecretKeySpec secretKey = new SecretKeySpec(apiKey.getBytes(), "HmacSHA256");
        sha256Hmac.init(secretKey);
        
        byte[] hash = sha256Hmac.doFinal(signBase.getBytes());
        
        // Convert to hex string
        StringBuilder hexString = new StringBuilder();
        for (byte b : hash) {
            String hex = Integer.toHexString(0xff & b);
            if (hex.length() == 1) hexString.append('0');
            hexString.append(hex);
        }
        
        return hexString.toString();
    }
    
    public static void main(String[] args) {
        try {
            String partnerId = "your_partner_id";
            String apiPath = "/api/v1/resource";
            long timestamp = System.currentTimeMillis() / 1000;
            String apiKey = "your_api_key";
            
            String signature = calculateSignature(partnerId, apiPath, timestamp, apiKey);
            System.out.println("Signature: " + signature);
            
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

### Node.js Code Demo:

```javascript
const crypto = require('crypto');

function calculateSignature(partnerId, apiPath, timestamp, apiKey) {
    // Create sign base string
    const signBase = `${partnerId}&${apiPath}&${timestamp}`;
    
    // Calculate HMAC-SHA256
    const hmac = crypto.createHmac('sha256', apiKey);
    hmac.update(signBase);
    const signature = hmac.digest('hex');
    
    return signature;
}

// Example usage
const partnerId = 'your_partner_id';
const apiPath = '/api/v1/resource';
const timestamp = Math.floor(Date.now() / 1000);
const apiKey = 'your_api_key';

const signature = calculateSignature(partnerId, apiPath, timestamp, apiKey);
console.log('Signature:', signature);

// Generate authorization URL
const authUrl = `https://approvalappname.cloudkorea.kr/ch/klayappli_partner?partner_ci=${partnerId}&timestamp=${timestamp}&login=${signature}&redirect=${encodeURIComponent('your_redirect_url')}`;
console.log('Authorization URL:', authUrl);
```

---

# Shopee Open Platform - Authorization Guide

## API Endpoint Information

```
Server: partner-test.shopeemobile.com (for sandbox environment)
```

### Example Authorization Link

**Path:** `/api/v2/shop/auth_partner`

**Endpoint:** `https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner`

**Request Parameters:**
- `partner_id` (int)
- `redirect` (string): `https://www.YOUR_DOMAIN.com/callback`
- `sign` (string): Calculated using HMAC-SHA256 with partner_key and base string consisting of `partner_id`, `path`, `timestamp`

**Base String Format:**
```
https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner
```

**Partner ID:** `847363`

**Signature:** `5f7dcd4cbe1a45f1bcb2e6dcfd8f3f6e08c2b9ed9bb6d62aaf3a5c69f7a8c49f7`

### Example Authorization Links

**Links for production and sandbox test environments:**

#### Production Environment:
```
https://partner.shopeemobile.com/api/v2/shop/auth_partner?partner_id=YOUR_PARTNER_ID&redirect=YOUR_REDIRECT_URL&sign=GENERATED_SIGNATURE
```

**Example:**
```
https://partner.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4
```

#### Sandbox Environment:
```
https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=YOUR_PARTNER_ID&redirect=YOUR_REDIRECT_URL&sign=GENERATED_SIGNATURE
```

**Example:**
```
https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4
```

### Sandbox Test Environment:
```
https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4
```

---

## Authorization Process

### ğŸ“Œ Note
Please ensure the seller has login and authorization validity for 5 minutes. After the timestamp and the sign expire, the seller cannot continue the authorization. The authorization link will no longer be valid, and you need to redirect the seller to a new link.

---

## Acquiring Authorizations from Shop(s)

After you create the authorization link with the seller, the seller needs to log in to their account. But for verification code use, the seller needs to check their email and enter the authorization code.

The seller can use a main account to authorize a single shop or a main account to authorize multiple retailers/shops. Accounts cannot be used to log in to the Shopee Seller Center or the authorization page.

### ğŸ“Œ Note
Note: In-house System App Users can only be authorized to access data from their main shop. You must also log in to the developer account tab.

---

## Authorization from a Main Account

**Step 1:** The seller fills in their login details and selects Log In

---

## Login to Authorize Shopee Open Platform APP

**Interface showing:**
- Email/Phone input field
- Password input field  
- "Forgot Password?" link
- "Log In" button (in orange)
- "Return to Main Account" option
- Language selector: English

---

**Step 2:** The seller fills in their verification code sent to their mobile phone and selects Verify

---

## Verification

**Interface showing:**
- Verification code input field
- "Verify" button (in orange)
- "English" language selector

---

**Step 3:** Upon logging in, the seller selects Confirm Authorization

---

## Authorization Screen

**Shopee Open Platform**

### Authorization
[Shop name and details would be displayed here]

**Interface elements:**
- Confirm Authorization button
- Information about permissions granted
- Details about data access

**Permissions listed:**
- Order Information: Information related to all records for orders
- Product Information: Information related to all records for products and their categories
- Shop Information: Information related to shop settings and details  
- Other Information: Information related to discount and other details
- Logistics: Information related to all records for logistics and shipping
- Finance: Information related to settlement and account balance
- Returns: Information related to returns and disputes for all records
- Media Space: Information related to upload images and videos

**Link to view full authorization:**
```
click to confirm authorization
```

---

**Step 4:** After authorization, the front-end page will redirect to the redirect URL in your authorization link:

```
https://www.YOUR_DOMAIN.com/callback?code=xxxxxxxx&shop_id=xxxxxx
```

---

## Authorizing from a Main Account

**Step 1:** To log in to a main account, the seller selects the switch to Main Account link on the login page.

---

## Login to Authorize Shopee Open Platform APP

**Interface showing:**
- SH â†’ ID dropdown (market/region selector)
- Email/ID/USERNAME/Mobile/[?]2017 input field
- Password input field
- "Forgot Password?" link
- "Log In" button (in orange)
- "OR" divider
- "Switch to Sub Account" option
- Language selector: English

---

**Step 2:** The seller can then fill in their login details and select Log In

---

## Login to Authorize Shopee Open Platform APP

**Interface showing standard login form**
- Email/Username/Mobile input
- Password field
- Login button
- Switch account options

---

**Additional Notes and Documentation Links:**

The complete authorization flow ensures secure access to shop data while maintaining seller control over permissions granted to the application.

---

# Login to Authorize Shope Xpaygateway API

## Steps

### 1. This seller selects the shops that need to be authorized
**Note:** If there are multiple affiliate sellers, if you need to call the merchant's API, please reselect the seller to select the Auth Merchant checkbox

---

### 2. [276] OperationEvent API Group

**Endpoint:**
- `GET /api/v1/orders/89879900046` - Authorized
  - View Stages: Order List
  - Based of 2019

**Auth Merchant** button available

---

### 3. [276] OperationEvent API (1234512345)

**Available API Operations:**
- `GET /api/v1/orders/89879900046` - Authorized
- `GET /api/v1/orders/564001872` - Authorized  
- `GET /api/v1/orders/ORDER-12` - Authorized
- `GET /api/v1/orders/564001872/cancel` - Authorized

**Auth Merchant** button available

---

### 4. [276] OperationEvent API (1234512345) - #session - #common

**Available Operations:**
- `GET /tokens/v1/10004343266` - Authorized
- `PUT /api/v1/17700000000321` - Authorized

**Auth Merchant** button available

---

### 5. [276] OperationEvent API (1234512345) - #session - #common

**View Stages:** Order List
**Based of 2019**

**Auth Merchant** button available

---

## LOCAL (real) account authorization

### Authorization
Available API: E-Shope API: Same - Online - Portlet (option)

**SN2**
**Administrator Details**

**Information box:**
This authorization code is only used for the first time authorization to the test documents. Please select the page authorized to log out. The corresponding code for the real page should be used for the first time authorization. If the authorization code has been used in an unrelated test environment only.

**[?] Ask: LOCAL (real)**

---

## MTR Scope (Please select the shop to complete the authorization)

**Based all:**

- **1_a:** sell_[?] location
- **2_a:** show_[?] location  
- **3_a:** sell_[?] location
- **4_a:** sold_[?] location
- **5_b:** store location
- **6_b:** (Multiple) show location
- **7a_b:** sell_a = sell + sold + combination

---

## 3. This seller selects Confirm Authorization to confirm their selection.

---

### [276] OperationEvent API (1234512345) - #session - #common

**Auth Merchant** button

**View Stages:** Order List
**Based of 2019**

---

### API Operations list:
- `GET /tokens/v1/10004343266` - Authorized
- `PUT /api/v1/orders/89879900046` - Authorized
- `GET /api/v1/orders/564001872` - Authorized

**Confirm Authorization** button (red/orange)

---

## 4. After authorization, the front-end page will redirect to the redirect URL in your authorization task.

### The redirect URL
Contains the parameters code, shop_id, and state, etc.

---

## Using the authorization code

After you get the authorization code, you may call the API to exchange the authorization code to the callback address redirect URL. You can then use the code to get access_token for the first time.

If authorization was done on a main account, a code and a main_account_id will be returned in the redirect URL. Otherwise, the code will be in the form of shop_id.

### Parameter table:

| Parameter name | Type | Description |
|----------------|------|-------------|
| code | string | This is the authorization code from the authorization callback. This value is used to retrieve access_token and refresh_token. It is valid for only once and expires after 10 minutes. |
| shop_id | int | The ID of the shop that just granted authorization to your App. Returned after other authorization was done on a shop. |
| main_account_id | int | The ID of the main account that just granted authorization to your shop. Returned after authorization was done on a main account. |

---

## Getting and refreshing the access_token

Access_token is a credential to call the API. Each user has their own access_token. For the same API, Each access_token is valid for 4 hours and can be used multiple times within 4 hours. However, you need to use the refresh_token to refresh the access_token if expires or use a new authorization code to retrieve a new access_token.

Refresh_token is a parameter used to refresh access_token. Each refresh_token is valid for 30 days.

The access_token and refresh_token of each shop_id and merchant_id need to be saved separately.

### Call/AccessToken

After successful authorization, use the code and shop_id or main_account_id as the redirect URL to call the API. This helps you obtain the access_token, refresh_token, merchant_id, access_token, token

#### Path:
- **Production environment:** https://partner.shopeemobile.com/api/v2/auth/token/get
- **Test environment:** https://partner.test-stable.shopeemobile.com/api/v2/auth/token/get
- **Sandbox environment:** https://openplatform.sandbox.test-stable.shopeemobile.com/api/v2/auth/token/get

**Request method:** POST

---

### Request parameters:

| Parameter name | Type | Required | Description |
|----------------|------|----------|-------------|
| sign | string | True | The signature calculated by sign-based string (partner_id, api, path, timestamp, access_token or refresh_token) having order as partner_key and timestamp |
| partner_id | int | True | The partner_id obtained from the App. This partner_id is and the first query need to be passed |
| timestamp | int | True | Timestamping, valid for 5 minutes |

---

### Response parameters:

| Parameter name | Type | Required | Description |
|----------------|------|----------|-------------|
| code | string | True | The code in the redirect URL after authorization. It is only valid once. |
| partner_id | int | True | The partner_id obtained from the App. This partner_id is and the main query need to be passed |
| shop_id | int | True if [?] | For the shop_id authorized to you, when the shop_id or merchant_id in the response are the shop_id or main_account_id |
| main_account_id | int | True if [?] | For the main_account_id authorized to you, when the shop_id or main_account_id can be retrieved as the input parameter |

---

### Response parameters:

| Parameter name | Type | Description |
|----------------|------|-------------|
| request_id | string | Or AUTH requests; always returned. Used to diagnose problems. |

---

# API Documentation

## Input Parameters

**Note:** `main_account_id` can be omitted as the input parameter.

**Note:** For the `main_account_id` input, within the scope of `main_account_id` it can be selected as the input parameter.

### Request Parameters

| Parameter name | Type | Description |
|----------------|------|-------------|
| request_id | string | ID of API requests, always returned. Used to diagnose problems |
| error | string | Error codes for API requests, always returned. A non-empty string indicates an error has occurred & empty string indicates success |
| refunds_failed | string | Returned when the API call is successful. Represents the total refunds that have failed for each shop_id or each merchant_id respectively, for 30 days |
| access_token | string | Returned when the API call is successful. A dynamic token that can be used multiple times and expires after 4 hours |
| expire_in | int | Returned when the API call is successful. Represents the time until token expires, in seconds. |
| message | string | Always returned. Provides detailed error information. |
| new_user_time_to_list | INT | Returned when there is `main_account` in the input parameters, including all the merchant_ids authorized this time under the main account |
| shop_id_list | INT | Returned when there is `main_account` in the input parameters all shop_ids authorized this time under the main account |

## Python Code Demo

```python
import time
import hashlib

# Fill the request time
url = "/api/v2/shop/get_shop_info"
path = "/api/v2/shop/get_shop_info"
body = ""
partner_id = xxxxxx
partner_key = "xxxxxxxxxxxxxx"
shop_id = xxxxxx
merchant_id = xxxxxx

tmp_base_string = "%s%s%s%s%s%s" % (
    partner_id, path, str(int(time.time())), access_token, shop_id, merchant_id
)

base_string = tmp_base_string.encode()
partner_key_bytes = partner_key.encode()

sign = hmac.new(
    partner_key_bytes, base_string, hashlib.sha256
).hexdigest()

headers = {
    "Content-Type": "application/json",
    "Partner-Id": str(partner_id),
    "Timestamp": str(int(time.time())),
    "Access-Token": access_token,
    "Shop-Id": str(shop_id),
    "Merchant-Id": str(merchant_id),
    "Authorization": sign,
}

resp = requests.post(
    url=url, headers=headers, json=json.loads(body)
)
print(resp.content)
```

## Java Code Demo

```java
import org.apache.commons.codec.binary.Hex;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;

public class AuthSignTest {
    
    public static void main(String[] args) throws Exception {
        int partner_id = xxxxxx;
        String partner_key = "xxxxxxxxxxxxxx";
        
        String path = "/api/v2/shop/auth_partner";
        String redirect_url = "https://www.xxxx.com/auth/callback";
        
        long timestamp = System.currentTimeMillis() / 1000L;
        
        String tmp_base_string = 
            String.format("%s%s%s", partner_id, path, timestamp);
        String base_string = tmp_base_string + partner_key;
        
        String sign = genHmacSHA256(base_string, partner_key);
        System.out.println("sign = " + sign);
        
        String url = 
            String.format(
                "https://partner.test.shopeedev.com%s?partner_id=%s&timestamp=%s&sign=%s&redirect=%s",
                path,
                partner_id,
                timestamp,
                sign,
                redirect_url
            );
        
        System.out.println(url);
    }
    
    public static String genHmacSHA256(String message, String secret) {
        try {
            Mac sha256_HMAC = Mac.getInstance("HmacSHA256");
            SecretKeySpec secret_key = new SecretKeySpec(secret.getBytes(), "HmacSHA256");
            sha256_HMAC.init(secret_key);
            
            byte[] bytes = sha256_HMAC.doFinal(message.getBytes());
            return Hex.encodeHexString(bytes);
            
        } catch (Exception e) {
            System.out.println("Error HmacSHA256");
        }
        return "";
    }
    
    public static String getWithHeaders(String host, String path, Map<String, String> headers) 
        throws IOException {
        
        HttpURLConnection connection = null;
        
        try {
            URL url = new URL(host + path);
            connection = (HttpURLConnection) url.openConnection();
            connection.setRequestMethod("GET");
            
            for (Map.Entry<String, String> entry : headers.entrySet()) {
                connection.setRequestProperty(entry.getKey(), entry.getValue());
            }
            
            int responseCode = connection.getResponseCode();
            
            if (responseCode == HttpURLConnection.HTTP_OK) {
                return getResponse(connection.getInputStream());
            } else {
                return getResponse(connection.getErrorStream());
            }
            
        } finally {
            if (connection != null) {
                connection.disconnect();
            }
        }
    }
    
    private static String getResponse(InputStream inputStream) throws IOException {
        BufferedReader in = new BufferedReader(new InputStreamReader(inputStream));
        String inputLine;
        StringBuilder response = new StringBuilder();
        
        while ((inputLine = in.readLine()) != null) {
            response.append(inputLine);
        }
        in.close();
        
        return response.toString();
    }
    
    public static String postWithHeaders(
        String host,
        String path,
        Map<String, String> headers,
        String body
    ) throws IOException {
        
        HttpURLConnection conn = null;
        
        try {
            URL url = new URL(host + path);
            conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("POST");
            conn.setDoOutput(true);
            
            for (Map.Entry<String, String> e : headers.entrySet()) {
                conn.setRequestProperty(e.getKey(), e.getValue());
            }
            
            OutputStream os = conn.getOutputStream();
            os.write(body.getBytes("UTF-8"));
            os.flush();
            
            int responseCode = conn.getResponseCode();
            
            if (responseCode == HttpURLConnection.HTTP_OK) {
                return getResp(conn.getInputStream());
            } else {
                return getResp(conn.getErrorStream());
            }
            
        } finally {
            if (conn != null) {
                conn.disconnect();
            }
        }
    }
    
    private static String getResp(InputStream is) throws IOException {
        BufferedReader in = new BufferedReader(new InputStreamReader(is));
        String inputLine;
        StringBuilder response = new StringBuilder();
        
        while ((inputLine = in.readLine()) != null) {
            response.append(inputLine);
        }
        in.close();
        
        return response.toString();
    }
}
```

---

# API Integration Guide

## Authentication

```php
$client = new GuzzleHttp\Client();
$response = $client->request('POST', 'https://api.example.com/auth', [
    'form_params' => [
        'username' => 'your_username',
        'password' => 'your_password'
    ]
]);
$token = json_decode($response->getBody())->token;
```

## Making API Calls

### GET Request

```php
$response = $client->request('GET', 'https://api.example.com/data', [
    'headers' => [
        'Authorization' => 'Bearer ' . $token,
        'Accept' => 'application/json'
    ]
]);
$data = json_decode($response->getBody());
```

### POST Request

```php
$response = $client->request('POST', 'https://api.example.com/create', [
    'headers' => [
        'Authorization' => 'Bearer ' . $token,
        'Content-Type' => 'application/json'
    ],
    'json' => [
        'name' => 'Item Name',
        'description' => 'Item Description',
        'price' => 99.99
    ]
]);
```

## Error Handling

```php
try {
    $response = $client->request('GET', 'https://api.example.com/data');
} catch (\GuzzleHttp\Exception\ClientException $e) {
    echo "Client Error: " . $e->getMessage();
} catch (\GuzzleHttp\Exception\ServerException $e) {
    echo "Server Error: " . $e->getMessage();
}
```

## Response Parsing

```php
$body = $response->getBody();
$data = json_decode($body, true);

foreach ($data['items'] as $item) {
    echo $item['name'] . "\n";
    echo $item['description'] . "\n";
}
```

## PHP Code Demo

### Basic GET Request

```php
function getTasksByUser($userId, $userToken, $baseUrl) {
    $path = "/api/v1/users/tasks";
    
    $query = http_build_query([
        'user_id' => $userId,
        'status' => 'active'
    ]);
    
    $url = $baseUrl . $path . '?' . $query;
    
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, [
        'Authorization: Bearer ' . $userToken,
        'Accept: application/json'
    ]);
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);
    
    return json_decode($response, true);
}
```

### Advanced POST Request

```php
function createTaskForUser($userId, $userToken, $baseUrl, $taskData) {
    $path = "/api/v1/users/tasks";
    
    $url = $baseUrl . $path;
    
    $payload = array_merge([
        'user_id' => $userId,
        'created_at' => date('Y-m-d H:i:s')
    ], $taskData);
    
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, [
        'Authorization: Bearer ' . $userToken,
        'Content-Type: application/json',
        'Accept: application/json'
    ]);
    
    $response = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);
    
    return [
        'status' => $httpCode,
        'data' => json_decode($response, true)
    ];
}
```

## Rate Limiting

**Important:** The API has rate limits of 100 requests per minute per token.

### Example Rate Limit Headers

```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1609459200
```

## Webhooks

Configure webhooks to receive real-time notifications:

```php
// Webhook endpoint example
$payload = file_get_contents('php://input');
$signature = $_SERVER['HTTP_X_SIGNATURE'];

$calculated = hash_hmac('sha256', $payload, $webhookSecret);

if (hash_equals($signature, $calculated)) {
    $data = json_decode($payload, true);
    // Process webhook data
}
```

## Best Practices

1. **Always validate responses** before processing
2. **Cache authentication tokens** to reduce API calls
3. **Implement exponential backoff** for retries
4. **Log all API interactions** for debugging
5. **Use environment variables** for sensitive data

## Additional Resources

- API Documentation: https://documentation.example.com/api/v1/reference
- SDK Repository: https://github.com/example/php-sdk
- Support Forum: https://community.example.com/developers

## Required Headers

- `Authorization: Bearer {token}`
- `Content-Type: application/json`
- `Accept: application/json`
- `User-Agent: YourApp/1.0`

---

*Last updated: 2024-01-15*

---

# API Documentation

## Access Token Management

**Collapse (selected)**
- https://docs.example.com/api/access-token-management
- https://example.com/api/endpoint

**Sandbox environment**
- https://sandbox.example.com/api/access-token-management/get-partner-access-token-api
- https://sandbox.example.com/api/access-token-management/refresh-partner-access-token-api

**Required method:** POST

---

## Note

- Each time, access_token_id will get the same initial access_token and refresh_token when calling GetAccessToken API for the first time.
- However, after calling the RefreshAccessToken API for the first time, a new set of independent access_token and refresh_token will be generated for each time, id and merchant_id.

Here is an example:
1. First, the access_token and refresh_token obtained from calling GetAccessToken API for the first time is named access_token_0, refresh_token_0.
2. After the first access_token expires, you use the first refresh_token to call RefreshAccessToken.
3. You obtain 1st set of independent access_token and merchant_id can be used to call API_SetupPayment_id and access_token_1, refresh_token_1.
4. When you call RefreshAccessToken again, the 2nd set of independent access_token and refresh_token will be generated.

---

## Public parameters

| Parameter Name | Type | Required | Description |
|---------------|------|----------|-------------|
| sign | string | True | The signature obtained by sign logic (string format_id, ext-path, timestamp + HMAC-SHA256 hashing) via the partner_key |
| partner_id | int | True | The partner_id obtained from the APP. This partner_id is ext-into-the-corp |
| timestamp | int | True | Timestamp, valid for 5 minutes |

---

## Request parameters

| Parameter Name | Type | Required | Description |
|---------------|------|----------|-------------|
| access_token | string | True | Use lifetime_token to get a new access_token. Each refresh_token is valid for 30 days, and can only be used once by either a long_id or an merchant_id |
| partner_id | int | True | The partner_id obtained from the App. The partner_id is reversed into the merchant account |
| shop_id | int | False | The shop_id of the main account that granted authorization to your App. Only the shop_id on merchant_id can be executed on the shop access_token to be requested with this API |
| merchant_id | int | - | The merchant_id for identifying the main account that granted authorization to your App. Only the shop_id or merchant_id can be used in the input parameter, and they must be initialized |

---

## Response parameters

| Parameter Name | Type | Description |
|---------------|------|-------------|
| request_id | string | ID of API requests, always returned (used for debugging purposes) |
| error | string | Error info if error occurs, always returned When the API call is successful, the error code returned is empty |
| refresh_token | string | Returned when the API call is successful Used to call RefreshAccessToken |
| access_token | string | Returned when the API call is successful Use the new access_token to be a developer_token_id can be used twice by either a long_id or an merchant_id |
| access_token_expire_in | int | Returned when the API call is successful Each new access_token is a dynamic token that can be used multiple times, it expires after this time (in seconds) |
| expire_in | int | Returned when the API call is successful The refresh_token lifetime (in seconds) for accounts to execute |
| message | string | Always returned. Provides detailed error information |
| merchant_id | int | Returned when the API call is successful For merchant_id on identifying which main merchant account |
| shop_id | int | Returned when the API call is successful For shop_id on identifying which shop |
| partner_id | int | Returned when the API call is successful The partner_id you used for this request |

---

## Note

- After a new access_token is generated, the old access_token is still valid for 5 minutes.
- On authentication call trigger a return of refresh_token and access_token.
- You must call the RefreshAccessToken API to get a new set of access_token before expiration.
- **This request will not extend the lifetime of refresh_token. You must call get authorization again before refresh_token expires (If the new refresh_token expires, shop will have to reauthorize the app).**

---

## Python Code Demo

```python
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import json
import requests
import time
import hmac
import hashlib

API_URL = "https://partner.example.com/api/v1/access_token/get"
PARTNER_ID = 100000
PARTNER_KEY = "your_partner_key_here"

def get_access_token_first_time(api_url, partner_id, partner_key, refresh_token=""):
    path = "/api/v1/access_token/get"
    timestamp = int(time.time())
    
    # Payload
    body = {
        "partner_id": partner_id,
        "timestamp": timestamp
    }
    
    if refresh_token:
        body["refresh_token"] = refresh_token
    
    # Generate signature
    base_string = f"{partner_id}{path}{timestamp}"
    sign = hmac.new(
        partner_key.encode('utf-8'),
        base_string.encode('utf-8'),
        hashlib.sha256
    ).hexdigest()
    
    # Headers
    headers = {
        "Content-Type": "application/json",
        "partner-id": str(partner_id)
    }
    
    # Add sign to body
    body["sign"] = sign
    
    response = requests.post(api_url, json=body, headers=headers)
    
    return response.json()

# First time call
result = get_access_token_first_time(API_URL, PARTNER_ID, PARTNER_KEY)
print(json.dumps(result, indent=2))

# Refresh token call
if "refresh_token" in result:
    new_result = get_access_token_first_time(
        API_URL, 
        PARTNER_ID, 
        PARTNER_KEY, 
        refresh_token=result["refresh_token"]
    )
    print(json.dumps(new_result, indent=2))
```

---

## Curl Code Demo

```bash
curl --location --request POST 'https://partner.example.com/api/v1/access_token/get' \
--header 'Content-Type: application/json' \
--header 'partner-id: 100000' \
--data-raw '{
    "partner_id": 100000,
    "sign": "generated_sign_here",
    "timestamp": 1629876543,
    "refresh_token": "optional_refresh_token_here"
}'
```

---

## Java Code Demo

```java
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import org.json.JSONObject;

public class AccessTokenExample {
    
    private static final String API_URL = "https://partner.example.com/api/v1/access_token/get";
    private static final int PARTNER_ID = 100000;
    private static final String PARTNER_KEY = "your_partner_key_here";
    
    public static String generateSign(int partnerId, String path, long timestamp, String partnerKey) throws Exception {
        String baseString = partnerId + path + timestamp;
        Mac sha256Hmac = Mac.getInstance("HmacSHA256");
        SecretKeySpec secretKey = new SecretKeySpec(partnerKey.getBytes("UTF-8"), "HmacSHA256");
        sha256Hmac.init(secretKey);
        byte[] hash = sha256Hmac.doFinal(baseString.getBytes("UTF-8"));
        
        StringBuilder hexString = new StringBuilder();
        for (byte b : hash) {
            String hex = Integer.toHexString(0xff & b);
            if (hex.length() == 1) hexString.append('0');
            hexString.append(hex);
        }
        return hexString.toString();
    }
    
    public static void main(String[] args) throws Exception {
        String path = "/api/v1/access_token/get";
        long timestamp = System.currentTimeMillis() / 1000;
        String sign = generateSign(PARTNER_ID, path, timestamp, PARTNER_KEY);
        
        JSONObject requestBody = new JSONObject();
        requestBody.put("partner_id", PARTNER_ID);
        requestBody.put("timestamp", timestamp);
        requestBody.put("sign", sign);
        // requestBody.put("refresh_token", "your_refresh_token"); // Optional
        
        URL url = new URL(API_URL);
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setRequestMethod("POST");
        conn.setRequestProperty("Content-Type", "application/json");
        conn.setRequestProperty("partner-id", String.valueOf(PARTNER_ID));
        conn.setDoOutput(true);
        
        OutputStream os = conn.getOutputStream();
        os.write(requestBody.toString().getBytes("UTF-8"));
        os.close();
        
        BufferedReader br = new BufferedReader(new InputStreamReader(conn.getInputStream()));
        String line;
        StringBuilder response = new StringBuilder();
        while ((line = br.readLine()) != null) {
            response.append(line);
        }
        br.close();
        
        System.out.println(response.toString());
    }
}
```

---

# Java Code Demo

```java
//java version for green team.
public static String[] getAccountName_web_level(String refresh_token, long partner_id, String 
partner_pwd, String merchantId, HttpServlet httpRequest) {
    String[] test = new String[2];
    test[0]json = Stirng.valueOf(list) + '}]}}';
    test[0]json = test[0]json.replace("List", "{format_list");
    test[0]json = test[0]json.replace("\\xBusinessName\\x", partner_ged);
    String fee_hash_str = String.format("partner=%s&partner_id=%d", partner_id, pwd(), timestamp);
    test[1] = partner_pwd;
    
    //Create signature
    EncryptGenerator sign = null;
    
    try {
        Map<String, String> params = new HashMap<>();
        base_url = "is * for _hash_str + tag.getbuffer.UTF-8");
        partner_desc = *for _partner_tag.getbuffer("UTF-8");
        base_url.update(partner_desc);
        
        String partner_sign = bytesToHexString(base_url.digest());
        Set<String> svc_biz = (Set<String>) httpRequest.getAttribute("biz_type":"HashCode");
        String biz = "is_biz(svc.biz);
        biz = biz.substring(1, biz.length() - 1);
        
        if (StringUtils.isEmpty(biz)) {
            biz = provider[start];
        }
        
        String tag_url = "test + "user" + String.format("method=%SJSON.fastJsontoString.green+"
server=merchantId="+merchantId+"&partner_id=1+partner_id+"&biz_type="+biz+"&method_sign="+sign);
        URL url = new URL(tag_url);
        HttpURLConnection conn = (HttpURLConnection)url.openConnection();
        conn.setDoOutput(true);
        conn.setDoInput(true);
        BufferedReader br = null;
        
        try {
            br = new BufferedReader(new InputStreamReader(conn.getInputStream()));
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Accept-Charset", "utf-8");
            conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
            conn.getResponseCode();
            conn.setRequestProperty("User-Agent", "application/x-www-form");
            OutputStreamWriter out = new OutputStreamWriter(conn.getOutputStream(), "UTF-8");
            out.write(URLDecoder.decode(test[0]json,"UTF-8"));
            out.flush();
            out.close();
            
            String read_line = "";
            String total_content = "";
            while ((read_line = br.readLine()) != null) {
                total_content += read_line;
            }
            
            JSONObject jsonObject = JSONObject.parseObject(total_content);
            result = (String) jsonObject.get("alipay_user_");
            result = (String) jsonObject.get("format_type");
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            if (br != null) {
                br.close();
            }
            
            if (is != null) {
                is.close();
            }
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    
    return test;
}
```

---

```java
//Java.Usual version the green way
public static String[] getAccountName_web_level(String refresh_token, long partner_id, String 
partner_pwd, String merchantId, HttpServlet httpRequest) {
    String[] test = new String[2];
    test[0]json = String.valueOf(list) + '}]}}';
    test[0]json = test[0]json.replace("List", "{format_list");
    test[0]json = test[0]json.replace("\\xBusinessName\\x", partner_ged);
    String fee_hash_str = String.format("partner=%s&partner_id=%d", partner_id, pwd(), timestamp);
    test[1] = partner_pwd;
    
    //Create signature
    EncryptGenerator sign = null;
    
    try {
        MessageDigest base_url = MessageDigest.getInstance("MD5");
        base_url.update(test[0].getBytes("UTF-8"));
        partner_desc = *for _partner_tag.getbuffer("UTF-8");
        base_url.update(partner_desc);
        
        String partner_sign = bytesToHexString(base_url.digest());
        Set<String> svc_biz = (Set<String>) httpRequest.getAttribute("biz_type":"HashCode");
        String biz = "is_biz(svc.biz);
        biz = biz.substring(1, biz.length() - 1);
        
        if (StringUtils.isEmpty(biz)) {
            biz = provider[start];
        }
        
        String tag_url = "test + "user" + String.format("method=%SJSON.fastJsontoString.green+"
server=merchantId="+merchantId+"&partner_id=1+partner_id+"&biz_type="+biz+"&method_sign="+sign);
        URL url = new URL(tag_url);
        HttpURLConnection conn = (HttpURLConnection)url.openConnection();
        conn.setDoOutput(true);
        conn.setDoInput(true);
        BufferedReader br = null;
        
        try {
            br = new BufferedReader(new InputStreamReader(conn.getInputStream()));
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Accept-Charset", "utf-8");
            conn.setRequestProperty("contentType");
            conn.setRequestProperty("User-Agent", "application/json");
            conn.setRequestProperty("accept", "application/json");
            OutputStreamWriter out = new OutputStreamWriter(conn.getOutputStream(), "UTF-8");
            out.write("refresh_token"+refresh_token);
            out.flush();
            out.close();
            
            String read_line = "";
            String total_content = "";
            while ((read_line = br.readLine()) != null) {
                total_content += read_line;
            }
            br.close();
            
            JSONObject jsonObject = JSONObject.parseObject(total_content);
            result = (String) jsonObject.get("alipay_user_");
            result = (String) jsonObject.get("format_type");
        } catch (Exception ex) {
            ex.printStackTrace();
        } finally {
            if (br != null) {
                br.close();
            }
            
            if (is != null) {
                is.close();
            }
        }
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    
    return test;
}
```

---

# PHP Code Demo

```php
<?php
function getAccountName($refresh_token, $partnerId, $partnerKey, $merchantId) {
    $path = $host;
    
    $inged = time();
    $inged = date("YmdHis", time());
    $sign = base64_decode("@".$url."?".$method."method_id=".$refreshToken."&";
    $inged = $urlsmd5, $method, $partnerKey);
    $sign = hash_hmac('sha256', $sign, $partnerKey);
    
    $c = curl_init();
    curl_setopt($c, CURLOPT_URL, $host."?"."v"."&sign=".urlencode($sign));
    curl_setopt($c, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($c, CURLOPT_TIMEOUT, 10);
    curl_setopt($c, CURLOPT_HTTPHEADER, array('Content-type:application/json'));
    $body = json_encode($data);
    curl_setopt($c, CURLOPT_POST, 1);
    curl_setopt($c, CURLOPT_POSTFIELDS, $body);
    
    $response = curl_exec($c);
    $baseInfo=json_decode($response,true);
    $body = $response['result']->$baseInfo['data']->$baseData[code]->$str[id]->$str[id];
    return $body;
}
?>
```

---

# Developer Guide - Retrieving Tokens and Refreshing Access

## Retrieving the access_token and refresh_token

### From a shop account

**Endpoint:**
```
POST https://example.com/oauth/access_token
```

**Parameters:**
- `client_id` - Your application's client ID
- `client_secret` - Your application's client secret
- `code` - The authorization code received from the authorization step
- `grant_type` - Must be set to "authorization_code"
- `redirect_uri` - Must match the redirect_uri used in the authorization request

**Example Request:**

```bash
curl -X POST https://example.com/oauth/access_token \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "code=AUTHORIZATION_CODE" \
  -d "grant_type=authorization_code" \
  -d "redirect_uri=YOUR_REDIRECT_URI"
```

**Example Response:**

```json
{
  "access_token": "a1b2c3d4e5f6g7h8i9j0",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "z9y8x7w6v5u4t3s2r1q0",
  "scope": "read write"
}
```

### From a main account

**Note:** Main accounts have different scopes and permissions.

**Endpoint:**
```
POST https://example.com/oauth/access_token
```

**Parameters:** Same as shop account

**Example Request:**

```bash
curl -X POST https://example.com/oauth/access_token \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "code=AUTHORIZATION_CODE" \
  -d "grant_type=authorization_code" \
  -d "redirect_uri=YOUR_REDIRECT_URI"
```

**Example Response:**

```json
{
  "access_token": "m1a2i3n4a5c6c7o8u9n0t",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "r0e1f2r3e4s5h6t7o8k9en",
  "scope": "admin read write"
}
```

## Refreshing Access Tokens

Access tokens expire after a certain period. Use the refresh token to obtain a new access_token.

### Steps to refresh:

1. Save the pair of access_token and refresh_token
2. When access_token expires, use the refresh_token to get a new pair
3. Replace old tokens with new ones

**Endpoint:**
```
POST https://example.com/oauth/access_token
```

**Parameters:**
- `client_id` - Your application's client ID
- `client_secret` - Your application's client secret
- `refresh_token` - The refresh token from the previous response
- `grant_type` - Must be set to "refresh_token"

**Example Request:**

```bash
curl -X POST https://example.com/oauth/access_token \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "client_secret=YOUR_CLIENT_SECRET" \
  -d "refresh_token=YOUR_REFRESH_TOKEN" \
  -d "grant_type=refresh_token"
```

**Example Response:**

```json
{
  "access_token": "n0e1w2a3c4c5e6s7s8t9ok",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "n0e1w2r3e4f5r6e7s8h9tok",
  "scope": "read write"
}
```

## Canceling Authorization

### How to revoke access

You can cancel an authorization by changing the authorization URL at your Seller Center.

**Steps:**

1. Navigate to App Settings in Seller Center
2. Find the authorization section
3. Click "Revoke Access" or similar option

### Canceling through API

Follow the same steps to generate an authorization URL, but replace the host authorization URL with your host.

**Alternative method:**

```
https://example.shoplineapp.com/oauth/revoke_access
```

**Parameters:**
- `client_id` - Your application's client ID
- `token` - The access token or refresh token to revoke

**Example:**

```bash
curl -X POST https://example.shoplineapp.com/oauth/revoke_access \
  -d "client_id=YOUR_CLIENT_ID" \
  -d "token=TOKEN_TO_REVOKE"
```

---

## Additional Resources

For more information, see:
- **API Reference** - [Link to API documentation]
- **Authentication Flow** - [Link to auth flow guide]
- **Best Practices** - [Link to best practices]

---

## Important Notes

âš ï¸ **Security Warning:** Never expose your client_secret in client-side code or public repositories.

ğŸ’¡ **Tip:** Store tokens securely and use environment variables for sensitive credentials.

ğŸ“Œ **Note:** Refresh tokens should be stored securely as they can be used to obtain new access tokens.

---

# Canceling authorization

You can cancel an authorization by changing the authorization URL via Seller Center.

## Canceling authorization by changing the authorization URL

Follow the same steps to generate an authorization URL, but replace the fixed authorization URL with these fixed deauthorization URLs:

### Production Environment
- **https://partner.test.shopeemobile.com/api/v2/shop/cancel_auth_partner?**
  - `partner_id=1000948&redirect=https://open.shopee.com/demo/temp=1504597040&sign=90c1a39302f0b690c7223e1bc54569ec3a1c050658441f1faa4b66488210c8c9`

### Sandbox Environment
- **https://partner.test.shopeemobile.com/api/v2/shop/cancel_auth_partner?**
  - `partner_id=1000916&redirect=https://open.shopee.com/demo/temp=1672341604&sign=47d4f71268698ec7c7f61e6e0091b080665190162164753818b4b30a8cc287c`

Log in to your account.

---

## Select Account

**Select Account**

- **SID:** 53682804.balunafa98a.hsaef117
- OpenpartnerPartner145.main

Log in with other accounts

Language: English â–¼

---

## Select Cancel Authorization

**Cancel Authorization**

Once canceled, you will no longer be authorized to access your info.

- **Account ID:** sandbox.balunafa98a.1c8aef117
- **Shop ID:** 30

[Cancel Authorization Button]

---

## Canceling authorization on Seller Center

On the Platform Partner page in Seller Center, sellers can check which Apps the shop has authorized and their corresponding authorization expiration dates. The seller can also directly cancel the authorization of Apps by selecting "Shopee Open Platform" in the main column.

[Screenshots showing Platform Partner interface with authorization details and "End authorization" option]

---

CNSC and KRSC sellers can check which Apps the main account has granted authorization to. On the Platform Partner page, Sellers can directly cancel any authorizations granted by the merchant or shop.

[Screenshots showing authorization management interface]

---

## FAQs on authorization and authentication

For common questions, please refer to our [FAQs on authorization and authentication](#).

---

**ë¬¸ì„œ ID**: developer-guide.20
**í”Œë«í¼**: shopee
**URL**: https://open.shopee.com/developer-guide/20
**ì²˜ë¦¬ ì™„ë£Œ**: 2025-10-16T08:14:33
