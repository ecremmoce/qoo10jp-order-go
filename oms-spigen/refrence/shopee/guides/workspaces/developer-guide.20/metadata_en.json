{
  "document_id": "developer-guide.20",
  "document_type": "guide",
  "platform": "shopee",
  "extracted_at": "2025-10-16T08:12:43",
  "extracted_text": "# The authorization process\n\nThere are three steps to creating an authorization: Generating the authorization link, (enabling authorizations from klaytn), using the authorization link and lastly either passing the link to the end-user for authorization by e-card, klaen.\n\nThere will be explained in detail below, along with information on what to prepare before authorization, details of the authorization process, and how to use the information retrieved after authorization to pass the authorization of the partner's service.\n\n## Generating the authorization link\n\nBefore proceeding with klaen authorization, send a request to Open Platform App-tier-link Authorizer. Its to blacklist* URL to generate an authorization link.\n\n### Authorization Request Console\n\n| Field | Description |\n|-------|-------------|\n| App List | App List |\n| Provider | Provider |\n| API Not Set | API Not Set |\n| API Not Set | API Not Set |\n| API Not Set | API Not Set |\n| Trade List | Trade List |\n\n**Note:**\n- App List for 0\n- List of 4 Apps to integrate\n- API Not Set (3) - No need to list / blank\n- Trade List - Need to Allow / Denied\n\nFor all type of App, you need to create an authorization link with the following specifications. The authorization link comprises of three basic parameters, app_key, and other required parameters.\n\n#### Generating the authorization link https://approvalappname.clouckorea/ch/klayappli_partner\n\n**Required basic parameter:**\n\n- app_key: string (Description: App key; If not have have; The parameters are below have app key.)\n\n**Baselink https (parameter):**\n\n- partner_ci: string (Description: App-table master according2/Klayappli_partner)\n- partner_info: string (Description: Partner information will be 20 characters and use to generate app_identifier_key)\n\n#### Other required parameters:\n\n| Parameter Name | Type | Description |\n|----------------|------|-------------|\n| login | string | The signature obtained by sign base string (signin_partner_id, api path, timestamp). It must be generated with the api key. |\n| partner_ci | int | partner_ci obtained from the App. |\n| timestamp | int | Time value entered when the timestamp used in the sign base string. The timestamp value is only valid for 3 minutes. |\n| redirect | string | The URL to which the message redirect is after authorization is completed. This can be an endpoint to your system, or an endpoint to Open Platform which call your service. |\n\n#### Calculating the app parameter\n\nThe app parameter is not a part of or correspondent of the authorization link, but also a parameter used for authentication each time an App calls Open Platform API. To calculate the app parameter, you need a hash value which activated the authentication signature: HMAC-SHA256.\n\nFor app parameter base string:\nYou need to create the base string in the way of different parameters to enable the sign base string, (compatible with to common parameters):\n\n- For Shop API's, partner_ci, api path, timestamp, access_token, shop_id.\n- For Partner API's, partner_ci, api path, timestamp, access_token, token_type_shop&shop_ci.\n- For Public API's, partner_ci, api path, timestamp.\n\nUse HMAC-SHA256 to hash the sign base string, and use the partner key as the encryption key. The hashed-value value (App value) is the authentication signature.\n\n### PHP Code Demo:\n\n```php\n<?php\n// Input 1 Text:\n$input1 = input1\n$input2 = input2\n$signPlainText = \"\";\n\nif ($_SERVER[\"REQUEST_METHOD\"] === \"POST\") {\n    $input1 = isset($_POST['input1']) !== \"\";\n    $text = \"https://approvalappname.klayout.com/s/ch\";\n    $signinKey = $POST;\n    $signPlainText = \"\";\n    \n    // Calculate SignBase:\n    foreach($input_text = \"header\" . $var[len, id, path, $time] \n          $signPlainText = $prefix.join(\"&\".$var.kind));\n    \n    $signedText = hash_hmac('SHA256', $headerText);\n    $signedText = $signPlainText(\"text:\". $signedText. \"&cipher=text:\". $partner, $POST);\n    \n    $finalText = $_GET['?'] ?? \"auth/\" . $signedText;\n    echo \"<ul>\";\n    foreach ($text as $item) {\n        echo \"<li>$item</li>\";\n    }\n    echo \"</ul>\";\n}\n?>\n```\n\n### Python Code Demo:\n\n```python\nimport hashlib\nimport hmac\n\n# Function to calculate signature\n$api_path = 0\n\ndef calculate_signature(partner_id, api_path, timestamp):\n    \"\"\"Calculate HMAC signature\"\"\"\n    sign_base = f\"{partner_id}&{api_path}&{timestamp}\"\n    \n    # Using HMAC-SHA256\n    signature = hmac.new(\n        bytes(api_key, 'utf-8'),\n        bytes(sign_base, 'utf-8'),\n        hashlib.sha256\n    ).hexdigest()\n    \n    return signature\n\n# Example usage\npartner_id = \"your_partner_id\"\napi_path = \"/api/v1/resource\"\ntimestamp = int(time.time())\n\nsignature = calculate_signature(partner_id, api_path, timestamp)\nprint(f\"Signature: {signature}\")\n```\n\n### Java Code Demo:\n\n```java\nimport javax.crypto.Mac;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.security.InvalidKeyException;\nimport java.security.NoSuchAlgorithmException;\n\npublic class AuthorizationExample {\n    \n    public static String calculateSignature(String partnerId, String apiPath, long timestamp, String apiKey) \n            throws NoSuchAlgorithmException, InvalidKeyException {\n        \n        // Create sign base string\n        String signBase = partnerId + \"&\" + apiPath + \"&\" + timestamp;\n        \n        // Use HMAC-SHA256\n        Mac sha256Hmac = Mac.getInstance(\"HmacSHA256\");\n        SecretKeySpec secretKey = new SecretKeySpec(apiKey.getBytes(), \"HmacSHA256\");\n        sha256Hmac.init(secretKey);\n        \n        byte[] hash = sha256Hmac.doFinal(signBase.getBytes());\n        \n        // Convert to hex string\n        StringBuilder hexString = new StringBuilder();\n        for (byte b : hash) {\n            String hex = Integer.toHexString(0xff & b);\n            if (hex.length() == 1) hexString.append('0');\n            hexString.append(hex);\n        }\n        \n        return hexString.toString();\n    }\n    \n    public static void main(String[] args) {\n        try {\n            String partnerId = \"your_partner_id\";\n            String apiPath = \"/api/v1/resource\";\n            long timestamp = System.currentTimeMillis() / 1000;\n            String apiKey = \"your_api_key\";\n            \n            String signature = calculateSignature(partnerId, apiPath, timestamp, apiKey);\n            System.out.println(\"Signature: \" + signature);\n            \n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n### Node.js Code Demo:\n\n```javascript\nconst crypto = require('crypto');\n\nfunction calculateSignature(partnerId, apiPath, timestamp, apiKey) {\n    // Create sign base string\n    const signBase = `${partnerId}&${apiPath}&${timestamp}`;\n    \n    // Calculate HMAC-SHA256\n    const hmac = crypto.createHmac('sha256', apiKey);\n    hmac.update(signBase);\n    const signature = hmac.digest('hex');\n    \n    return signature;\n}\n\n// Example usage\nconst partnerId = 'your_partner_id';\nconst apiPath = '/api/v1/resource';\nconst timestamp = Math.floor(Date.now() / 1000);\nconst apiKey = 'your_api_key';\n\nconst signature = calculateSignature(partnerId, apiPath, timestamp, apiKey);\nconsole.log('Signature:', signature);\n\n// Generate authorization URL\nconst authUrl = `https://approvalappname.cloudkorea.kr/ch/klayappli_partner?partner_ci=${partnerId}&timestamp=${timestamp}&login=${signature}&redirect=${encodeURIComponent('your_redirect_url')}`;\nconsole.log('Authorization URL:', authUrl);\n```\n\n---\n\n# Shopee Open Platform - Authorization Guide\n\n## API Endpoint Information\n\n```\nServer: partner-test.shopeemobile.com (for sandbox environment)\n```\n\n### Example Authorization Link\n\n**Path:** `/api/v2/shop/auth_partner`\n\n**Endpoint:** `https://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner`\n\n**Request Parameters:**\n- `partner_id` (int)\n- `redirect` (string): `https://www.YOUR_DOMAIN.com/callback`\n- `sign` (string): Calculated using HMAC-SHA256 with partner_key and base string consisting of `partner_id`, `path`, `timestamp`\n\n**Base String Format:**\n```\nhttps://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner\n```\n\n**Partner ID:** `847363`\n\n**Signature:** `5f7dcd4cbe1a45f1bcb2e6dcfd8f3f6e08c2b9ed9bb6d62aaf3a5c69f7a8c49f7`\n\n### Example Authorization Links\n\n**Links for production and sandbox test environments:**\n\n#### Production Environment:\n```\nhttps://partner.shopeemobile.com/api/v2/shop/auth_partner?partner_id=YOUR_PARTNER_ID&redirect=YOUR_REDIRECT_URL&sign=GENERATED_SIGNATURE\n```\n\n**Example:**\n```\nhttps://partner.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4\n```\n\n#### Sandbox Environment:\n```\nhttps://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=YOUR_PARTNER_ID&redirect=YOUR_REDIRECT_URL&sign=GENERATED_SIGNATURE\n```\n\n**Example:**\n```\nhttps://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4\n```\n\n### Sandbox Test Environment:\n```\nhttps://partner.test-stable.shopeemobile.com/api/v2/shop/auth_partner?partner_id=1000&redirect=https%3A%2F%2Fwww.yourwebsite.com%2Fcallback&timestamp=1594808000&sign=9c140756e3f1e2f0c5e87434b8c8b3c4be7c9f3d9e8f5b6a4d3c2e1f0a9b8c7d6e5f4\n```\n\n---\n\n## Authorization Process\n\n### ðŸ“Œ Note\nPlease ensure the seller has login and authorization validity for 5 minutes. After the timestamp and the sign expire, the seller cannot continue the authorization. The authorization link will no longer be valid, and you need to redirect the seller to a new link.\n\n---\n\n## Acquiring Authorizations from Shop(s)\n\nAfter you create the authorization link with the seller, the seller needs to log in to their account. But for verification code use, the seller needs to check their email and enter the authorization code.\n\nThe seller can use a main account to authorize a single shop or a main account to authorize multiple retailers/shops. Accounts cannot be used to log in to the Shopee Seller Center or the authorization page.\n\n### ðŸ“Œ Note\nNote: In-house System App Users can only be authorized to access data from their main shop. You must also log in to the developer account tab.\n\n---\n\n## Authorization from a Main Account\n\n**Step 1:** The seller fills in their login details and selects Log In\n\n---\n\n## Login to Authorize Shopee Open Platform APP\n\n**Interface showing:**\n- Email/Phone input field\n- Password input field  \n- \"Forgot Password?\" link\n- \"Log In\" button (in orange)\n- \"Return to Main Account\" option\n- Language selector: English\n\n---\n\n**Step 2:** The seller fills in their verification code sent to their mobile phone and selects Verify\n\n---\n\n## Verification\n\n**Interface showing:**\n- Verification code input field\n- \"Verify\" button (in orange)\n- \"English\" language selector\n\n---\n\n**Step 3:** Upon logging in, the seller selects Confirm Authorization\n\n---\n\n## Authorization Screen\n\n**Shopee Open Platform**\n\n### Authorization\n[Shop name and details would be displayed here]\n\n**Interface elements:**\n- Confirm Authorization button\n- Information about permissions granted\n- Details about data access\n\n**Permissions listed:**\n- Order Information: Information related to all records for orders\n- Product Information: Information related to all records for products and their categories\n- Shop Information: Information related to shop settings and details  \n- Other Information: Information related to discount and other details\n- Logistics: Information related to all records for logistics and shipping\n- Finance: Information related to settlement and account balance\n- Returns: Information related to returns and disputes for all records\n- Media Space: Information related to upload images and videos\n\n**Link to view full authorization:**\n```\nclick to confirm authorization\n```\n\n---\n\n**Step 4:** After authorization, the front-end page will redirect to the redirect URL in your authorization link:\n\n```\nhttps://www.YOUR_DOMAIN.com/callback?code=xxxxxxxx&shop_id=xxxxxx\n```\n\n---\n\n## Authorizing from a Main Account\n\n**Step 1:** To log in to a main account, the seller selects the switch to Main Account link on the login page.\n\n---\n\n## Login to Authorize Shopee Open Platform APP\n\n**Interface showing:**\n- SH â†’ ID dropdown (market/region selector)\n- Email/ID/USERNAME/Mobile/[?]2017 input field\n- Password input field\n- \"Forgot Password?\" link\n- \"Log In\" button (in orange)\n- \"OR\" divider\n- \"Switch to Sub Account\" option\n- Language selector: English\n\n---\n\n**Step 2:** The seller can then fill in their login details and select Log In\n\n---\n\n## Login to Authorize Shopee Open Platform APP\n\n**Interface showing standard login form**\n- Email/Username/Mobile input\n- Password field\n- Login button\n- Switch account options\n\n---\n\n**Additional Notes and Documentation Links:**\n\nThe complete authorization flow ensures secure access to shop data while maintaining seller control over permissions granted to the application.\n\n---\n\n# Login to Authorize Shope Xpaygateway API\n\n## Steps\n\n### 1. This seller selects the shops that need to be authorized\n**Note:** If there are multiple affiliate sellers, if you need to call the merchant's API, please reselect the seller to select the Auth Merchant checkbox\n\n---\n\n### 2. [276] OperationEvent API Group\n\n**Endpoint:**\n- `GET /api/v1/orders/89879900046` - Authorized\n  - View Stages: Order List\n  - Based of 2019\n\n**Auth Merchant** button available\n\n---\n\n### 3. [276] OperationEvent API (1234512345)\n\n**Available API Operations:**\n- `GET /api/v1/orders/89879900046` - Authorized\n- `GET /api/v1/orders/564001872` - Authorized  \n- `GET /api/v1/orders/ORDER-12` - Authorized\n- `GET /api/v1/orders/564001872/cancel` - Authorized\n\n**Auth Merchant** button available\n\n---\n\n### 4. [276] OperationEvent API (1234512345) - #session - #common\n\n**Available Operations:**\n- `GET /tokens/v1/10004343266` - Authorized\n- `PUT /api/v1/17700000000321` - Authorized\n\n**Auth Merchant** button available\n\n---\n\n### 5. [276] OperationEvent API (1234512345) - #session - #common\n\n**View Stages:** Order List\n**Based of 2019**\n\n**Auth Merchant** button available\n\n---\n\n## LOCAL (real) account authorization\n\n### Authorization\nAvailable API: E-Shope API: Same - Online - Portlet (option)\n\n**SN2**\n**Administrator Details**\n\n**Information box:**\nThis authorization code is only used for the first time authorization to the test documents. Please select the page authorized to log out. The corresponding code for the real page should be used for the first time authorization. If the authorization code has been used in an unrelated test environment only.\n\n**[?] Ask: LOCAL (real)**\n\n---\n\n## MTR Scope (Please select the shop to complete the authorization)\n\n**Based all:**\n\n- **1_a:** sell_[?] location\n- **2_a:** show_[?] location  \n- **3_a:** sell_[?] location\n- **4_a:** sold_[?] location\n- **5_b:** store location\n- **6_b:** (Multiple) show location\n- **7a_b:** sell_a = sell + sold + combination\n\n---\n\n## 3. This seller selects Confirm Authorization to confirm their selection.\n\n---\n\n### [276] OperationEvent API (1234512345) - #session - #common\n\n**Auth Merchant** button\n\n**View Stages:** Order List\n**Based of 2019**\n\n---\n\n### API Operations list:\n- `GET /tokens/v1/10004343266` - Authorized\n- `PUT /api/v1/orders/89879900046` - Authorized\n- `GET /api/v1/orders/564001872` - Authorized\n\n**Confirm Authorization** button (red/orange)\n\n---\n\n## 4. After authorization, the front-end page will redirect to the redirect URL in your authorization task.\n\n### The redirect URL\nContains the parameters code, shop_id, and state, etc.\n\n---\n\n## Using the authorization code\n\nAfter you get the authorization code, you may call the API to exchange the authorization code to the callback address redirect URL. You can then use the code to get access_token for the first time.\n\nIf authorization was done on a main account, a code and a main_account_id will be returned in the redirect URL. Otherwise, the code will be in the form of shop_id.\n\n### Parameter table:\n\n| Parameter name | Type | Description |\n|----------------|------|-------------|\n| code | string | This is the authorization code from the authorization callback. This value is used to retrieve access_token and refresh_token. It is valid for only once and expires after 10 minutes. |\n| shop_id | int | The ID of the shop that just granted authorization to your App. Returned after other authorization was done on a shop. |\n| main_account_id | int | The ID of the main account that just granted authorization to your shop. Returned after authorization was done on a main account. |\n\n---\n\n## Getting and refreshing the access_token\n\nAccess_token is a credential to call the API. Each user has their own access_token. For the same API, Each access_token is valid for 4 hours and can be used multiple times within 4 hours. However, you need to use the refresh_token to refresh the access_token if expires or use a new authorization code to retrieve a new access_token.\n\nRefresh_token is a parameter used to refresh access_token. Each refresh_token is valid for 30 days.\n\nThe access_token and refresh_token of each shop_id and merchant_id need to be saved separately.\n\n### Call/AccessToken\n\nAfter successful authorization, use the code and shop_id or main_account_id as the redirect URL to call the API. This helps you obtain the access_token, refresh_token, merchant_id, access_token, token\n\n#### Path:\n- **Production environment:** https://partner.shopeemobile.com/api/v2/auth/token/get\n- **Test environment:** https://partner.test-stable.shopeemobile.com/api/v2/auth/token/get\n- **Sandbox environment:** https://openplatform.sandbox.test-stable.shopeemobile.com/api/v2/auth/token/get\n\n**Request method:** POST\n\n---\n\n### Request parameters:\n\n| Parameter name | Type | Required | Description |\n|----------------|------|----------|-------------|\n| sign | string | True | The signature calculated by sign-based string (partner_id, api, path, timestamp, access_token or refresh_token) having order as partner_key and timestamp |\n| partner_id | int | True | The partner_id obtained from the App. This partner_id is and the first query need to be passed |\n| timestamp | int | True | Timestamping, valid for 5 minutes |\n\n---\n\n### Response parameters:\n\n| Parameter name | Type | Required | Description |\n|----------------|------|----------|-------------|\n| code | string | True | The code in the redirect URL after authorization. It is only valid once. |\n| partner_id | int | True | The partner_id obtained from the App. This partner_id is and the main query need to be passed |\n| shop_id | int | True if [?] | For the shop_id authorized to you, when the shop_id or merchant_id in the response are the shop_id or main_account_id |\n| main_account_id | int | True if [?] | For the main_account_id authorized to you, when the shop_id or main_account_id can be retrieved as the input parameter |\n\n---\n\n### Response parameters:\n\n| Parameter name | Type | Description |\n|----------------|------|-------------|\n| request_id | string | Or AUTH requests; always returned. Used to diagnose problems. |\n\n---\n\n# API Documentation\n\n## Input Parameters\n\n**Note:** `main_account_id` can be omitted as the input parameter.\n\n**Note:** For the `main_account_id` input, within the scope of `main_account_id` it can be selected as the input parameter.\n\n### Request Parameters\n\n| Parameter name | Type | Description |\n|----------------|------|-------------|\n| request_id | string | ID of API requests, always returned. Used to diagnose problems |\n| error | string | Error codes for API requests, always returned. A non-empty string indicates an error has occurred & empty string indicates success |\n| refunds_failed | string | Returned when the API call is successful. Represents the total refunds that have failed for each shop_id or each merchant_id respectively, for 30 days |\n| access_token | string | Returned when the API call is successful. A dynamic token that can be used multiple times and expires after 4 hours |\n| expire_in | int | Returned when the API call is successful. Represents the time until token expires, in seconds. |\n| message | string | Always returned. Provides detailed error information. |\n| new_user_time_to_list | INT | Returned when there is `main_account` in the input parameters, including all the merchant_ids authorized this time under the main account |\n| shop_id_list | INT | Returned when there is `main_account` in the input parameters all shop_ids authorized this time under the main account |\n\n## Python Code Demo\n\n```python\nimport time\nimport hashlib\n\n# Fill the request time\nurl = \"/api/v2/shop/get_shop_info\"\npath = \"/api/v2/shop/get_shop_info\"\nbody = \"\"\npartner_id = xxxxxx\npartner_key = \"xxxxxxxxxxxxxx\"\nshop_id = xxxxxx\nmerchant_id = xxxxxx\n\ntmp_base_string = \"%s%s%s%s%s%s\" % (\n    partner_id, path, str(int(time.time())), access_token, shop_id, merchant_id\n)\n\nbase_string = tmp_base_string.encode()\npartner_key_bytes = partner_key.encode()\n\nsign = hmac.new(\n    partner_key_bytes, base_string, hashlib.sha256\n).hexdigest()\n\nheaders = {\n    \"Content-Type\": \"application/json\",\n    \"Partner-Id\": str(partner_id),\n    \"Timestamp\": str(int(time.time())),\n    \"Access-Token\": access_token,\n    \"Shop-Id\": str(shop_id),\n    \"Merchant-Id\": str(merchant_id),\n    \"Authorization\": sign,\n}\n\nresp = requests.post(\n    url=url, headers=headers, json=json.loads(body)\n)\nprint(resp.content)\n```\n\n## Java Code Demo\n\n```java\nimport org.apache.commons.codec.binary.Hex;\n\nimport javax.crypto.Mac;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.io.*;\nimport java.net.HttpURLConnection;\nimport java.net.URL;\n\npublic class AuthSignTest {\n    \n    public static void main(String[] args) throws Exception {\n        int partner_id = xxxxxx;\n        String partner_key = \"xxxxxxxxxxxxxx\";\n        \n        String path = \"/api/v2/shop/auth_partner\";\n        String redirect_url = \"https://www.xxxx.com/auth/callback\";\n        \n        long timestamp = System.currentTimeMillis() / 1000L;\n        \n        String tmp_base_string = \n            String.format(\"%s%s%s\", partner_id, path, timestamp);\n        String base_string = tmp_base_string + partner_key;\n        \n        String sign = genHmacSHA256(base_string, partner_key);\n        System.out.println(\"sign = \" + sign);\n        \n        String url = \n            String.format(\n                \"https://partner.test.shopeedev.com%s?partner_id=%s&timestamp=%s&sign=%s&redirect=%s\",\n                path,\n                partner_id,\n                timestamp,\n                sign,\n                redirect_url\n            );\n        \n        System.out.println(url);\n    }\n    \n    public static String genHmacSHA256(String message, String secret) {\n        try {\n            Mac sha256_HMAC = Mac.getInstance(\"HmacSHA256\");\n            SecretKeySpec secret_key = new SecretKeySpec(secret.getBytes(), \"HmacSHA256\");\n            sha256_HMAC.init(secret_key);\n            \n            byte[] bytes = sha256_HMAC.doFinal(message.getBytes());\n            return Hex.encodeHexString(bytes);\n            \n        } catch (Exception e) {\n            System.out.println(\"Error HmacSHA256\");\n        }\n        return \"\";\n    }\n    \n    public static String getWithHeaders(String host, String path, Map<String, String> headers) \n        throws IOException {\n        \n        HttpURLConnection connection = null;\n        \n        try {\n            URL url = new URL(host + path);\n            connection = (HttpURLConnection) url.openConnection();\n            connection.setRequestMethod(\"GET\");\n            \n            for (Map.Entry<String, String> entry : headers.entrySet()) {\n                connection.setRequestProperty(entry.getKey(), entry.getValue());\n            }\n            \n            int responseCode = connection.getResponseCode();\n            \n            if (responseCode == HttpURLConnection.HTTP_OK) {\n                return getResponse(connection.getInputStream());\n            } else {\n                return getResponse(connection.getErrorStream());\n            }\n            \n        } finally {\n            if (connection != null) {\n                connection.disconnect();\n            }\n        }\n    }\n    \n    private static String getResponse(InputStream inputStream) throws IOException {\n        BufferedReader in = new BufferedReader(new InputStreamReader(inputStream));\n        String inputLine;\n        StringBuilder response = new StringBuilder();\n        \n        while ((inputLine = in.readLine()) != null) {\n            response.append(inputLine);\n        }\n        in.close();\n        \n        return response.toString();\n    }\n    \n    public static String postWithHeaders(\n        String host,\n        String path,\n        Map<String, String> headers,\n        String body\n    ) throws IOException {\n        \n        HttpURLConnection conn = null;\n        \n        try {\n            URL url = new URL(host + path);\n            conn = (HttpURLConnection) url.openConnection();\n            conn.setRequestMethod(\"POST\");\n            conn.setDoOutput(true);\n            \n            for (Map.Entry<String, String> e : headers.entrySet()) {\n                conn.setRequestProperty(e.getKey(), e.getValue());\n            }\n            \n            OutputStream os = conn.getOutputStream();\n            os.write(body.getBytes(\"UTF-8\"));\n            os.flush();\n            \n            int responseCode = conn.getResponseCode();\n            \n            if (responseCode == HttpURLConnection.HTTP_OK) {\n                return getResp(conn.getInputStream());\n            } else {\n                return getResp(conn.getErrorStream());\n            }\n            \n        } finally {\n            if (conn != null) {\n                conn.disconnect();\n            }\n        }\n    }\n    \n    private static String getResp(InputStream is) throws IOException {\n        BufferedReader in = new BufferedReader(new InputStreamReader(is));\n        String inputLine;\n        StringBuilder response = new StringBuilder();\n        \n        while ((inputLine = in.readLine()) != null) {\n            response.append(inputLine);\n        }\n        in.close();\n        \n        return response.toString();\n    }\n}\n```\n\n---\n\n# API Integration Guide\n\n## Authentication\n\n```php\n$client = new GuzzleHttp\\Client();\n$response = $client->request('POST', 'https://api.example.com/auth', [\n    'form_params' => [\n        'username' => 'your_username',\n        'password' => 'your_password'\n    ]\n]);\n$token = json_decode($response->getBody())->token;\n```\n\n## Making API Calls\n\n### GET Request\n\n```php\n$response = $client->request('GET', 'https://api.example.com/data', [\n    'headers' => [\n        'Authorization' => 'Bearer ' . $token,\n        'Accept' => 'application/json'\n    ]\n]);\n$data = json_decode($response->getBody());\n```\n\n### POST Request\n\n```php\n$response = $client->request('POST', 'https://api.example.com/create', [\n    'headers' => [\n        'Authorization' => 'Bearer ' . $token,\n        'Content-Type' => 'application/json'\n    ],\n    'json' => [\n        'name' => 'Item Name',\n        'description' => 'Item Description',\n        'price' => 99.99\n    ]\n]);\n```\n\n## Error Handling\n\n```php\ntry {\n    $response = $client->request('GET', 'https://api.example.com/data');\n} catch (\\GuzzleHttp\\Exception\\ClientException $e) {\n    echo \"Client Error: \" . $e->getMessage();\n} catch (\\GuzzleHttp\\Exception\\ServerException $e) {\n    echo \"Server Error: \" . $e->getMessage();\n}\n```\n\n## Response Parsing\n\n```php\n$body = $response->getBody();\n$data = json_decode($body, true);\n\nforeach ($data['items'] as $item) {\n    echo $item['name'] . \"\\n\";\n    echo $item['description'] . \"\\n\";\n}\n```\n\n## PHP Code Demo\n\n### Basic GET Request\n\n```php\nfunction getTasksByUser($userId, $userToken, $baseUrl) {\n    $path = \"/api/v1/users/tasks\";\n    \n    $query = http_build_query([\n        'user_id' => $userId,\n        'status' => 'active'\n    ]);\n    \n    $url = $baseUrl . $path . '?' . $query;\n    \n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $url);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_HTTPHEADER, [\n        'Authorization: Bearer ' . $userToken,\n        'Accept: application/json'\n    ]);\n    \n    $response = curl_exec($ch);\n    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\n    curl_close($ch);\n    \n    return json_decode($response, true);\n}\n```\n\n### Advanced POST Request\n\n```php\nfunction createTaskForUser($userId, $userToken, $baseUrl, $taskData) {\n    $path = \"/api/v1/users/tasks\";\n    \n    $url = $baseUrl . $path;\n    \n    $payload = array_merge([\n        'user_id' => $userId,\n        'created_at' => date('Y-m-d H:i:s')\n    ], $taskData);\n    \n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $url);\n    curl_setopt($ch, CURLOPT_POST, true);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_HTTPHEADER, [\n        'Authorization: Bearer ' . $userToken,\n        'Content-Type: application/json',\n        'Accept: application/json'\n    ]);\n    \n    $response = curl_exec($ch);\n    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);\n    curl_close($ch);\n    \n    return [\n        'status' => $httpCode,\n        'data' => json_decode($response, true)\n    ];\n}\n```\n\n## Rate Limiting\n\n**Important:** The API has rate limits of 100 requests per minute per token.\n\n### Example Rate Limit Headers\n\n```\nX-RateLimit-Limit: 100\nX-RateLimit-Remaining: 95\nX-RateLimit-Reset: 1609459200\n```\n\n## Webhooks\n\nConfigure webhooks to receive real-time notifications:\n\n```php\n// Webhook endpoint example\n$payload = file_get_contents('php://input');\n$signature = $_SERVER['HTTP_X_SIGNATURE'];\n\n$calculated = hash_hmac('sha256', $payload, $webhookSecret);\n\nif (hash_equals($signature, $calculated)) {\n    $data = json_decode($payload, true);\n    // Process webhook data\n}\n```\n\n## Best Practices\n\n1. **Always validate responses** before processing\n2. **Cache authentication tokens** to reduce API calls\n3. **Implement exponential backoff** for retries\n4. **Log all API interactions** for debugging\n5. **Use environment variables** for sensitive data\n\n## Additional Resources\n\n- API Documentation: https://documentation.example.com/api/v1/reference\n- SDK Repository: https://github.com/example/php-sdk\n- Support Forum: https://community.example.com/developers\n\n## Required Headers\n\n- `Authorization: Bearer {token}`\n- `Content-Type: application/json`\n- `Accept: application/json`\n- `User-Agent: YourApp/1.0`\n\n---\n\n*Last updated: 2024-01-15*\n\n---\n\n# API Documentation\n\n## Access Token Management\n\n**Collapse (selected)**\n- https://docs.example.com/api/access-token-management\n- https://example.com/api/endpoint\n\n**Sandbox environment**\n- https://sandbox.example.com/api/access-token-management/get-partner-access-token-api\n- https://sandbox.example.com/api/access-token-management/refresh-partner-access-token-api\n\n**Required method:** POST\n\n---\n\n## Note\n\n- Each time, access_token_id will get the same initial access_token and refresh_token when calling GetAccessToken API for the first time.\n- However, after calling the RefreshAccessToken API for the first time, a new set of independent access_token and refresh_token will be generated for each time, id and merchant_id.\n\nHere is an example:\n1. First, the access_token and refresh_token obtained from calling GetAccessToken API for the first time is named access_token_0, refresh_token_0.\n2. After the first access_token expires, you use the first refresh_token to call RefreshAccessToken.\n3. You obtain 1st set of independent access_token and merchant_id can be used to call API_SetupPayment_id and access_token_1, refresh_token_1.\n4. When you call RefreshAccessToken again, the 2nd set of independent access_token and refresh_token will be generated.\n\n---\n\n## Public parameters\n\n| Parameter Name | Type | Required | Description |\n|---------------|------|----------|-------------|\n| sign | string | True | The signature obtained by sign logic (string format_id, ext-path, timestamp + HMAC-SHA256 hashing) via the partner_key |\n| partner_id | int | True | The partner_id obtained from the APP. This partner_id is ext-into-the-corp |\n| timestamp | int | True | Timestamp, valid for 5 minutes |\n\n---\n\n## Request parameters\n\n| Parameter Name | Type | Required | Description |\n|---------------|------|----------|-------------|\n| access_token | string | True | Use lifetime_token to get a new access_token. Each refresh_token is valid for 30 days, and can only be used once by either a long_id or an merchant_id |\n| partner_id | int | True | The partner_id obtained from the App. The partner_id is reversed into the merchant account |\n| shop_id | int | False | The shop_id of the main account that granted authorization to your App. Only the shop_id on merchant_id can be executed on the shop access_token to be requested with this API |\n| merchant_id | int | - | The merchant_id for identifying the main account that granted authorization to your App. Only the shop_id or merchant_id can be used in the input parameter, and they must be initialized |\n\n---\n\n## Response parameters\n\n| Parameter Name | Type | Description |\n|---------------|------|-------------|\n| request_id | string | ID of API requests, always returned (used for debugging purposes) |\n| error | string | Error info if error occurs, always returned When the API call is successful, the error code returned is empty |\n| refresh_token | string | Returned when the API call is successful Used to call RefreshAccessToken |\n| access_token | string | Returned when the API call is successful Use the new access_token to be a developer_token_id can be used twice by either a long_id or an merchant_id |\n| access_token_expire_in | int | Returned when the API call is successful Each new access_token is a dynamic token that can be used multiple times, it expires after this time (in seconds) |\n| expire_in | int | Returned when the API call is successful The refresh_token lifetime (in seconds) for accounts to execute |\n| message | string | Always returned. Provides detailed error information |\n| merchant_id | int | Returned when the API call is successful For merchant_id on identifying which main merchant account |\n| shop_id | int | Returned when the API call is successful For shop_id on identifying which shop |\n| partner_id | int | Returned when the API call is successful The partner_id you used for this request |\n\n---\n\n## Note\n\n- After a new access_token is generated, the old access_token is still valid for 5 minutes.\n- On authentication call trigger a return of refresh_token and access_token.\n- You must call the RefreshAccessToken API to get a new set of access_token before expiration.\n- **This request will not extend the lifetime of refresh_token. You must call get authorization again before refresh_token expires (If the new refresh_token expires, shop will have to reauthorize the app).**\n\n---\n\n## Python Code Demo\n\n```python\n#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n\nimport json\nimport requests\nimport time\nimport hmac\nimport hashlib\n\nAPI_URL = \"https://partner.example.com/api/v1/access_token/get\"\nPARTNER_ID = 100000\nPARTNER_KEY = \"your_partner_key_here\"\n\ndef get_access_token_first_time(api_url, partner_id, partner_key, refresh_token=\"\"):\n    path = \"/api/v1/access_token/get\"\n    timestamp = int(time.time())\n    \n    # Payload\n    body = {\n        \"partner_id\": partner_id,\n        \"timestamp\": timestamp\n    }\n    \n    if refresh_token:\n        body[\"refresh_token\"] = refresh_token\n    \n    # Generate signature\n    base_string = f\"{partner_id}{path}{timestamp}\"\n    sign = hmac.new(\n        partner_key.encode('utf-8'),\n        base_string.encode('utf-8'),\n        hashlib.sha256\n    ).hexdigest()\n    \n    # Headers\n    headers = {\n        \"Content-Type\": \"application/json\",\n        \"partner-id\": str(partner_id)\n    }\n    \n    # Add sign to body\n    body[\"sign\"] = sign\n    \n    response = requests.post(api_url, json=body, headers=headers)\n    \n    return response.json()\n\n# First time call\nresult = get_access_token_first_time(API_URL, PARTNER_ID, PARTNER_KEY)\nprint(json.dumps(result, indent=2))\n\n# Refresh token call\nif \"refresh_token\" in result:\n    new_result = get_access_token_first_time(\n        API_URL, \n        PARTNER_ID, \n        PARTNER_KEY, \n        refresh_token=result[\"refresh_token\"]\n    )\n    print(json.dumps(new_result, indent=2))\n```\n\n---\n\n## Curl Code Demo\n\n```bash\ncurl --location --request POST 'https://partner.example.com/api/v1/access_token/get' \\\n--header 'Content-Type: application/json' \\\n--header 'partner-id: 100000' \\\n--data-raw '{\n    \"partner_id\": 100000,\n    \"sign\": \"generated_sign_here\",\n    \"timestamp\": 1629876543,\n    \"refresh_token\": \"optional_refresh_token_here\"\n}'\n```\n\n---\n\n## Java Code Demo\n\n```java\nimport java.io.BufferedReader;\nimport java.io.InputStreamReader;\nimport java.io.OutputStream;\nimport java.net.HttpURLConnection;\nimport java.net.URL;\nimport javax.crypto.Mac;\nimport javax.crypto.spec.SecretKeySpec;\nimport org.json.JSONObject;\n\npublic class AccessTokenExample {\n    \n    private static final String API_URL = \"https://partner.example.com/api/v1/access_token/get\";\n    private static final int PARTNER_ID = 100000;\n    private static final String PARTNER_KEY = \"your_partner_key_here\";\n    \n    public static String generateSign(int partnerId, String path, long timestamp, String partnerKey) throws Exception {\n        String baseString = partnerId + path + timestamp;\n        Mac sha256Hmac = Mac.getInstance(\"HmacSHA256\");\n        SecretKeySpec secretKey = new SecretKeySpec(partnerKey.getBytes(\"UTF-8\"), \"HmacSHA256\");\n        sha256Hmac.init(secretKey);\n        byte[] hash = sha256Hmac.doFinal(baseString.getBytes(\"UTF-8\"));\n        \n        StringBuilder hexString = new StringBuilder();\n        for (byte b : hash) {\n            String hex = Integer.toHexString(0xff & b);\n            if (hex.length() == 1) hexString.append('0');\n            hexString.append(hex);\n        }\n        return hexString.toString();\n    }\n    \n    public static void main(String[] args) throws Exception {\n        String path = \"/api/v1/access_token/get\";\n        long timestamp = System.currentTimeMillis() / 1000;\n        String sign = generateSign(PARTNER_ID, path, timestamp, PARTNER_KEY);\n        \n        JSONObject requestBody = new JSONObject();\n        requestBody.put(\"partner_id\", PARTNER_ID);\n        requestBody.put(\"timestamp\", timestamp);\n        requestBody.put(\"sign\", sign);\n        // requestBody.put(\"refresh_token\", \"your_refresh_token\"); // Optional\n        \n        URL url = new URL(API_URL);\n        HttpURLConnection conn = (HttpURLConnection) url.openConnection();\n        conn.setRequestMethod(\"POST\");\n        conn.setRequestProperty(\"Content-Type\", \"application/json\");\n        conn.setRequestProperty(\"partner-id\", String.valueOf(PARTNER_ID));\n        conn.setDoOutput(true);\n        \n        OutputStream os = conn.getOutputStream();\n        os.write(requestBody.toString().getBytes(\"UTF-8\"));\n        os.close();\n        \n        BufferedReader br = new BufferedReader(new InputStreamReader(conn.getInputStream()));\n        String line;\n        StringBuilder response = new StringBuilder();\n        while ((line = br.readLine()) != null) {\n            response.append(line);\n        }\n        br.close();\n        \n        System.out.println(response.toString());\n    }\n}\n```\n\n---\n\n# Java Code Demo\n\n```java\n//java version for green team.\npublic static String[] getAccountName_web_level(String refresh_token, long partner_id, String \npartner_pwd, String merchantId, HttpServlet httpRequest) {\n    String[] test = new String[2];\n    test[0]json = Stirng.valueOf(list) + '}]}}';\n    test[0]json = test[0]json.replace(\"List\", \"{format_list\");\n    test[0]json = test[0]json.replace(\"\\\\xBusinessName\\\\x\", partner_ged);\n    String fee_hash_str = String.format(\"partner=%s&partner_id=%d\", partner_id, pwd(), timestamp);\n    test[1] = partner_pwd;\n    \n    //Create signature\n    EncryptGenerator sign = null;\n    \n    try {\n        Map<String, String> params = new HashMap<>();\n        base_url = \"is * for _hash_str + tag.getbuffer.UTF-8\");\n        partner_desc = *for _partner_tag.getbuffer(\"UTF-8\");\n        base_url.update(partner_desc);\n        \n        String partner_sign = bytesToHexString(base_url.digest());\n        Set<String> svc_biz = (Set<String>) httpRequest.getAttribute(\"biz_type\":\"HashCode\");\n        String biz = \"is_biz(svc.biz);\n        biz = biz.substring(1, biz.length() - 1);\n        \n        if (StringUtils.isEmpty(biz)) {\n            biz = provider[start];\n        }\n        \n        String tag_url = \"test + \"user\" + String.format(\"method=%SJSON.fastJsontoString.green+\"\nserver=merchantId=\"+merchantId+\"&partner_id=1+partner_id+\"&biz_type=\"+biz+\"&method_sign=\"+sign);\n        URL url = new URL(tag_url);\n        HttpURLConnection conn = (HttpURLConnection)url.openConnection();\n        conn.setDoOutput(true);\n        conn.setDoInput(true);\n        BufferedReader br = null;\n        \n        try {\n            br = new BufferedReader(new InputStreamReader(conn.getInputStream()));\n            conn.setRequestMethod(\"POST\");\n            conn.setRequestProperty(\"Accept-Charset\", \"utf-8\");\n            conn.setRequestProperty(\"Content-Type\", \"application/x-www-form-urlencoded\");\n            conn.getResponseCode();\n            conn.setRequestProperty(\"User-Agent\", \"application/x-www-form\");\n            OutputStreamWriter out = new OutputStreamWriter(conn.getOutputStream(), \"UTF-8\");\n            out.write(URLDecoder.decode(test[0]json,\"UTF-8\"));\n            out.flush();\n            out.close();\n            \n            String read_line = \"\";\n            String total_content = \"\";\n            while ((read_line = br.readLine()) != null) {\n                total_content += read_line;\n            }\n            \n            JSONObject jsonObject = JSONObject.parseObject(total_content);\n            result = (String) jsonObject.get(\"alipay_user_\");\n            result = (String) jsonObject.get(\"format_type\");\n        } catch (Exception ex) {\n            ex.printStackTrace();\n        } finally {\n            if (br != null) {\n                br.close();\n            }\n            \n            if (is != null) {\n                is.close();\n            }\n        }\n    } catch (Exception ex) {\n        ex.printStackTrace();\n    }\n    \n    return test;\n}\n```\n\n---\n\n```java\n//Java.Usual version the green way\npublic static String[] getAccountName_web_level(String refresh_token, long partner_id, String \npartner_pwd, String merchantId, HttpServlet httpRequest) {\n    String[] test = new String[2];\n    test[0]json = String.valueOf(list) + '}]}}';\n    test[0]json = test[0]json.replace(\"List\", \"{format_list\");\n    test[0]json = test[0]json.replace(\"\\\\xBusinessName\\\\x\", partner_ged);\n    String fee_hash_str = String.format(\"partner=%s&partner_id=%d\", partner_id, pwd(), timestamp);\n    test[1] = partner_pwd;\n    \n    //Create signature\n    EncryptGenerator sign = null;\n    \n    try {\n        MessageDigest base_url = MessageDigest.getInstance(\"MD5\");\n        base_url.update(test[0].getBytes(\"UTF-8\"));\n        partner_desc = *for _partner_tag.getbuffer(\"UTF-8\");\n        base_url.update(partner_desc);\n        \n        String partner_sign = bytesToHexString(base_url.digest());\n        Set<String> svc_biz = (Set<String>) httpRequest.getAttribute(\"biz_type\":\"HashCode\");\n        String biz = \"is_biz(svc.biz);\n        biz = biz.substring(1, biz.length() - 1);\n        \n        if (StringUtils.isEmpty(biz)) {\n            biz = provider[start];\n        }\n        \n        String tag_url = \"test + \"user\" + String.format(\"method=%SJSON.fastJsontoString.green+\"\nserver=merchantId=\"+merchantId+\"&partner_id=1+partner_id+\"&biz_type=\"+biz+\"&method_sign=\"+sign);\n        URL url = new URL(tag_url);\n        HttpURLConnection conn = (HttpURLConnection)url.openConnection();\n        conn.setDoOutput(true);\n        conn.setDoInput(true);\n        BufferedReader br = null;\n        \n        try {\n            br = new BufferedReader(new InputStreamReader(conn.getInputStream()));\n            conn.setRequestMethod(\"POST\");\n            conn.setRequestProperty(\"Accept-Charset\", \"utf-8\");\n            conn.setRequestProperty(\"contentType\");\n            conn.setRequestProperty(\"User-Agent\", \"application/json\");\n            conn.setRequestProperty(\"accept\", \"application/json\");\n            OutputStreamWriter out = new OutputStreamWriter(conn.getOutputStream(), \"UTF-8\");\n            out.write(\"refresh_token\"+refresh_token);\n            out.flush();\n            out.close();\n            \n            String read_line = \"\";\n            String total_content = \"\";\n            while ((read_line = br.readLine()) != null) {\n                total_content += read_line;\n            }\n            br.close();\n            \n            JSONObject jsonObject = JSONObject.parseObject(total_content);\n            result = (String) jsonObject.get(\"alipay_user_\");\n            result = (String) jsonObject.get(\"format_type\");\n        } catch (Exception ex) {\n            ex.printStackTrace();\n        } finally {\n            if (br != null) {\n                br.close();\n            }\n            \n            if (is != null) {\n                is.close();\n            }\n        }\n    } catch (Exception ex) {\n        ex.printStackTrace();\n    }\n    \n    return test;\n}\n```\n\n---\n\n# PHP Code Demo\n\n```php\n<?php\nfunction getAccountName($refresh_token, $partnerId, $partnerKey, $merchantId) {\n    $path = $host;\n    \n    $inged = time();\n    $inged = date(\"YmdHis\", time());\n    $sign = base64_decode(\"@\".$url.\"?\".$method.\"method_id=\".$refreshToken.\"&\";\n    $inged = $urlsmd5, $method, $partnerKey);\n    $sign = hash_hmac('sha256', $sign, $partnerKey);\n    \n    $c = curl_init();\n    curl_setopt($c, CURLOPT_URL, $host.\"?\".\"v\".\"&sign=\".urlencode($sign));\n    curl_setopt($c, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($c, CURLOPT_TIMEOUT, 10);\n    curl_setopt($c, CURLOPT_HTTPHEADER, array('Content-type:application/json'));\n    $body = json_encode($data);\n    curl_setopt($c, CURLOPT_POST, 1);\n    curl_setopt($c, CURLOPT_POSTFIELDS, $body);\n    \n    $response = curl_exec($c);\n    $baseInfo=json_decode($response,true);\n    $body = $response['result']->$baseInfo['data']->$baseData[code]->$str[id]->$str[id];\n    return $body;\n}\n?>\n```\n\n---\n\n# Developer Guide - Retrieving Tokens and Refreshing Access\n\n## Retrieving the access_token and refresh_token\n\n### From a shop account\n\n**Endpoint:**\n```\nPOST https://example.com/oauth/access_token\n```\n\n**Parameters:**\n- `client_id` - Your application's client ID\n- `client_secret` - Your application's client secret\n- `code` - The authorization code received from the authorization step\n- `grant_type` - Must be set to \"authorization_code\"\n- `redirect_uri` - Must match the redirect_uri used in the authorization request\n\n**Example Request:**\n\n```bash\ncurl -X POST https://example.com/oauth/access_token \\\n  -d \"client_id=YOUR_CLIENT_ID\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"code=AUTHORIZATION_CODE\" \\\n  -d \"grant_type=authorization_code\" \\\n  -d \"redirect_uri=YOUR_REDIRECT_URI\"\n```\n\n**Example Response:**\n\n```json\n{\n  \"access_token\": \"a1b2c3d4e5f6g7h8i9j0\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600,\n  \"refresh_token\": \"z9y8x7w6v5u4t3s2r1q0\",\n  \"scope\": \"read write\"\n}\n```\n\n### From a main account\n\n**Note:** Main accounts have different scopes and permissions.\n\n**Endpoint:**\n```\nPOST https://example.com/oauth/access_token\n```\n\n**Parameters:** Same as shop account\n\n**Example Request:**\n\n```bash\ncurl -X POST https://example.com/oauth/access_token \\\n  -d \"client_id=YOUR_CLIENT_ID\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"code=AUTHORIZATION_CODE\" \\\n  -d \"grant_type=authorization_code\" \\\n  -d \"redirect_uri=YOUR_REDIRECT_URI\"\n```\n\n**Example Response:**\n\n```json\n{\n  \"access_token\": \"m1a2i3n4a5c6c7o8u9n0t\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600,\n  \"refresh_token\": \"r0e1f2r3e4s5h6t7o8k9en\",\n  \"scope\": \"admin read write\"\n}\n```\n\n## Refreshing Access Tokens\n\nAccess tokens expire after a certain period. Use the refresh token to obtain a new access_token.\n\n### Steps to refresh:\n\n1. Save the pair of access_token and refresh_token\n2. When access_token expires, use the refresh_token to get a new pair\n3. Replace old tokens with new ones\n\n**Endpoint:**\n```\nPOST https://example.com/oauth/access_token\n```\n\n**Parameters:**\n- `client_id` - Your application's client ID\n- `client_secret` - Your application's client secret\n- `refresh_token` - The refresh token from the previous response\n- `grant_type` - Must be set to \"refresh_token\"\n\n**Example Request:**\n\n```bash\ncurl -X POST https://example.com/oauth/access_token \\\n  -d \"client_id=YOUR_CLIENT_ID\" \\\n  -d \"client_secret=YOUR_CLIENT_SECRET\" \\\n  -d \"refresh_token=YOUR_REFRESH_TOKEN\" \\\n  -d \"grant_type=refresh_token\"\n```\n\n**Example Response:**\n\n```json\n{\n  \"access_token\": \"n0e1w2a3c4c5e6s7s8t9ok\",\n  \"token_type\": \"Bearer\",\n  \"expires_in\": 3600,\n  \"refresh_token\": \"n0e1w2r3e4f5r6e7s8h9tok\",\n  \"scope\": \"read write\"\n}\n```\n\n## Canceling Authorization\n\n### How to revoke access\n\nYou can cancel an authorization by changing the authorization URL at your Seller Center.\n\n**Steps:**\n\n1. Navigate to App Settings in Seller Center\n2. Find the authorization section\n3. Click \"Revoke Access\" or similar option\n\n### Canceling through API\n\nFollow the same steps to generate an authorization URL, but replace the host authorization URL with your host.\n\n**Alternative method:**\n\n```\nhttps://example.shoplineapp.com/oauth/revoke_access\n```\n\n**Parameters:**\n- `client_id` - Your application's client ID\n- `token` - The access token or refresh token to revoke\n\n**Example:**\n\n```bash\ncurl -X POST https://example.shoplineapp.com/oauth/revoke_access \\\n  -d \"client_id=YOUR_CLIENT_ID\" \\\n  -d \"token=TOKEN_TO_REVOKE\"\n```\n\n---\n\n## Additional Resources\n\nFor more information, see:\n- **API Reference** - [Link to API documentation]\n- **Authentication Flow** - [Link to auth flow guide]\n- **Best Practices** - [Link to best practices]\n\n---\n\n## Important Notes\n\nâš ï¸ **Security Warning:** Never expose your client_secret in client-side code or public repositories.\n\nðŸ’¡ **Tip:** Store tokens securely and use environment variables for sensitive credentials.\n\nðŸ“Œ **Note:** Refresh tokens should be stored securely as they can be used to obtain new access tokens.\n\n---\n\n# Canceling authorization\n\nYou can cancel an authorization by changing the authorization URL via Seller Center.\n\n## Canceling authorization by changing the authorization URL\n\nFollow the same steps to generate an authorization URL, but replace the fixed authorization URL with these fixed deauthorization URLs:\n\n### Production Environment\n- **https://partner.test.shopeemobile.com/api/v2/shop/cancel_auth_partner?**\n  - `partner_id=1000948&redirect=https://open.shopee.com/demo/temp=1504597040&sign=90c1a39302f0b690c7223e1bc54569ec3a1c050658441f1faa4b66488210c8c9`\n\n### Sandbox Environment\n- **https://partner.test.shopeemobile.com/api/v2/shop/cancel_auth_partner?**\n  - `partner_id=1000916&redirect=https://open.shopee.com/demo/temp=1672341604&sign=47d4f71268698ec7c7f61e6e0091b080665190162164753818b4b30a8cc287c`\n\nLog in to your account.\n\n---\n\n## Select Account\n\n**Select Account**\n\n- **SID:** 53682804.balunafa98a.hsaef117\n- OpenpartnerPartner145.main\n\nLog in with other accounts\n\nLanguage: English â–¼\n\n---\n\n## Select Cancel Authorization\n\n**Cancel Authorization**\n\nOnce canceled, you will no longer be authorized to access your info.\n\n- **Account ID:** sandbox.balunafa98a.1c8aef117\n- **Shop ID:** 30\n\n[Cancel Authorization Button]\n\n---\n\n## Canceling authorization on Seller Center\n\nOn the Platform Partner page in Seller Center, sellers can check which Apps the shop has authorized and their corresponding authorization expiration dates. The seller can also directly cancel the authorization of Apps by selecting \"Shopee Open Platform\" in the main column.\n\n[Screenshots showing Platform Partner interface with authorization details and \"End authorization\" option]\n\n---\n\nCNSC and KRSC sellers can check which Apps the main account has granted authorization to. On the Platform Partner page, Sellers can directly cancel any authorizations granted by the merchant or shop.\n\n[Screenshots showing authorization management interface]\n\n---\n\n## FAQs on authorization and authentication\n\nFor common questions, please refer to our [FAQs on authorization and authentication](#).",
  "metadata": {
    "title": "The authorization process",
    "summary": "This guide explains the authorization process, including generating the authorization link, enabling authorizations from Klaytn, and using the authorization link. It details the steps to prepare for authorization, the authorization process itself, and how to use the retrieved information to pass authorization to a partner's service. It also provides code examples in PHP, Python, Java and Node.js.",
    "keywords": [
      "authorization",
      "authorization link",
      "Klaytn",
      "Open Platform",
      "HMAC-SHA256",
      "API",
      "app parameter",
      "signature",
      "partner_ci",
      "timestamp"
    ],
    "category": "Authentication",
    "tags": [
      "authorization link generation",
      "API authentication",
      "HMAC-SHA256 signature",
      "Klaytn authorization",
      "Open Platform integration"
    ],
    "difficulty": "medium",
    "importance": 4,
    "use_cases": [
      "Integrating with Klaytn's authorization services",
      "Authenticating API calls to Open Platform",
      "Generating authorization links for end-users",
      "Securing partner service authorization",
      "Implementing HMAC-SHA256 signature for API authentication"
    ],
    "related_apis": [
      "Open Platform App-tier-link Authorizer",
      "Shop APIs",
      "Partner APIs",
      "Public APIs"
    ]
  }
}